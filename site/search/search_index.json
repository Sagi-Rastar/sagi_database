{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u6b22\u8fce","text":"<p>\u7528\u4e8e\u5b58\u50a8\u5404\u7c7b\u611f\u5174\u8da3\u7684\u3001  \u4ee5\u53ca\u65e5\u5e38\u5f00\u53d1\u7684\u6280\u672f\u6587\u6863\u3002</p> <p>\u65e8\u5728\u59a5\u5584\u7ba1\u7406\u5e73\u65e5\u6240\u79ef\u7d2f\u7684\u5404\u7c7b\u6280\u672f\u76f8\u5173\u7b14\u8bb0\u3001\u53c2\u8003\u6587\u6863\u7b49\u9700\u8981\u53cd\u590d\u67e5\u9605\u7684\u5185\u5bb9\u3002</p> MKDocs\u901f\u67e5 <ul> <li><code>mkdocs new [dir-name]</code>\u00a0- \u521b\u5efa\u4e00\u4e2a\u65b0\u9879\u76ee</li> <li><code>mkdocs serve</code>\u00a0- \u672c\u5730\u8c03\u8bd5web\u754c\u9762</li> <li><code>mkdocs build</code>\u00a0- \u6784\u5efa\u9879\u76ee</li> <li><code>mkdocs -h</code>\u00a0- \u5e2e\u52a9</li> </ul> <pre><code>\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/","title":"\u5e73\u53f0","text":"<ul> <li> <p> MCU</p> <p>MCU\u5373\u5fae\u63a7\u5236\u5668\u5355\u5143\uff0c\u662f\u5c0f\u578b\u8ba1\u7b97\u673a\u7684\u5206\u7c7b</p> <p>\u201cMCU\u201d\uff1a\u5fae\u63a7\u5236\u5668/\u5355\u7247\u673a/\u5d4c\u5165\u5f0f\u7cfb\u7edf\u2026</p> </li> <li> <p> ARM</p> <p>ARM_SOC\u76f8\u5173\u7684\u786c\u4ef6\u5e73\u53f0\u5206\u7c7b</p> <p>\u201cARM\u201d\uff1aARMSOC\u2026</p> </li> <li> <p> x86</p> <p>x86\u67b6\u6784\u76f8\u5173\u7684\u786c\u4ef6\u5e73\u53f0\u5206\u7c7b</p> <p>\u201cx86\u201d\uff1ax86\u2026</p> </li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/","title":"MCU","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/#1-esp32","title":"1 ESP32","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/#11","title":"1.1 \u66f4\u65b0\u65e5\u5fd7","text":"<ul> <li>20240817 | \u6574\u7406\u4e86240615-240719 \u7684\u5f00\u53d1\u6587\u6863\uff0c\u7528\u4e8e\u540e\u7ee7\u5f00\u53d1\u53cc\u6a21\u95e8\u7981\u63a7\u5236\u5668\u67e5\u9605\u4f7f\u7528</li> <li>20240818 | \u66f4\u65b0\u5f00\u53d1\u6587\u6863\uff0c\u63a2\u7d22 ESP32 \u914d\u7f51\u65b9\u5f0f\uff0c\u4e3b\u8981\u79fb\u690d\u4e86\u4e50\u946b\u5b98\u65b9 BluFi \u7684\u914d\u7f51\u4f8b\u7a0b\u5230\u53cc\u6a21\u95e8\u7981\u63a7\u5236\u5668\u5de5\u7a0b\u4e2d\uff0c\u5e76\u6d4b\u8bd5 BluFi \u914d\u7f51</li> <li>20240822 | \u66f4\u65b0\u4e86\u5206\u533a\u8868\uff0c\u5c06\u56fa\u4ef6\u5206\u533a\u62d3\u5c55\u81f3 2MB\uff0c\u5e76\u6dfb\u52a0\u4e24\u4e2a OTA \u5206\u533a\uff1b\u63a2\u7d22 OTA \u5b98\u65b9\u4f8b\u7a0b\uff0c\u603b\u7ed3\u57fa\u4e8e HTTP \u7684 OTA \u65b9\u5f0f</li> <li>20240905 | \u66f4\u65b0storage\u6a21\u5757\uff0c\u63a8\u8fdb\u5b9e\u73b0mqtt\u534f\u8bae\u90e8\u5206</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/#2-stm32","title":"2 STM32","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/#21","title":"2.1 \u66f4\u65b0\u65e5\u5fd7","text":"<ul> <li>\u5f85\u6574\u7406...</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/#3-debug","title":"3 Debug","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/#31","title":"3.1 \u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/Debug/240828-Jlink/","title":"240828 Jlink","text":"<p>J-Link \u662f\u5fb7\u56fd SEGGER \u516c\u53f8\u4e3a\u652f\u6301\u4eff\u771f ARM \u5185\u6838\u82af\u7247\u63a8\u51fa\u7684 JTAG \u4eff\u771f\u5668\u3002</p> <ul> <li>\u53ef\u914d\u5408 IAR EWAR\uff0cADS\uff0cKEIL\uff0cWINARM\uff0cRealView \u7b49\u96c6\u6210\u5f00\u53d1\u73af\u5883\uff1b</li> <li>\u652f\u6301 ARM7/ARM9/ARM11\uff0cCortex M0/M1/M3/M4\uff0cCortex A5/A8/A9\u7b49\u5185\u6838\u82af\u7247\u7684\u4eff\u771f\uff1b</li> </ul> <p>JTAG\uff08Joint Test Action Group\uff0c\u8054\u5408\u6d4b\u8bd5\u884c\u52a8\u5c0f\u7ec4\uff09\u662f\u4e00\u79cd\u56fd\u9645\u6807\u51c6\u6d4b\u8bd5\u534f\u8bae\uff08IEEE 1149.1\u517c\u5bb9\uff09\uff0c\u4e3b\u8981\u7528\u4e8e\u82af\u7247\u5185\u90e8\u6d4b\u8bd5\uff0c\u73b0\u5728\u591a\u6570\u7684\u5668\u4ef6\u90fd\u652f\u6301 JTAG \u534f\u8bae\uff0cARM\u3001DSP\u3001FPGA \u7b49\uff0cJTAG \u63a5\u53e3\u7684\u5355\u7247\u673a\u7528\u7535\u8111 USB \u4e0b\u8f7d\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u9700\u8981\u7528\u5230 J-Link\uff08USB \u8f6c JTAG\uff09\u3002</p> <p>\u6807\u51c6\u7684 JTAG \u662f\u56db\u7ebf\uff1aTDI\uff0cTMS\uff0cTCK\uff0cTDO\uff0c\u5206\u522b\u5bf9\u5e94\u6570\u636e\u8f93\u5165\uff0c\u6a21\u5f0f\u9009\u62e9\uff0c\u65f6\u949f\uff0c\u6570\u636e\u8f93\u51fa\uff0c\u590d\u4f4d\u7ba1\u811a\u53ef\u4e0d\u63a5\u3002</p> <p></p> <ul> <li>JLink \u662f\u901a\u7528\u578b\u7684 ARM \u5185\u6838\u82af\u7247\u4eff\u771f\u5668\uff0c\u652f\u6301\u7684\u82af\u7247\u548c\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u591a\uff0c\u4f18\u9009\uff1b</li> <li>ST-Link\u662f\u9488\u5bf9STM8/STM32\uff0c\u5982\u679c\u4f60\u4f7f\u7528STM8/STM32\u5355\u7247\u673a\uff0c\u9996\u9009ST-Link\uff0c\u5f53\u7136\u7528JLink\u4e0b\u8f7dST\u7cfb\u5217\u5355\u7247\u673a\u4e5f\u53ef\u4ee5\uff1b</li> <li>ULink\u4e13\u6ce8\u4e8eKeil\u5e73\u53f0\uff0c\u652f\u6301ARM7/9\uff0cCortex-M0~M4\uff0cULink2\u8fd8\u652f\u63018051\u7cfb\u5217\u82af\u7247\uff0c\u7efc\u5408\u6027\u80fd\uff08\u652f\u6301\u82af\u7247\u79cd\u7c7b\u3001\u8f6f\u4ef6\u5f00\u53d1\u73af\u5883\u53ca\u53ca\u8c03\u8bd5\u901f\u5ea6\uff09\u5747\u4e0d\u5982JLink\uff1b</li> <li>\u4e09\u8005\u90fd\u652f\u6301JTAG\u548cSWD\u6a21\u5f0f\uff1b</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/","title":"\u6982\u8ff0","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/#1-wifi","title":"1 \u84dd\u7259WIFI\u53cc\u6a21\u95e8\u7981\u63a7\u5236\u5668","text":"<p>\u4f7f\u7528 ESP32-S3\u4f5c\u4e3a\u4e3b\u63a7\uff0c\u65e8\u5728\u5b9e\u73b0\u65ad\u7f51\u60c5\u51b5\u4e0b\u4e5f\u53ef\u4ee5\u5229\u7528\u84dd\u7259\u529f\u80fd\u8fdb\u884c\u95e8\u7981\u63a7\u5236\u3002</p> <p>\u9879\u76ee\u94fe\u63a5\uff1a https://gitee.com/chenym_simpler/git_lock_electromagnet</p> <p>\u786c\u4ef6\u8d44\u6e90\u5982\u4e0b\uff1a</p> <ul> <li>\u4f7f\u7528\u6a21\u7ec4 <code>ESP32-S3-WROOM-1U-N8R2</code><ul> <li><code>ESP32-S3</code> \u4e3b\u63a7\uff0c\u4e3b\u9891\u9ad8\u8fbe 240MHz\uff0c\u53cc\u6838 Xtensa\u00ae dual-core 32-bit LX7 CPU</li> <li>8MB Flash</li> <li>2MB PSRAM</li> </ul> </li> </ul> <p>ESP32-S3-WROOM-1 \u91c7\u7528 PCB \u677f\u8f7d\u5929\u7ebf;</p> <p>ESP32-S3-WROOM-1U \u91c7\u7528 U.FL \u5ea7\u5b50\u8fde\u63a5\u5916\u90e8 IPEX \u5929\u7ebf</p> <p>\u53ef\u9009 4/8/16 MB flash\uff1b0/2/8 PSRAM</p> <ul> <li>240615-smartconfig\u914d\u7f51</li> <li>240617-IDF \u7684\u4e8b\u4ef6\u5faa\u73af\uff0c\u53ca wifi \u8fd0\u884c\u6d41\u7a0b</li> <li>240618-SNTP \u83b7\u53d6\u65f6\u95f4\u3001AES \u52a0\u5bc6</li> <li>240619-\u84dd\u7259\u5f00\u53d1</li> <li>240625-\u5361\u5173\u7cfb\u5b58\u50a8\u8bbe\u8ba1</li> <li>240626-BM8563 \u9a71\u52a8\u79fb\u690d\uff0cIDF-I2C \u7b14\u8bb0</li> <li>240719-LEDPWM\u53ca\u5e38\u7528\u6307\u793a\u51fd\u6570\u5c01\u88c5</li> <li>240818-\u84dd\u7259\u914d\u7f51\u4ee5\u53casoftAP\u65b9\u5f0f\u914d\u7f51\u63a2\u7d22</li> <li>240822-ESP32\u5206\u533a\u8868\u53caOTA</li> <li>240905-\u66f4\u65b0storage\u4ee5\u53camqtt\u6a21\u5757\u90e8\u5206\uff0c\u9010\u6b65\u5b9e\u73b0\u79c1\u6709json\u534f\u8bae</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/#2","title":"2 \u53c2\u8003\u6587\u6863\u4ee5\u53ca\u94fe\u63a5\uff1a","text":"<ul> <li>IDF \u5b98\u65b9\u6587\u6863</li> <li>IDF \u5b98\u65b9\u6ce8\u518c\u8868\u4ed3\u5e93</li> <li>ESP32-S3 \u6280\u672f\u53c2\u8003\u624b\u518c <p>\u8f83\u4e3a\u8be6\u7ec6\uff0c\u5305\u62ec\u6982\u8ff0\u3001\u529f\u80fd\u5217\u8868\u3001\u786c\u4ef6\u67b6\u6784\u3001\u7f16\u7a0b\u6307\u5357\u3001\u5bc4\u5b58\u5668\u5217\u8868\u7b49\u4fe1\u606f</p> </li> <li>ESP32-S3 \u6280\u672f\u89c4\u683c\u4e66 <p>\u6982\u8ff0\u7c7b\u578b\uff0c\u5305\u62ec\u5404\u5916\u8bbe\u91cd\u8981\u53c2\u6570</p> </li> <li>ESP32 \u9009\u578b\u5728\u7ebf\u5de5\u5177</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240615-smartconfig%E9%85%8D%E7%BD%91/","title":"240615-smartconfig \u914d\u7f51","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240615-smartconfig%E9%85%8D%E7%BD%91/#1","title":"1 \u914d\u7f51\u6d4b\u8bd5","text":"<p>API \u53c2\u8003\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/v5.2.2/esp32s3/api-reference/network/esp_smartconfig.html</p> <p>\u5b98\u65b9\u4f8b\u7a0b\uff1a https://github.com/espressif/esp-idf/tree/v5.2.2/examples/wifi/smart_config</p> <p>\u5bf9\u4e8e\u6ca1\u6709\u56fe\u5f62\u754c\u9762\u7684\u65e0\u5934\u8bbe\u5907\u6765\u8bf4\uff0csmartconfig \u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u901a\u8fc7\u5176\u4ed6\u7ec8\u7aef\uff08\u5982\u624b\u673a\u7535\u8111\u5e73\u677f\uff09\u5e7f\u64ad\u7ed9\u672a\u914d\u7f51\u7684\u8bbe\u5907\uff1b\u5e76\u4e14 IDF \u7684 smartconfig \u63a5\u53e3\u8fd8\u540c\u65f6\u652f\u6301\u5fae\u4fe1\u7684 airkiss \u914d\u7f51\u65b9\u5f0f\u3002</p> <p>\u5728\u5b9e\u9645\u6d4b\u8bd5\u7684\u65f6\u5019\u5b58\u5728\u5e7f\u64ad\u4e0d\u7a33\u5b9a\u7684\u60c5\u51b5\uff0c\u4e0d\u8fc7\u51e0\u7387\u8f83\u5c0f\uff0c\u5931\u8d25\u540e\u91cd\u65b0\u914d\u7f51\u5373\u53ef\u3002\u5bf9\u4e8e\u96c6\u6210\u5230\u5fae\u4fe1\u7684\u914d\u7f51\u65b9\u5f0f\u4ecd\u5f85\u6d4b\u8bd5\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/","title":"240617-IDF \u7684\u4e8b\u4ef6\u5faa\u73af\uff0c\u53ca wifi \u8fd0\u884c\u6d41\u7a0b","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#1","title":"1 \u4e8b\u4ef6\u5faa\u73af","text":"<p>API \u53c2\u8003\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/v5.2.2/esp32s3/api-reference/system/esp_event.html</p> <p>wifi \u4f7f\u7528\u7684\u4e8b\u4ef6\u5faa\u73af\uff0c\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/m0_63235356/article/details/137833228</p> <p>\u7c7b\u4f3c\u4e8e FreeRTOS \u7684\u4e8b\u4ef6\u7ec4\uff0cIDF \u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e8b\u4ef6\u5faa\u73af\u5e93\uff0c\u4f7f\u5f97\u7ec4\u4ef6\u4e4b\u95f4\u53ef\u4ee5\u76f8\u4e92\u76d1\u542c\u4e8b\u4ef6\u7684\u53d1\u751f\u6216\u53d1\u5e03\u4e8b\u4ef6\u3002</p> <p>IDF \u7ef4\u62a4\u4e00\u4e2a\u7279\u6b8a\u7684\u4e8b\u4ef6\u5faa\u73af\uff0c\u88ab\u79f0\u4f5c <code>\u9ed8\u8ba4\u4e8b\u4ef6\u5faa\u73af</code> \u3002\u8be5\u5faa\u73af\u7528\u4e8e\u5904\u7406\u5404\u79cd\u5e38\u89c1\u7684\u7cfb\u7edf\u4e8b\u4ef6\u3002\u7528\u6237\u4e0d\u80fd\u64cd\u4f5c\u8be5\u5faa\u73af\u7684\u53e5\u67c4\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u901a\u8fc7\u4e8b\u4ef6\u5faa\u73af\u7684\u53d8\u4f53 API \u5b8c\u6210\uff0c\u4e0b\u8868\u4e3a\u53d8\u4f53\u4e0e\u539f\u672c\u7684 API \u5bf9\u7167\uff1a</p> \u7528\u6237\u4e8b\u4ef6\u5faa\u73af \u9ed8\u8ba4\u4e8b\u4ef6\u5faa\u73af <code>esp_event_loop_create ()</code> <code>esp_event_loop_create_default ()</code> <code>esp_event_loop_delete ()</code> <code>esp_event_loop_delete_default ()</code> <code>esp_event_handler_register_with ()</code> <code>esp_event_handler_register ()</code> <code>esp_event_handler_unregister_with ()</code> <code>esp_event_handler_unregister ()</code> <code>esp_event_post_to ()</code> <code>esp_event_post ()</code>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#2-idf-wifi","title":"2 IDF \u4e2d\u7684 wifi \u8fd0\u884c\u903b\u8f91","text":"<p>\u5b98\u65b9 wifi \u9a71\u52a8\u7a0b\u5e8f\u6307\u5357\uff0c\u7f57\u5217\u4e86\u9ed8\u8ba4\u4e8b\u4ef6\u5faa\u73af\u4e2d\u7684 wifi \u4e8b\u4ef6\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/v5.2.2/esp32s3/api-guides/wifi.html#id6</p> <p>\u5b98\u65b9\u5173\u4e8e wifi \u7684 demo \uff1a https://github.com/espressif/esp-idf/tree/v5.2.2/examples/wifi</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#21","title":"2.1 \u521d\u59cb\u5316","text":"<p>LwIP for Lightweight TCP/IP stack</p> <p>LwIP \u6027\u80fd\u8981\u6c42\u53ea\u6709\u6570\u5341 KB \u53ef\u7528 RAM \u548c\u5927\u81f4 40KB \u53ef\u7528 ROM \u7a7a\u95f4\u5373\u53ef</p> <p>\u8fd9\u4e00\u9636\u6bb5\u6ca1\u6709\u4ec0\u4e48\u9700\u8981\u6539\u52a8\u7684\uff0c\u6ce8\u610f\u4e00\u4e0b\u521d\u59cb\u5316\u987a\u5e8f\u5c31\u597d\uff0c\u5957\u63a5\u5b57\u4e00\u822c\u5728\u83b7\u5f97\u5230 IP \u4e4b\u540e\u518d\u521b\u5efa</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#22","title":"2.2 \u914d\u7f6e","text":"<p>\u9700\u8981\u6ce8\u610f\u8c03\u7528\u914d\u7f6e API \u4e4b\u540e\u4f1a\u5c06 wifi \u65ad\u5f00\uff0c\u4e00\u822c\u5728\u5efa\u7acb\u8fde\u63a5\u4e4b\u524d\u914d\u7f6ewifi</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#23","title":"2.3 \u542f\u52a8","text":"<p>\u542f\u52a8 wifi \u9a71\u52a8\u7a0b\u5e8f\uff0c\u6b64\u65f6\u4f1a\u53d1\u5e03\u4e00\u4e2a <code>WIFI_EVENT_STA_START</code> \u7684\u4e8b\u4ef6\uff0c\u53ef\u4ee5\u5728\u8be5\u4e8b\u4ef6\u53d1\u751f\u4e4b\u540e\u8c03\u7528\u51fd\u6570\u8fdb\u884c wifi \u7684\u8fde\u63a5</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#24","title":"2.4 \u8fde\u63a5","text":"<p>\u8c03\u7528 connect \u51fd\u6570\u4e4b\u540e\u5c06\u4f1a\u89e6\u53d1 <code>CONNECTED</code> \u4e8b\u4ef6\uff0c\u5e76\u7531\u9ed8\u8ba4\u4e8b\u4ef6\u5faa\u73af\u542f\u52a8 DHCP \u5ba2\u6237\u7aef\u670d\u52a1\uff0c\u5f00\u59cb\u5c1d\u8bd5\u83b7\u53d6 IP</p> <p>DHCP \u534f\u8bae\u4f7f\u7528 UDP \u4f5c\u4e3a\u4f20\u8f93\u534f\u8bae\uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\uff0c\u670d\u52a1\u7aef\u5e94\u7b54\u3002\u5ba2\u6237\u7aef\u5e7f\u64ad DHCP DISCOVER \u62a5\u6587\u7ed9\u670d\u52a1\u7aef\uff0c\u6b64\u65f6\uff0c\u4e0e\u5ba2\u6237\u7aef\u5728\u540c\u4e00\u4e2a\u7f51\u6bb5\u7684 DHCP \u670d\u52a1\u7aef\u624d\u53ef\u4ee5\u63a5\u6536\u5230\u62a5\u6587\uff0c\u5982\u679c\u4e0d\u5728\u7684\u8bdd\u9700\u8981 DHCP \u4e2d\u7ee7</p> <p>\u603b\u4e4b DHCP \u670d\u52a1\u7aef\u4f1a\u7ed9\u5ba2\u6237\u7aef\u5206\u914d\u4e00\u4e2a IP\uff0c\u4e00\u822c\u5c40\u57df\u7f51\u8def\u7531\u5668\u9ed8\u8ba4\u5f00\u542f DHCP \u670d\u52a1\u7aef\u529f\u80fd</p> <p>\u5bf9\u4e8e\u4e00\u4e2a\u5065\u58ee\u7684 wifi \u5e94\u7528\u7a0b\u5e8f\u6765\u8bf4\uff0c\u6b64\u65f6\u6ce8\u610f\u8981\u5904\u7406\u53ef\u80fd\u53d1\u751f\u7684 <code>DISCONNECTED</code> \u4e8b\u4ef6\uff0c\u4e00\u65e6\u53d1\u751f <code>DISCONNECTED</code> \u4e8b\u4ef6\uff0c\u9ed8\u8ba4\u4e8b\u4ef6\u5faa\u73af\u4efb\u52a1\u5c06\u4f1a\u79fb\u9664\u6240\u6709 UDP/ICP \u8fde\u63a5\uff0c\u6b64\u65f6\u6240\u6709\u5957\u63a5\u5b57\u5931\u6548\u3002</p> <p>\u5982\u9636\u6bb5 6 \u6240\u63a8\u8350\u7684\u4e00\u6837\uff0c\u6b64\u65f6\u5e94\u5f53\u518d\u6b21\u8c03\u7528\u8fde\u63a5\u51fd\u6570\uff1a\u79fb\u9664\u6240\u6709\u5957\u63a5\u5b57\uff0c\u5e76\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5 wifi</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#25-ip","title":"2.5 \u83b7\u53d6 IP","text":"<p>\u8fd9\u4e2a\u9636\u6bb5\u9700\u8981\u6ce8\u610f\u7684\u5c31\u662f\u4e00\u70b9\uff0c\u5373 \u5728\u63a5\u6536\u5230 IP \u4e4b\u540e\u518d\u8fdb\u884c\u6240\u6709\u7684\u5957\u63a5\u5b57\u521b\u5efa\u7b49\u76f8\u5173\u64cd\u4f5c</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#26","title":"2.6 \u65ad\u5f00\u5904\u7406","text":"<p>\u5982\u4e0a\u6587 1.4 \u6240\u8ff0</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#27-ip","title":"2.7 IP \u66f4\u6539","text":"<p>IP \u5730\u5740\u53d1\u751f\u66f4\u6539\u65f6\u4e5f\u7c7b\u4f3c <code>DISCONNECTED</code> \u4e8b\u4ef6\u4e00\u6837\uff0c\u63a8\u8350\u5173\u95ed\u6240\u6709\u5df2\u521b\u5efa\u7684\u5957\u63a5\u5b57\u8fdb\u884c\u91cd\u65b0\u521b\u5efa</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240617-IDF%20%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%EF%BC%8C%E5%8F%8A%20wifi%20%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B/#28","title":"2.8 \u6e05\u7406","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/","title":"240618-SNTP \u83b7\u53d6\u65f6\u95f4\u3001AES \u52a0\u5bc6","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#1-sntp","title":"1 SNTP \u83b7\u53d6\u65f6\u95f4","text":"<p>\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/qq_41741344/article/details/120117151</p> <p>\u5b98\u65b9\u6587\u6863\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/system/system_time.html#sntp</p> <p>SNTP for Simple Network Time Protocol. \u662f NTP \u534f\u8bae\u7684\u4e00\u4e2a\u5b50\u96c6</p> <p>NTP \u65f6\u95f4\u6233\u662f\u8be5\u534f\u8bae\u7684\u91cd\u8981\u5185\u5bb9\uff0c\u662f\u4e00\u4e2a 64 \u4f4d\u65e0\u7b26\u53f7\u6d6e\u70b9\u6570\u7ec4\u6210\uff0c\u524d\u9762 32 \u4f4d\u8868\u793a\u6574\u6570\uff0c\u540e\u9762 32 \u4f4d\u8868\u793a\u5c0f\u6570\u3002\u5355\u4f4d\u662f\u79d2\u3002\u65f6\u95f4\u662f\u76f8\u5bf9\u4e8e 1900 \u5e74 1 \u6708 0 \u70b9\u5f00\u59cb\u5230\u73b0\u5728\u6240\u7ecf\u8fc7\u7684\u79d2\u6570\u3002\u5b83\u80fd\u8868\u793a\u7684\u6700\u5927\u6570\u5b57\u662f 4,294,967,295 \u79d2\u3002\u5d4c\u5165\u5f0f\u8bbe\u5907\u4e0a\u7535\u540e\u8fde\u63a5 AP \u83b7\u53d6 IP \u5730\u5740\u4e4b\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7 SNTP \u7684\u534f\u8bae\u83b7\u53d6\u5168\u7403\u65f6\u95f4\u3002</p> <p>LwIP \u7684 SNTP \u5e93\u4e2d\u542b\u6709\u4e00\u4e9b API \u53ef\u4ee5\u66f4\u65b0\u7cfb\u7edf\u65f6\u95f4\uff0c\u4f46\u662f\u5e76\u975e\u4e3a\u7ebf\u7a0b\u5b89\u5168\u7684 API\uff0c\u5b98\u65b9\u63a8\u8350\u4f7f\u7528 <code>esp_netif_component</code> \u6765\u66f4\u65b0\u65f6\u95f4</p> <p>\u5177\u4f53\u5f00\u53d1\u4e0a\u5728 wifi \u90a3\u8fb9\u83b7\u53d6\u5230 ip \u4e4b\u540e\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u8c03\u7528\u5e76\u8bbe\u7f6e sntp \u670d\u52a1\u5668\u5373\u53ef\u5f00\u542f sntp \u670d\u52a1\uff1a <pre><code>static void esp_initialize_sntp(void)\n{\n    ESP_LOGI(TAG, \"Initializing SNTP\");\n    sntp_setoperatingmode(SNTP_OPMODE_POLL);\n    sntp_set_sync_mode(SNTP_SYNC_MODE_IMMED);\n    sntp_setservername(0, \"s1b.time.edu.cn\");\n    sntp_setservername(1, \"210.72.145.44\");\n    sntp_setservername(2, \"ntp1.aliyun.com\");\n    sntp_init();\n}\n</code></pre></p> <p>\u968f\u540e\u8c03\u7528 POSIX \u51fd\u6570 <code>setenv</code> \u548c <code>tzset</code> \u8bbe\u7f6e\u65f6\u533a\u4ee5\u53ca\u66f4\u65b0 C \u5e93\u7684\u8fd0\u884c\u6570\u636e\u3002</p> <p>\u5b8c\u6210\u4e0a\u8ff0\u64cd\u4f5c\u4e4b\u540e\u53ef\u4ee5\u8c03\u7528\u5982\u4e0b\u51fd\u6570\u83b7\u53d6\u672c\u5730\u65f6\u95f4\uff1a</p> <ul> <li><code>localtime</code>\uff0c\u5728\u8c03\u7528 <code>time(NULL)</code> \u540e\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u51fd\u6570\u5c06 <code>time_t</code> \u8f6c\u6362\u4e3a <code>tm</code> \u7ed3\u6784\u4f53</li> <li><code>localtime_r</code>\uff0c\u8ddf\u4e0a\u9762\u76f8\u540c\uff0c\u4f46\u7531\u4e8e\u4e0d\u5e26 <code>_r</code> \u7684\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u6307\u5411\u9759\u6001\u53d8\u91cf\u7684\u6307\u9488\uff0c\u56e0\u6b64\u6709\u53ef\u80fd\u88ab\u8986\u76d6\uff0c\u7279\u522b\u662f\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b</li> </ul> <p></p> <p>\u6ce8\u610f: sntp \u4f9d\u8d56\u5957\u63a5\u5b57, \u56e0\u6b64\u7ef4\u62a4\u7684 sntp \u5e94\u7528\u9700\u8981\u76d1\u542c wifi \u4e8b\u4ef6</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#2-aes","title":"2 AES \u52a0\u5bc6","text":"<p>\u53c2\u8003\u535a\u5ba2: https://blog.csdn.net/qq_36347513/article/details/120991568</p> <p>idf \u96c6\u6210\u7684 mbedtls \u52a0\u5bc6\u5e93\u7684 API \u53c2\u8003\uff1a https://mbed-tls.readthedocs.io/projects/api/en/v3.4.1/api/file/aes_8h/#_CPPv416mbedtls_aes_initP19mbedtls_aes_context</p> <p>\u4e50\u946b esp-idf \u6846\u67b6\u96c6\u6210\u5f00\u6e90\u7684 mbedtls \u52a0\u5bc6\u5e93\u3002Mbedtls \u4e5f\u8bb8\u662f\u6700\u5c0f\u5de7\u7684 SSL \u4ee3\u7801\u5e93\u3002\u9ad8\u6548\u3001\u4fbf\u4e8e\u79fb\u690d\u548c\u96c6\u6210\u3002\u652f\u6301\u5e38\u89c1\u7684\u5b89\u5168\u7b97\u6cd5\uff0c\u5982\uff1aAES\u3001DES\u3001RSA\u3001ECC\u3001SHA256\u3001MD5\u3001BASE64 \u7b49\u7b49\u3002\u9664\u6b64\u4e4b\u5916\u8fd8\u652f\u6301\u516c\u94a5\u8bc1\u4e66\u4f53\u7cfb\u3002\u5b83\u63d0\u4f9b\u4e86\u5177\u6709\u76f4\u89c2\u7684 API \u548c\u53ef\u8bfb\u6e90\u4ee3\u7801\u7684 SSL \u5e93\u3002\u8be5\u5de5\u5177\u5373\u5f00\u5373\u7528\uff0c\u53ef\u4ee5\u5728\u5927\u90e8\u5206\u7cfb\u7edf\u4e0a\u76f4\u63a5\u6784\u5efa\u5b83\uff0c\u4e5f\u53ef\u4ee5\u624b\u52a8\u9009\u62e9\u548c\u914d\u7f6e\u5404\u9879\u529f\u80fd\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#21-aes","title":"2.1 AES \u79cd\u7c7b","text":"<p>ECB \u5f62\u5f0f\uff1a\u5373\u7535\u5b50\u5bc6\u7801\u672c\u5f62\u5f0f\uff0c\u6700\u65e9\u91c7\u7528\u5e76\u4e14\u6700\u7b80\u5355\u7684\u65b9\u5f0f\uff0c\u5c06\u52a0\u5bc6\u7684\u6570\u636e\u5206\u4e3a\u82e5\u5e72\u7ec4\uff0c\u6bcf\u7ec4\u5927\u5c0f\u8ddf\u52a0\u5bc6\u5bc6\u94a5\u957f\u5ea6\u76f8\u540c\u3002\u4e00\u6b21\u53ea\u80fd\u52a0\u89e3\u5bc6 128 \u4f4d\u7684\u660e\u6587\uff0c\u4e5f\u5c31\u662f 16 \u4e2a\u5b57\u8282\u3002</p> <p>CBC \u5f62\u5f0f\uff1a\u5373\u52a0\u5bc6\u5757\u94fe\u5f62\u5f0f\uff0c\u9700\u8981\u4e00\u4e2a\u521d\u59cb\u5316\u5411\u91cf\u3002</p> <p>\u4ec0\u4e48\u662f\u521d\u59cb\u5316\u5411\u91cf\uff1f</p> <p>\u5728\u5bc6\u7801\u5b66\u4e2d\uff0c\u521d\u59cb\u5316\u5411\u91cf\uff08Initialization Vector\uff0c\u7b80\u79f0 IV\uff09\u662f\u4e00\u4e2a\u5728\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u56fa\u5b9a\u957f\u5ea6\u7684\u968f\u673a\u6216\u4f2a\u968f\u673a\u503c\u3002\u5b83\u4e0e\u7b2c\u4e00\u4e2a\u5757\u7684\u660e\u6587\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u5373\u4f7f\u76f8\u540c\u7684\u660e\u6587\u5757\u591a\u6b21\u52a0\u5bc6\uff0c\u4e5f\u4f1a\u4ea7\u751f\u4e0d\u540c\u7684\u5bc6\u6587\u5757\uff0c\u4ece\u800c\u589e\u52a0\u52a0\u5bc6\u7684\u5b89\u5168\u6027\u3002</p> <p>\u5728\u4f7f\u7528\u50cf AES \u8fd9\u6837\u7684\u5757\u52a0\u5bc6\u7b97\u6cd5\u65f6\uff0c\u6bcf\u4e2a\u6570\u636e\u5757\uff08\u901a\u5e38\u662f 16 \u5b57\u8282\uff09\u90fd\u9700\u8981\u4f7f\u7528\u5bc6\u94a5\u8fdb\u884c\u52a0\u5bc6\u3002\u5982\u679c\u4e0d\u4f7f\u7528 IV\uff0c\u90a3\u4e48\u76f8\u540c\u7684\u660e\u6587\u5757\u5c06\u603b\u662f\u4ea7\u751f\u76f8\u540c\u7684\u5bc6\u6587\u5757\uff0c\u8fd9\u5c06\u4f7f\u5f97\u52a0\u5bc6\u7b97\u6cd5\u5bb9\u6613\u88ab\u653b\u51fb\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#22-esp32-aes-menuconfig","title":"2.2 ESP32 \u5173\u4e8e AES \u7684 menuconfig \u9009\u9879","text":"<p>\u53ef\u4ee5\u9009\u62e9\u6253\u5f00\u786c\u4ef6 AES \u52a0\u901f, \u5e76\u6709\u5982\u4e0b\u8bbe\u7f6e</p> <ul> <li><code>CONFIG_MBEDTLS_AES_USE_INTERRUPT</code> </li> <li><code>CONFIG_MBEDTLS_AES_INTERRUPT_LEVEL</code></li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#23-aes","title":"2.3 AES \u586b\u5145","text":"<p>AES-128-CBC \u5c5e\u4e8e\u5206\u7ec4\u5bf9\u79f0\u52a0\u5bc6\u7b97\u6cd5\uff1a\u540c\u4e00\u7ec4 key \u8fdb\u884c\u660e\u6587\u548c\u5bc6\u6587\u7684\u8f6c\u6362</p> <p>\u4f7f\u7528 16B \u4e3a\u4e00\u7ec4\u8fdb\u884c\u52a0\u5bc6\uff0c\u5373\u660e\u6587\u7684 16B \u5bf9\u5e94\u4e00\u7ec4\u52a0\u5bc6\u540e\u7684 16B \u5bc6\u6587\u3002\u56e0\u6b64 AES-CBC \u9700\u8981\u660e\u6587\u4e3a 16B \u7684\u500d\u6570\uff0c\u5728\u4e0d\u6ee1 16B \u7684\u65f6\u5019\u9700\u8981\u5bf9\u660e\u6587\u8fdb\u884c\u586b\u5145\uff0c\u901a\u5e38\u7684\u586b\u5145\u65b9\u6cd5\u4e3a PKCS7\uff08Public-Key Cryptography Standards 7\uff09\uff1a</p> <p>\u5f53\u52a0\u5bc6\u5230\u6700\u540e\u4e00\u7ec4\u7684\u65f6\u5019\uff1a\u82e5\u4e0d\u8db3 16B \u5219\u586b\u5145\u957f\u5ea6\u4e3a\u6070\u597d\u8865\u8db3\u5230 16B \u7684\u957f\u5ea6\uff0c\u586b\u5145\u5185\u5bb9\u5373\u586b\u5145\u957f\u5ea6\u503c\u672c\u8eab\uff1b\u82e5\u6070\u597d\u4e3a 16B \u5219\u6700\u540e\u52a0\u5165\u4e00\u4e2a 16B \u7684 0x10 \u7ec4\u518d\u8fdb\u884c\u52a0\u5bc6\u3002</p> <p>\u4f20\u5165\u660e\u6587\u300116B \u7684 key\u300116B \u7684\u521d\u59cb\u504f\u79fb\u5411\u91cf IV</p> <p>\u521d\u59cb\u5411\u91cf\u548c key \u52a0\u5bc6\u7b2c\u4e00\u7ec4\u6570\u636e\u4e4b\u540e\uff0c\u4f1a\u5c06\u7b2c\u4e00\u7ec4\u52a0\u5bc6\u540e\u7684\u5bc6\u6587\u8d4b\u503c\u7ed9 IV\uff0c\u7136\u540e\u518d\u8fdb\u884c\u7b2c\u4e8c\u7ec4\u52a0\u5bc6\uff0c\u5faa\u73af\u76f4\u5230\u7ed3\u675f\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#24-mbedtls","title":"2.4 Mbedtls \u5e93","text":"<p>\u4f7f\u7528\u8be5\u5e93\u51fd\u6570\u4e4b\u524d\u9700\u8981\u521d\u59cb\u5316\u8bed\u5883\uff08contex\uff09\u4ee5\u53ca\u8bbe\u7f6e\u52a0\u89e3\u5bc6\u7684\u5bc6\u94a5</p> <pre><code>mbedtls_aes_init(&amp;aes_ctx);\n\nmbedtls_aes_setkey_dec(&amp;aes_ctx, aes_key, 128);\nmbedtls_aes_setkey_enc(&amp;aes_ctx, aes_key, 128);\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240618-SNTP%20%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4%E3%80%81AES%20%E5%8A%A0%E5%AF%86/#25-aes-api","title":"2.5 \u95e8\u7981 AES \u4efb\u52a1 API","text":"<pre><code>uint8_t aes_enc_uint8(mbedtls_aes_context *aes_ctx, uint8_t *input_iv, uint8_t *plain, uint8_t *cipher, size_t *cipher_len)\n</code></pre> <pre><code>/**\n * @brief AES\u52a0\u5bc6\u4efb\u52a1\uff0c\u5bc6\u6587\u8f93\u51fa\u4e3auint8_t\uff0cHEX\u683c\u5f0f\n *\n * @param aes_ctx AES\u4e0a\u4e0b\u6587\n * @param[in] input_iv \u672c\u6b21\u52a0\u5bc6\u7684\u504f\u79fb\u91cfIV\n * @param[in] plain \u9700\u8981\u88ab\u52a0\u5bc6\u7684\u660e\u6587\uff0c\u53ef\u4e0d\u5b9a\u957f\uff0c\u6700\u5927\u4e0d\u53ef\u8d85\u8fc7 AES_TASK_MAX_LEN\n * @param[out] cipher \u52a0\u5bc6\u540e\u8f93\u51fa\u7684\u5bc6\u6587\uff0c\u957f\u5ea6\u4e0e\u8f93\u5165\u7684\u660e\u6587\u957f\u5ea6\u76f8\u540c\n * @param[out] cipher_len \u52a0\u5bc6\u540e\u8f93\u51fa\u7684\u5bc6\u6587\u957f\u5ea6\n *\n * @return 0: \u52a0\u5bc6\u6210\u529f\n * @return 1: \u660e\u6587\u4e3a\u7a7a\n * @return 2: \u660e\u6587\u8fc7\u957f\n *\n * @attention \u672c\u51fd\u6570\u4f1a\u81ea\u52a8\u5bf9\u8f93\u5165\u7684\u660e\u6587\u8fdb\u884cPKCS7\u586b\u5145\n */\n</code></pre> <pre><code>uint8_t aes_dec_uint8(mbedtls_aes_context *aes_ctx, uint8_t *input_iv, uint8_t *plain, uint8_t *cipher, size_t cipher_len)\n</code></pre> <pre><code>/**\n * @brief AES\u89e3\u5bc6\u4efb\u52a1\uff0c\u660e\u6587\u8f93\u51fa\u4e3auint8_t\uff0c\u5b57\u7b26\u4e32\u683c\u5f0f\n *\n * @param aes_ctx AES\u4e0a\u4e0b\u6587\n * @param[in] input_iv \u672c\u6b21\u89e3\u5bc6\u7684\u504f\u79fb\u91cfIV\n * @param[out] plain \u89e3\u5bc6\u540e\u8f93\u51fa\u7684\u660e\u6587\n * @param[in] cipher \u9700\u8981\u88ab\u89e3\u5bc6\u7684\u5bc6\u6587\uff0c\u6700\u5927\u957f\u5ea6\u4e0d\u53ef\u8d85\u8fc7 AES_TASK_MAX_LEN\n * @param[in] cipher_len \u9700\u8981\u88ab\u89e3\u5bc6\u7684\u5bc6\u6587\u957f\u5ea6\n *\n * @return 0: \u89e3\u5bc6\u6210\u529f\n * @return 1: \u5bc6\u6587\u4e3a\u7a7a\n * @return 2: \u5bc6\u6587\u8fc7\u957f\n * @return 3: \u586b\u5145\u9519\u8bef\n *\n * @attention \u672c\u51fd\u6570\u4f1a\u81ea\u52a8\u5bf9\u8f93\u51fa\u7684\u660e\u6587\u79fb\u9664PKCS7\u586b\u5145\n */\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u6839\u636e\u84dd\u7259\u79c1\u6709\u534f\u8bae\u5c01\u88c5\u7684\u6253\u5305/\u89e3\u5305\u6570\u636e\u5e27\u51fd\u6570</p> <p></p> <pre><code>uint8_t data_frame_packing(uint8_t *payload, size_t payload_len, uint8_t *frame, size_t *frame_len)\n</code></pre> <pre><code>/**\n * @brief \u6253\u5305\u6570\u636e\u5e27\n *\n * @param[in] payload \u9700\u8981\u52a0\u5bc6\u7684\u7279\u5f81\u503c\u8d1f\u8f7d\n * @param[in] payload_len \u7279\u5f81\u503c\u957f\u5ea6\n * @param[out] frame \u6307\u5411\u6570\u636e\u5e27\u7684\u6307\u9488\u5730\u5740\n * @param[out] frame_len \u8f93\u51fa\u7684\u6570\u636e\u5e27\u957f\u5ea6\n *\n * @return 0: \u6253\u5305\u6210\u529f\n * @return 1: AES\u5bc6\u94a5\u8bbe\u7f6e\u9519\u8bef\n * @return 2: \u52a0\u5bc6\u9519\u8bef\n *\n * @note \u6682\u672a\u652f\u6301\u5206\u5305\u64cd\u4f5c\n */\n</code></pre> <pre><code>uint8_t data_frame_unpacking(uint8_t *frame, size_t frame_len, uint8_t *payload, size_t *payload_len)\n</code></pre> <pre><code>/**\n * @brief \u89e3\u5305\u6570\u636e\u5e27\n *\n * @param[in] frame \u63a5\u6536\u5230\u7684\u6570\u636e\u5e27\n * @param[in] frame_len \u6570\u636e\u5e27\u957f\u5ea6\n * @param[out] payload \u89e3\u5bc6\u540e\u7684\u7279\u5f81\u503c\u8d1f\u8f7d\n * @param[out] payload_len \u7279\u5f81\u503c\u8d1f\u8f7d\u957f\u5ea6\n *\n * @return 0: \u89e3\u5305\u6210\u529f\n * @return 1: \u5e27\u5934\u9519\u8bef\n * @return 2: AES\u5bc6\u94a5\u8bbe\u7f6e\u9519\u8bef\n * @return 3: \u89e3\u5bc6\u9519\u8bef\n * @return 4: CRC\u6821\u9a8c\u9519\u8bef\n *\n * @note \u6682\u672a\u652f\u6301\u5206\u5305\u64cd\u4f5c\n *\n */\n</code></pre> <p>\u4f7f\u7528\u65f6, \u5e94\u5f53\u5148\u7ef4\u62a4\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf <code>uint8_t aes_key[16] = AES_KEY_DEFAULT;</code> \u7528\u4e8e\u63d0\u4f9b\u5bc6\u94a5</p> <p>\u7cfb\u7edf\u5728\u521d\u59cb\u5316\u9636\u6bb5\u5e94\u5f53\u901a\u8fc7\u8bfb\u53d6\u521d\u59cb\u53c2\u6570\u83b7\u53d6\u5386\u53f2\u5b58\u50a8\u8fc7\u7684\u5bc6\u94a5, \u5e76\u66ff\u6362\u5168\u5c40\u53d8\u91cf\u7684\u9ed8\u8ba4\u503c.</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/","title":"240619-\u84dd\u7259\u5f00\u53d1","text":"<p>ESP32-S3 \u7684 ESP-Bluedroid \u4ec5\u652f\u6301\u4f4e\u529f\u8017\u84dd\u7259, \u4e0d\u652f\u6301\u7ecf\u5178\u84dd\u7259</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#1","title":"1 \u57fa\u7840\u6982\u5ff5","text":"<p>\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/qq_36347513/article/details/118567281</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#11-gatt","title":"1.1 GATT","text":"<p>\u57fa\u4e8e Attribute Protocal(\u5c5e\u6027\u534f\u8bae)\u5b9a\u4e49\u7684\u4e00\u4e2a service(\u670d\u52a1)\u6846\u67b6\u3002\u8fd9\u4e2a\u6846\u67b6\u5b9a\u4e49\u4e86 Services \u4ee5\u53ca\u5b83\u4eec\u7684 Characteristics \u7684\u683c\u5f0f\u548c\u89c4\u7a0b\u3002\u89c4\u7a0b\u5c31\u662f\u5b9a\u4e49\u4e86\u5305\u62ec\u53d1\u73b0\u3001\u8bfb\u3001\u5199\u3001\u901a\u77e5\u3001\u6307\u793a\u4ee5\u53ca\u914d\u7f6e\u5e7f\u64ad\u7684 characteristics\u3002</p> <p>\u6846\u67b6\u8fd8\u5b9a\u4e49\u4e86\u5728\u84dd\u7259\u901a\u4fe1\u4e2d\u7684\u4e24\u4e2a\u89d2\u8272, \u5ba2\u6237\u7aef\u4ee5\u53ca\u670d\u52a1\u5668\uff0c\u4e00\u822c\u7ec8\u7aef\u8bbe\u5907\u7684 ble \u5de5\u4f5c\u5728 server \u6a21\u5f0f\u3002</p> <p>\u5f53\u4e24\u4e2a\u8bbe\u5907\u5efa\u7acb\u4e86\u8fde\u63a5\u540e\u5373\u8868\u793a GAP \u534f\u8bae\u7ba1\u7406\u7684\u5e7f\u64ad\u8fc7\u7a0b\u5df2\u7ecf\u7ed3\u675f\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#12-profile","title":"1.2 Profile","text":"<p>\u4e00\u822c\u7406\u89e3\u505a\u89c4\u8303, \u5206\u6210\u6807\u51c6\u4ee5\u53ca\u975e\u6807\u51c6\uff0c \u6216\u8005\u516c\u6709\u4ee5\u53ca\u79c1\u6709\u89c4\u8303\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#13-service","title":"1.3 Service","text":"<p>\u7406\u89e3\u6210\u670d\u52a1\uff0c\u5b58\u5728\u4e8e Profile \u4e0b\u3002\u6bcf\u4e2a Service \u5305\u542b\u6709\u82e5\u5e72\u4e2a Characteristic\uff0c\u5373\u7279\u5f81\u3002</p> <p>\u6bcf\u4e2a\u7279\u5f81\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6807\u7b7e\uff0c\u662f\u5b9e\u9645\u60f3\u8981\u4f20\u8f93\u7684\u4fe1\u606f\u8f7d\u4f53\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#14-characteristic","title":"1.4 Characteristic","text":"<p>\u82e5\u7279\u5f81\u503c\u652f\u6301\u901a\u77e5\u4ee5\u53ca\u6307\u793a\u529f\u80fd\uff0c\u5219\u8be5\u7279\u5f81\u503c\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u989d\u5916\u7684 ATT\u2014\u2014CCCD\uff08Client Characteristic Configuration Descriptor\uff09</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#15-uuid","title":"1.5 UUID","text":"<p>\u6240\u6709\u7684\u670d\u52a1\u4ee5\u53ca\u7279\u5f81\u90fd\u9700\u8981\u6709\u552f\u4e00\u4e00\u4e2a UUID \u6765\u6807\u8bc6\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#2-ble_gatt_server_service_table","title":"2 \u57fa\u4e8e../ble_gatt_server_service_table \u4f8b\u7a0b\u7684\u4e8c\u6b21\u5f00\u53d1","text":"<p>\u5b98\u65b9 GATT_SERVER_API \u53c2\u8003: https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/bluetooth/esp_gatts.html</p> <p>\u4f8b\u7a0b\u6e90\u7801: https://github.com/espressif/esp-idf/tree/d7ca8b94/examples/bluetooth/bluedroid/ble/gatt_server_service_table</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#21-app-profiles","title":"2.1 APP Profiles","text":"<p>demo \u4e2d\u53ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7528\u4e8e\u6d4b\u91cf\u5fc3\u7387\u7684 Profile\uff0c\u5f00\u5934\u7684\u5b8f\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>#define PROFILE_NUM 1\n#define PROFILE_APP_IDX 0\n#define ESP_APP_ID 0x55\n</code></pre> <p>\u5176\u4e2d ESP_APP_ID \u662f\u7531\u7528\u6237\u5b9a\u4e49\u7684\u4e00\u4e2a ID\uff0c\u7528\u4e8e\u533a\u522b\u4e0d\u540c\u7684 profile\u3002</p> <p>\u5728 IDF \u4e2d profile \u88ab\u4fdd\u5b58\u5728\u4e00\u4e2a\u7c7b\u578b\u4e3a <code>gatts_profile_inst</code> \u7684\u6570\u7ec4\u4e2d\uff0c\u5e76\u9700\u8981\u6307\u5b9a <code>gatts_cb</code> \u4ee5\u53ca <code>gatts_if</code> \uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>static struct gatts_profile_inst heart_rate_profile_tab[HEART_PROFILE_NUM] = {\n    [HEART_PROFILE_APP_IDX] = {\n        .gatts_cb = gatts_profile_event_handler,\n        .gatts_if = ESP_GATT_IF_NONE,\n    },\n};\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#22","title":"2.2 \u8bbe\u7f6e\u5e7f\u64ad\u6570\u636e","text":"<p>\u6ce8\u518c\u5e94\u7528\u7a0b\u5e8f\u4e8b\u4ef6\u662f\u5728\u7a0b\u5e8f\u751f\u547d\u5468\u671f\u4e2d\u89e6\u53d1\u7684\u7b2c\u4e00\u4e2a\u4e8b\u4ef6\u3002</p> <p>\u6b64\u793a\u4f8b\u4f7f\u7528\u6b64\u4e8b\u4ef6\u5728\u6ce8\u518c\u6982\u8981\u6587\u4ef6\u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u65f6\u914d\u7f6e\u5e7f\u64ad\u53c2\u6570\u3002\u7528\u4e8e\u5b9e\u73b0\u6b64\u76ee\u7684\u7684\u51fd\u6570\u6709\uff1a</p> <ul> <li><code>esp_ble_gap_set_device_name()</code>: \u7528\u4e8e\u8bbe\u7f6e\u88ab\u5e7f\u64ad\u7684\u8bbe\u5907\u540d\u79f0\u3002</li> <li><code>esp_ble_gap_config_adv_data()</code>: \u7528\u4e8e\u914d\u7f6e\u6807\u51c6\u5e7f\u64ad\u6570\u636e\u3002</li> </ul> <p>\u540e\u8005\u63a5\u6536\u4e00\u4e2a\u6307\u5411 <code>esp_ble_adv_data_t</code> \u7c7b\u578b\u7ed3\u6784\u4f53\u7684\u6307\u9488\uff0c\u8be5\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e86\u5e7f\u64ad\u6570\u636e\u5305\u7684\u5177\u4f53\u8d1f\u8f7d\u3002\u6b64\u5904\u9700\u8981\u6ce8\u610f\uff0c\u4e00\u822c\u5e7f\u64ad\u6570\u636e\u5305\u7684\u5177\u4f53\u8d1f\u8f7d\u4e0d\u80fd\u8d85\u8fc7 31 \u4e2a\u5b57\u8282\uff0c\u5426\u5219\u5c06\u4f1a\u88ab\u5806\u6808\u622a\u65ad\u540e\u9762\u7684\u6d88\u606f\u3002</p> <p>\u4e00\u822c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u8f83\u957f\u7684\u53c2\u6570\u53ef\u4ee5\u5b58\u50a8\u5728\u626b\u63cf\u54cd\u5e94\u4e2d\u3002\u5982\u679c\u8981\u91c7\u53d6\u626b\u63cf\u54cd\u5e94\u7684\u8bdd\uff0c\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a <code>esp_ble_adv_data_t</code> \u7c7b\u578b\u7684\u7ed3\u6784\u4f53\uff0c\u5e76\u5c06 <code>set_scan_rsp</code> \u8bbe\u7f6e\u4e3a <code>true</code> \u540e\u4f7f\u7528\u76f8\u540c\u7684\u51fd\u6570\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u4ee5\u4e0a\u7684\u64cd\u4f5c\u88ab\u653e\u5728 <code>gatts_profile_event_handler</code> \u8fd9\u4e2a\u51fd\u6570\u4e2d\u7684 <code>ESP_GATTS_REG_EVT</code> \u4e8b\u4ef6\u4e2d\uff0c\u4e00\u65e6\u8bbe\u7f6e\u5b8c\u5e7f\u64ad\u6570\u636e\u4e4b\u540e\uff0c\u5c06\u4f1a\u89e6\u53d1 <code>ESP_GAP_BLE_ADV_DATA_SET_COMPLETE_EVT</code> \u4e8b\u4ef6\uff0c\u5e76\u4ea4\u7531 <code>gap_event_handler</code> \u51fd\u6570\u8fdb\u884c\u7ba1\u7406\uff0c\u82e5\u4e5f\u8bbe\u7f6e\u4e86\u626b\u63cf\u54cd\u5e94\uff0c\u5219 <code>ESP_GAP_BLE_SCAN_RSP_DATA_SET_COMPLETE_EVT</code> \u4e8b\u4ef6\u4e5f\u4f1a\u88ab\u89e6\u53d1\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#23-gap-gap_event_handler","title":"2.3 GAP \u4e8b\u4ef6\uff08<code>gap_event_handler</code>\uff09","text":"<p>\u63a5\u7740\u4e0a\u9762\uff0c\u5982\u679c\u5e7f\u64ad\u6570\u636e\u4e24\u4e2a\u4e8b\u4ef6\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u4e8b\u4ef6\uff08\u8bbe\u7f6e\u5e7f\u64ad\u6570\u636e\u6216\u8bbe\u7f6e\u626b\u63cf\u54cd\u5e94\u5b8c\u6210\uff09\u88ab\u89e6\u53d1\uff0c\u5219\u4f1a\u8c03\u7528 <code>esp_ble_gap_start_advertising</code> \u51fd\u6570\u6765\u5f00\u59cb\u5e7f\u64ad\uff0c\u8be5\u51fd\u6570\u9700\u8981\u4e00\u4e2a <code>esp_ble_adv_params_t</code> \u7c7b\u578b\u7684\u5e7f\u64ad\u53c2\u6570\u3002</p> <p>\u8be5\u53c2\u6570\u6307\u5b9a\u4e86\u5f00\u542f\u5e7f\u64ad\u6240\u9700\u7684\u5404\u79cd\u53c2\u6570\uff0c\u4f8b\u5982\u5e7f\u64ad\u95f4\u9694\u3001\u5e7f\u64ad\u7c7b\u578b\u3001\u5e7f\u64ad\u4fe1\u9053\u4ee5\u53ca\u5e7f\u64ad\u8fc7\u6ee4\u7b56\u7565\u7b49\uff1a</p> <pre><code>/// \u5e7f\u64ad\u53c2\u6570\ntypedef struct {\n    uint16_t adv_int_min; /*!&lt; \u672a\u5b9a\u5411\u548c\u4f4e\u5360\u7a7a\u6bd4\u5b9a\u5411\u5e7f\u64ad\u7684\u6700\u5c0f\u5e7f\u64ad\u95f4\u9694\u3002\n    \u8303\u56f4\uff1a0x0020\u52300x4000\n    \u9ed8\u8ba4\u503c\uff1aN = 0x0800\uff081.28\u79d2\uff09\n    \u65f6\u95f4= N * 0.625\u6beb\u79d2\n    \u65f6\u95f4\u8303\u56f4\uff1a20\u6beb\u79d2\u523010.24\u79d2 */\n    uint16_t adv_int_max; /*!&lt; \u672a\u5b9a\u5411\u548c\u4f4e\u5360\u7a7a\u6bd4\u5b9a\u5411\u5e7f\u64ad\u7684\u6700\u5927\u5e7f\u64ad\u95f4\u9694\u3002\n    \u8303\u56f4\uff1a0x0020\u52300x4000\n    \u9ed8\u8ba4\u503c\uff1aN = 0x0800\uff081.28\u79d2\uff09\n    \u65f6\u95f4= N * 0.625\u6beb\u79d2\n    \u65f6\u95f4\u8303\u56f4\uff1a20\u6beb\u79d2\u523010.24\u79d2 */\n    esp_ble_adv_type_t adv_type;            /*!&lt; \u5e7f\u64ad\u7c7b\u578b */\n    esp_ble_addr_type_t own_addr_type;      /*!&lt; \u6240\u6709\u8005\u84dd\u7259\u8bbe\u5907\u5730\u5740\u7c7b\u578b */\n    esp_bd_addr_t peer_addr;                /*!&lt; \u5bf9\u7b49\u65b9\u8bbe\u5907\u7684\u84dd\u7259\u8bbe\u5907\u5730\u5740 */\n    esp_ble_addr_type_t peer_addr_type;     /*!&lt; \u5bf9\u7b49\u65b9\u8bbe\u5907\u7684\u84dd\u7259\u8bbe\u5907\u5730\u5740\u7c7b\u578b */\n    esp_ble_adv_channel_t channel_map;      /*!&lt; \u5e7f\u64ad\u901a\u9053\u6620\u5c04 */\n    esp_ble_adv_filter_t adv_filter_policy; /*!&lt; \u5e7f\u64ad\u8fc7\u6ee4\u7b56\u7565 */\n} esp_ble_adv_params_t;\n</code></pre> <p>\u4f8b\u7a0b\u4e2d\u914d\u7f6e\u7684\u51e0\u4e2a\u91cd\u8981\u53c2\u6570\uff1a</p> <ul> <li><code>adv_type</code> - <code>ADV_ IND</code> \u7c7b\u578b\uff0c\u901a\u7528\u7c7b\u578b\uff0c\u4e0d\u9488\u5bf9\u7279\u5b9a\u7684\u4e2d\u5fc3\u8bbe\u5907\uff0c\u5e7f\u64ad\u670d\u52a1\u5668\u4e3a\u53ef\u8fde\u63a5\u7684\u3002</li> <li><code>own_addr_type</code> - <code>BLE_ADDR_TYPE_PUBLIC</code> \u516c\u5171\u5730\u5740\u7c7b\u578b</li> <li><code>channel_map</code> - <code>ADV_CHNL_ALL</code> \u4f7f\u7528\u6240\u6709\u901a\u9053</li> <li><code>adv_filter_policy</code> - <code>ADV_FILTER_ALLOW_SCAN_ANY_CON_ANY</code> \u5141\u8bb8\u6765\u81ea\u4efb\u4f55\u4e2d\u5fc3\u8bbe\u5907\u7684\u626b\u63cf\u548c\u8fde\u63a5\u8bf7\u6c42</li> </ul> <p>\u4e00\u65e6\u5e7f\u64ad\u6210\u529f\u5f00\u59cb\u540e\uff0c<code>esp_ble_gap_start_advertising</code> \u51fd\u6570\u5c06\u4f1a\u89e6\u53d1 <code>ESP_GAP_BLE_ADV_START_COMPLETE_EVT</code> \u4e8b\u4ef6\uff0c\u4f8b\u7a0b\u4e2d\u5728\u8fd9\u4e2a\u4e8b\u4ef6\u4e2d\u53ea\u662f\u5355\u7eaf\u68c0\u67e5\u5e7f\u64ad\u72b6\u6001\uff0c\u5e76\u6253\u5370\u6d88\u606f\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#24-gatt","title":"2.4 GATT \u4e8b\u4ef6","text":"<p>\u5e94\u7528\u7684 <code>Profile</code> \u6ce8\u518c\u64cd\u4f5c\u5728\u4f8b\u7a0b\u4e2d\u7684 <code>ble_server_task_init</code> \u521d\u59cb\u5316\u6d41\u7a0b\u4e2d\u901a\u8fc7\u8c03\u7528 <code>esp_ble_gatts_app_register</code> \u51fd\u6570\u5b9e\u73b0\uff0c\u8be5\u51fd\u6570\u4f7f\u7528\u4e00\u4e2a <code>APP ID</code> \u7528\u4e8e\u533a\u5206\u5404\u79cd\u5e94\u7528\u5c42\u7684\u56de\u8c03\u3002</p> <p>\u8c03\u7528 <code>esp_ble_gatts_app_register</code> \u51fd\u6570\u540e\uff0c <code>ESP_GATTS_REG_EVT</code> \u4e8b\u4ef6\u5c06\u4f1a\u88ab\u89e6\u53d1\uff0c\u8be5\u4e8b\u4ef6\u4f1a\u88ab <code>gatts_event_handler</code> \u51fd\u6570\u6355\u83b7\uff0c\u7136\u540e\u5c06\u751f\u6210\u7684 <code>gatt_if</code>\uff08interface\uff09\u63a5\u53e3\u5b58\u653e\u5728 <code>profile_tab</code> \u4e2d\uff0c\u4e5f\u5c31\u662f\u4e00\u5f00\u59cb\u521d\u59cb\u5316\u7684\u65f6\u5019\u8bbe\u7f6e\u4e3a <code>ESP_GATT_IF_NONE</code> \u7684 <code>Profile</code>\u3002</p> <p>\u672c\u4f8b\u4e2d\u5b9a\u4e49\u7684\u5e94\u7528\u7a0b\u5e8f\u53ea\u6709\u4e00\u4e2a <code>Profile</code>\uff0c\u56e0\u6b64\u5728\u5c06\u751f\u6210\u7684\u63a5\u53e3\u5b58\u653e\u8fc7\u53bb\u4e4b\u540e\uff0c\u4e5f\u5c31\u76f8\u5f53\u4e8e\u5c06\u5176\u8f6c\u53d1\u5230\u76f8\u5e94\u7684 <code>gatts_profile_event_handler</code> \u51fd\u6570\u4e2d\uff0c\u5f00\u59cb\u5bf9\u8fd9\u4e2a <code>Profile</code> \u89e6\u53d1\u7684\u4e8b\u4ef6\u8fdb\u884c\u5904\u7406\u4e86\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#25","title":"2.5 \u670d\u52a1\u8868","text":"<pre><code>enum\n{\n    HRS_IDX_SVC,\n\n    HRS_IDX_HR_MEAS_CHAR,\n    HRS_IDX_HR_MEAS_VAL,\n    HRS_IDX_HR_MEAS_NTF_CFG,\n\n    HRS_IDX_BOBY_SENSOR_LOC_CHAR,\n    HRS_IDX_BOBY_SENSOR_LOC_VAL,\n\n    HRS_IDX_HR_CTNL_PT_CHAR,\n    HRS_IDX_HR_CTNL_PT_VAL,\n\n    HRS_IDX_NB,\n};\n</code></pre> <p>\u8fd9\u4e2a\u679a\u4e3e\u5143\u7d20\u5b9a\u4e49\u4e86\u5fc3\u7387\u670d\u52a1\u7684\u4e00\u7cfb\u5217\u7d22\u5f15\uff0c\u6bcf\u4e2a\u670d\u52a1\u548c\u7279\u5f81\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u7d22\u5f15\uff0c\u8fd9\u4e9b\u7d22\u5f15\u7528\u4e8e\u5728\u4ee3\u7801\u4e2d\u5e94\u7528\u7279\u5b9a\u7684\u670d\u52a1\u548c\u7279\u5f81\u3002</p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u7ba1\u7406\u548c\u64cd\u4f5c GATT_server \u7684\u7279\u6027\u3002</p> <p>HRS for Heart Rate Service.</p> <p>BTW\uff0c\u8fd9\u4e2a\u670d\u52a1\u8868\u4e2d\u7684\u679a\u4e3e\u7c7b\u578b\u4e3a\u81ea\u5df1\u5b9a\u4e49\u7684\u4e1c\u897f\uff0c\u4f8b\u7a0b\u53ea\u662f\u7ed9\u51fa\u4e86\u4e00\u4e2a\u5fc3\u7387\u6d4b\u91cf\u5e94\u7528\u573a\u666f\u4e0b\u7684\u6837\u4f8b\u3002walkthrough \u6587\u6863\u4e2d\u7684\u4ee3\u7801\u4f3c\u4e4e\u662f\u6bd4\u8f83\u65e9\u7684\u7248\u672c\u4e86\uff0c\u73b0\u5728\u7684\u5b9e\u9645\u4ee3\u7801\u6587\u4ef6\u4e2d\u7ed9\u51fa\u7684\u4f8b\u5b50\u662f\u8fd9\u6837\u7684\uff0c\u901a\u7528\u6027\u66f4\u5f3a\u4e00\u70b9\uff1a</p> <pre><code>enum\n{\n    IDX_SVC,\n    IDX_CHAR_A,\n    IDX_CHAR_VAL_A,\n    IDX_CHAR_CFG_A,\n\n    IDX_CHAR_B,\n    IDX_CHAR_VAL_B,\n\n    IDX_CHAR_C,\n    IDX_CHAR_VAL_C,\n\n    HRS_IDX_NB,\n};\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#26-attribute-table-services-characteristics","title":"2.6 \u901a\u8fc7\u5c5e\u6027\u8868\uff08Attribute Table\uff09\u521b\u5efa Services \u548c Characteristics","text":"<p>\u6ce8\u518c Services \u548c Characteristics \u7684\u4e8b\u4ef6\u901a\u8fc7\u4f7f\u7528 <code>esp_ble_gatts_create_attr_tab</code> \u51fd\u6570\u6765\u521b\u5efa\u5c5e\u6027\u8868\uff0c\u8be5\u51fd\u6570\u9700\u8981\u4e00\u4e2a\u7c7b\u578b\u4e3a <code>esp_gatts_attr_db_t</code> \u7684\u53c2\u6570\u3002\u8be5\u53c2\u6570\u7531\u679a\u4e3e\u503c\u8fdb\u884c\u7d22\u5f15\uff0c\u5373\u4e0a\u8282\u5b9a\u4e49\u7684\u670d\u52a1\u8868\uff0c\u5305\u62ec\u4e24\u4e2a\u6210\u5458\uff1a</p> <pre><code>typedef struct {\n    esp_attr_control_t      attr_control; \n    esp_attr_desc_t         att_desc;  \n} esp_gatts_attr_db_t;\n</code></pre> <p>\u7b2c\u4e00\u4e2a\u662f\u81ea\u52a8\u54cd\u5e94\u53c2\u6570\uff0c\u6709\u4e24\u4e2a\u53ef\u9009\uff1a</p> <ul> <li><code>ESP_GATT_AUTO_RSP</code> - \u5141\u8bb8 BLE \u5806\u6808\u5bf9\u4e8e\u8bfb\u53d6\u6216\u5199\u5165\u4e8b\u4ef6\u5230\u8fbe\u65f6\u81ea\u52a8\u53d1\u9001\u54cd\u5e94\u6d88\u606f</li> <li><code>ESP_GATT_RSP_BY_APP</code> - \u4f7f\u7528 <code>esp_ble_gatts_send_response</code> \u51fd\u6570\u8fdb\u884c\u624b\u52a8\u54cd\u5e94\u6d88\u606f</li> </ul> <p>\u7b2c\u4e8c\u4e2a\u662f\u5c5e\u6027\u7c7b\u578b\uff1a</p> <pre><code>uint16_t uuid_length;      /*!&lt; UUID\u957f\u5ea6 */\nuint8_t  *uuid_p;          /*!&lt; UUID\u503c */\nuint16_t perm;             /*!&lt; \u5c5e\u6027\u6743\u9650 */\nuint16_t max_length;       /*!&lt; \u5143\u7d20\u7684\u6700\u5927\u957f\u5ea6 */\nuint16_t length;           /*!&lt; \u5143\u7d20\u7684\u5f53\u524d\u957f\u5ea6 */\nuint8_t  *value;           /*!&lt; \u5143\u7d20\u503c\u6570\u7ec4*/\n</code></pre> <p>\u901a\u8fc7\u51fd\u6570 <code>esp_ble_gatts_create_attr_tab</code> \u521b\u5efa\u5b8c\u540e\u5c06\u4f1a\u89e6\u53d1 <code>ESP_GATTS_CREAT_ATTR_TAB_EVT</code> \u4e8b\u4ef6\uff0c\u7528\u4e8e\u6253\u5370\u5404\u79cd\u4fe1\u606f\uff0c\u68c0\u67e5\u521b\u5efa\u7684\u5c5e\u6027\u8868\u5927\u5c0f\u662f\u5426\u7b49\u4e8e <code>HRS_IDX_NB</code> \uff0c\u5728\u68c0\u67e5\u5b8c\u6210\u4e4b\u540e\u5c06\u4f1a\u5c06\u5c5e\u6027\u8868\u7684\u53e5\u67c4\u590d\u5236\u5230 <code>heart_rate_handle_table</code> \u4e2d\uff0c\u4ee5\u4fbf\u7528\u4e8e\u4f20\u9012\uff0c\u4ee5\u53ca\u7528\u4e8e app \u7684\u4e0a\u5c42\u6765\u8fdb\u884c\u4e0d\u540c\u7684\u64cd\u4f5c\u3002\u901a\u8fc7\u8fd9\u4e9b\u5c5e\u6027\u8868\u7684\u53e5\u67c4\uff0c\u53ef\u4ee5\u7528\u4e8e\u77e5\u9053\u5f53\u524d\u6b63\u5728\u8bfb\u53d6/\u5199\u5165\u54ea\u4e9b\u7279\u5f81\u3002</p> <p>\u6700\u540e\u901a\u8fc7 <code>esp_ble_gatts_start_service</code> \u51fd\u6570\u5f00\u59cb\u670d\u52a1\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#27-service","title":"2.7 \u6dfb\u52a0\u65b0\u7684 Service","text":"<ul> <li>\u5b8f\u5b9a\u4e49\u5904\u6dfb\u52a0\u65b0 Service \u5b9e\u4f8b\u7684 ID\uff0c\u5982\uff1a <pre><code>#define SVC_INST_ID1 1\n</code></pre></li> <li>\u6dfb\u52a0\u65b0\u7684 Service_handle_table\uff0c\u5982\uff1a <pre><code>uint16_t &lt;srvc&gt;_handle_table[&lt;svc&gt;_IDX_NB];\n</code></pre></li> <li>\u5b9a\u4e49\u65b0\u7684 Service \u4e0e Characteristic \u7684 UUID\uff0c\u5982\uff1a <pre><code>static const uint16_t &lt;srvc&gt;_SERVICE_UUID_DM = 0x00EE;\nstatic const uint16_t GATTS_CHAR_UUID_&lt;srvc&gt;_&lt;value&gt; = 0xEE01;\n</code></pre></li> <li>\u5b9a\u4e49\u65b0\u7684 Service database\uff0c\u5982\uff1a <pre><code>/* \u7279\u5f81\u503c\u4ee5\u53caUUID\u540d\u53ef\u80fd\u6709\u51fa\u5165 */\nstatic const esp_gatts_attr_db_t gatt_db2[DM_IDX_NB] = {\n    [IDX_SVC2] =\n        {{ESP_GATT_AUTO_RSP}, {ESP_UUID_LEN_16, (uint8_t *)&amp;primary_service_uuid, ESP_GATT_PERM_READ, \n        sizeof(uint16_t), sizeof(GATTS_SERVICE_UUID_DM), (uint8_t *)&amp;GATTS_SERVICE_UUID_DM}},\n\n    [IDX_CHAR_A2] =\n        {{ESP_GATT_AUTO_RSP}, {ESP_UUID_LEN_16, (uint8_t *)&amp;character_declaration_uuid, ESP_GATT_PERM_READ, \n        CHAR_DECLARATION_SIZE, CHAR_DECLARATION_SIZE, (uint8_t *)&amp;char_prop_read_write_notify}},\n\n    [IDX_CHAR_VAL_A2] =\n        {{ESP_GATT_AUTO_RSP}, {ESP_UUID_LEN_16, (uint8_t *)&amp;GATTS_CHAR_UUID_DM_A, ESP_GATT_PERM_READ | ESP_GATT_PERM_WRITE, \n        GATTS_DEMO_CHAR_VAL_LEN_MAX, sizeof(char_value2), (uint8_t *)char_value2}},\n};\n</code></pre></li> </ul> <p><code>esp_gatts_attr_db_t</code> \u7684\u6210\u5458\u5b9a\u4e49\u53c2\u8003\u5982\u4e0b\uff1a</p> <p><pre><code>/* esp_gatts_attr_db_t */\nesp_attr_control_t      attr_control; \nesp_attr_desc_t         att_desc;  \n</code></pre> <pre><code>/* esp_attr_desc_t */\nuint16_t uuid_length;      /*!&lt; UUID\u957f\u5ea6 */\nuint8_t  *uuid_p;          /*!&lt; UUID\u503c */\nuint16_t perm;             /*!&lt; \u5c5e\u6027\u6743\u9650 */\nuint16_t max_length;       /*!&lt; \u5143\u7d20\u7684\u6700\u5927\u957f\u5ea6 */\nuint16_t length;           /*!&lt; \u5143\u7d20\u7684\u5f53\u524d\u957f\u5ea6 */\nuint8_t  *value;           /*!&lt; \u5143\u7d20\u503c\u6570\u7ec4*/\n</code></pre></p> <p>\u5176\u4e2d\u4e00\u4e2a service \u9700\u8981\u5305\u542b\uff1a\u4e00\u4e2a\u4e3b\u670d\u52a1\u58f0\u660e\u3001\u7279\u5f81\u503c\u58f0\u660e\u3001\u7279\u5f81\u503c\u3002</p> <p>\u9664\u6b64\u4e4b\u5916\uff0c\u5982\u679c\u670d\u52a1\u5c5e\u6027\u6709 Notify \u5c5e\u6027\uff0c\u8fd8\u9700\u8981\u5305\u542b\u4e00\u4e2a CCCD\uff08\u5ba2\u6237\u7aef\u7279\u5f81\u503c\u914d\u7f6e\u63cf\u8ff0\u7b26\uff09\u3002</p> <p>\u4ee5\u4e0a\u53ea\u6709\u7279\u5f81\u503c\u7684 UUID \u662f\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u7684\uff0c\u5176\u4ed6\u4e09\u4e2a\u53ef\u4ee5\u53c2\u8003\u84dd\u7259\u89c4\u8303\uff0c\u4f8b\u7a0b\u4e2d\u4f7f\u7528\u4e86\u5982\u4e0b\u5b9a\u4e49\uff1a</p> <pre><code>static const uint16_t primary_service_uuid = ESP_GATT_UUID_PRI_SERVICE;\nstatic const uint16_t character_declaration_uuid = ESP_GATT_UUID_CHAR_DECLARE;\nstatic const uint16_t character_client_config_uuid = ESP_GATT_UUID_CHAR_CLIENT_CONFIG;\n</code></pre> <p>\u5173\u4e8e\u670d\u52a1\u4ee5\u53ca\u7279\u5f81\u503c\u7684\u8bfb\u5199\u5c5e\u6027\uff0c\u6ce8\u610f\u5982\u4e0b\u903b\u8f91\uff1a</p> <p>\u4e0d\u7ba1\u662f\u670d\u52a1\u58f0\u660e\u3001\u7279\u5f81\u503c\u58f0\u660e\u8fd8\u662f\u7279\u5f81\u503c\u672c\u8eab\uff0c\u90fd\u9700\u8981\u8bbe\u7f6e\u8bfb\u5199\u6743\u9650\uff0c\u8fd9\u91cc\u7684\u8bfb\u5199\u6743\u9650\u662f\u6307\u670d\u52a1\u7aef\u7684\u6743\u9650\uff0c\u5373\u670d\u52a1\u7aef\u662f\u5426\u5141\u8bb8\u5ba2\u6237\u7aef\u8bfb\u5199\u670d\u52a1\u58f0\u660e\u3001\u7279\u5f81\u503c\u58f0\u660e\u8fd8\u662f\u7279\u5f81\u503c\u3002</p> <p>\u800c\u5bf9\u4e8e\u7279\u5f81\u503c\u672c\u8eab\u7684\u5c5e\u6027\u6765\u8bf4\uff0c\u9700\u8981\u5728\u7279\u5f81\u503c\u58f0\u660e\u4e2d\u8bbe\u7f6e\u503c\u4ee5\u58f0\u660e\u662f\u5426\u5305\u542b\u8bfb\u5199\u5c5e\u6027\u4ee5\u53ca notify/indicate \u5c5e\u6027\u3002</p> <p>\u4e5f\u5c31\u662f\u6ce8\u610f\u533a\u5206\u4ee5\u4e0b\u4e24\u7ec4\u6982\u5ff5\uff1a</p> <pre><code>/* file: esp_gatt_defs.h */\n/* relate to BTA_GATT_PERM_xxx in bta/bta_gatt_api.h */\n/**\n * @brief Attribute permissions\n */\n#define    ESP_GATT_PERM_READ                  (1 &lt;&lt; 0)   /* bit 0 -  0x0001 */    /* relate to BTA_GATT_PERM_READ in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_READ_ENCRYPTED        (1 &lt;&lt; 1)   /* bit 1 -  0x0002 */    /* relate to BTA_GATT_PERM_READ_ENCRYPTED in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_READ_ENC_MITM         (1 &lt;&lt; 2)   /* bit 2 -  0x0004 */    /* relate to BTA_GATT_PERM_READ_ENC_MITM in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_WRITE                 (1 &lt;&lt; 4)   /* bit 4 -  0x0010 */    /* relate to BTA_GATT_PERM_WRITE in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_WRITE_ENCRYPTED       (1 &lt;&lt; 5)   /* bit 5 -  0x0020 */    /* relate to BTA_GATT_PERM_WRITE_ENCRYPTED in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_WRITE_ENC_MITM        (1 &lt;&lt; 6)   /* bit 6 -  0x0040 */    /* relate to BTA_GATT_PERM_WRITE_ENC_MITM in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_WRITE_SIGNED          (1 &lt;&lt; 7)   /* bit 7 -  0x0080 */    /* relate to BTA_GATT_PERM_WRITE_SIGNED in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_WRITE_SIGNED_MITM     (1 &lt;&lt; 8)   /* bit 8 -  0x0100 */    /* relate to BTA_GATT_PERM_WRITE_SIGNED_MITM in bta/bta_gatt_api.h */\n#define    ESP_GATT_PERM_READ_AUTHORIZATION    (1 &lt;&lt; 9)   /* bit 9 -  0x0200 */\n#define    ESP_GATT_PERM_WRITE_AUTHORIZATION   (1 &lt;&lt; 10)  /* bit 10 - 0x0400 */\n#define    ESP_GATT_PERM_ENCRYPT_KEY_SIZE(keysize)     (((keysize - 6) &amp; 0xF) &lt;&lt; 12)    /* bit 12:15 - 0xF000 */\ntypedef uint16_t esp_gatt_perm_t;\n\n/* relate to BTA_GATT_CHAR_PROP_BIT_xxx in bta/bta_gatt_api.h */\n/* definition of characteristic properties */\n#define    ESP_GATT_CHAR_PROP_BIT_BROADCAST    (1 &lt;&lt; 0)       /* 0x01 */    /* relate to BTA_GATT_CHAR_PROP_BIT_BROADCAST in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_READ         (1 &lt;&lt; 1)       /* 0x02 */    /* relate to BTA_GATT_CHAR_PROP_BIT_READ in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_WRITE_NR     (1 &lt;&lt; 2)       /* 0x04 */    /* relate to BTA_GATT_CHAR_PROP_BIT_WRITE_NR in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_WRITE        (1 &lt;&lt; 3)       /* 0x08 */    /* relate to BTA_GATT_CHAR_PROP_BIT_WRITE in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_NOTIFY       (1 &lt;&lt; 4)       /* 0x10 */    /* relate to BTA_GATT_CHAR_PROP_BIT_NOTIFY in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_INDICATE     (1 &lt;&lt; 5)       /* 0x20 */    /* relate to BTA_GATT_CHAR_PROP_BIT_INDICATE in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_AUTH         (1 &lt;&lt; 6)       /* 0x40 */    /* relate to BTA_GATT_CHAR_PROP_BIT_AUTH in bta/bta_gatt_api.h */\n#define    ESP_GATT_CHAR_PROP_BIT_EXT_PROP     (1 &lt;&lt; 7)       /* 0x80 */    /* relate to BTA_GATT_CHAR_PROP_BIT_EXT_PROP in bta/bta_gatt_api.h */\ntypedef uint8_t esp_gatt_char_prop_t;\n</code></pre> <ul> <li>\u4e8e\u5934\u6587\u4ef6\u4e2d\u5b9a\u4e49\u65b0\u7684\u5c5e\u6027\u8868\uff0c\u7528\u4e8e\u7ed9\u4e0a\u8ff0\u7b2c\u4e8c\u70b9\u7684 handle_table \u7d22\u5f15\uff0c\u4ee5\u4fbf\u540e\u7eed\u5f00\u53d1\u4e2d\u8bfb\u5199\u67d0 Service \u7684\u67d0\u7279\u5f81\u503c\uff0c\u5982\uff1a</li> </ul> <pre><code>/* \u8bbe\u5907\u7ba1\u7406\u76f8\u5173service\u8868 */\nenum\n{\n    IDX_SVC2,\n    IDX_CHAR_A2,\n    IDX_CHAR_VAL_A2,\n\n    DM_IDX_NB,\n\n};\n</code></pre> <ul> <li>\u4fee\u6539 <code>gatts_profile_event_handler</code> \u4e2d\u5bf9\u4e8e\u65b0\u5efa database \u7684\u903b\u8f91\uff0c\u4e3b\u8981\u601d\u8def\u4e3a**\u521b\u5efa\u4e00\u4e2a\u542f\u52a8\u4e00\u4e2a**\uff0c\u5173\u952e\u4fee\u6539\u90e8\u5206\u5982\u4e0b:</li> </ul> <pre><code>/* ESP_GATTS_REG_EVT \u4e8b\u4ef6\u5206\u652f */\nesp_err_t create_attr_ret = esp_ble_gatts_create_attr_tab(gatt_db, gatts_if, LOCK_IDX_NB, SVC_INST_ID);\n        if (create_attr_ret)\n        {\n            ESP_LOGE(GATTS_TABLE_TAG, \"create attr table failed, error code = %x\", create_attr_ret);\n        }\n</code></pre> <p>\u9996\u5148\u5728 <code>ESP_GATTS_REG_EVT</code> \u4e8b\u4ef6\u65f6\u521b\u5efa\u7b2c\u4e00\u4e2a database\uff0c\u8be5\u4e8b\u4ef6\u521b\u5efa\u6210\u529f\u540e\uff0c\u5c06\u4f1a\u89e6\u53d1 <code>ESP_GATTS_CREAT_ATTR_TAB_EVT</code> \u4e8b\u4ef6\uff0c\u6b64\u65f6\u518d\u521b\u5efa\u7b2c\u4e8c\u4e2a database\uff0c\u5982\u4e0b\uff1a</p> <p><code>ESP_GATTS_REG_EVT</code> \u88ab\u6700\u5f00\u59cb\u7684 <code>esp_ble_gatts_app_register</code> \u51fd\u6570\u89e6\u53d1</p> <pre><code>/* ESP_GATTS_CREAT_ATTR_TAB_EVT \u4e8b\u4ef6\u5206\u652f*/\nif (create_tab1 == false)\n{\n    if (param-&gt;add_attr_tab.status != ESP_GATT_OK)\n    {\n        ESP_LOGE(GATTS_TABLE_TAG, \"create attribute table failed, error code=0x%x\", param-&gt;add_attr_tab.status);\n    }\n    else if (param-&gt;add_attr_tab.num_handle != LOCK_IDX_NB)\n    {\n        ESP_LOGE(GATTS_TABLE_TAG, \"create attribute table abnormally, num_handle (%d) \\\n                doesn't equal to LOCK_IDX_NB(%d)\",\n                    param-&gt;add_attr_tab.num_handle, LOCK_IDX_NB);\n    }\n    else\n    {\n        ESP_LOGI(GATTS_TABLE_TAG, \"create attribute table successfully, the number handle = %d\", param-&gt;add_attr_tab.num_handle);\n        memcpy(lock_handle_table, param-&gt;add_attr_tab.handles, sizeof(lock_handle_table));\n        esp_ble_gatts_start_service(lock_handle_table[IDX_SVC]);\n    }\n}\nelse\n{\n    if (param-&gt;add_attr_tab.status != ESP_GATT_OK)\n    {\n        ESP_LOGE(GATTS_TABLE_TAG, \"create attribute table failed, error code=0x%x\", param-&gt;add_attr_tab.status);\n    }\n    else if (param-&gt;add_attr_tab.num_handle != DM_IDX_NB)\n    {\n        ESP_LOGE(GATTS_TABLE_TAG, \"create attribute table abnormally, num_handle (%d) \\\n                    doesn't equal to HRS_IDX_NB(%d)\",\n                    param-&gt;add_attr_tab.num_handle, DM_IDX_NB);\n    }\n    else\n    {\n        ESP_LOGI(GATTS_TABLE_TAG, \"create attribute table successfully, the number handle = %d\\n\", param-&gt;add_attr_tab.num_handle);\n        memcpy(device_manage_handle_table, param-&gt;add_attr_tab.handles, sizeof(device_manage_handle_table));\n        esp_ble_gatts_start_service(device_manage_handle_table[IDX_SVC2]);\n    }\n}\nbreak;\n</code></pre> <p>\u76f8\u8f83\u4e8e\u539f\u59cb\u4f8b\u7a0b\uff0c\u6b64\u5904\u6dfb\u52a0\u4e86\u4e00\u4e2a <code>create_tab1</code> \u7684\u6807\u5fd7\u4f4d\uff0c\u7528\u4e8e\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u521b\u5efa\u4e86\u7b2c\u4e00\u4e2a database\uff0c\u5982\u679c\u6ca1\u6709\u5219\u521b\u5efa\u7b2c\u4e00\u4e2a\uff0c\u5982\u679c\u5df2\u7ecf\u521b\u5efa\u4e86\uff0c\u5219\u521b\u5efa\u7b2c\u4e8c\u4e2a\uff0c\u4ee5\u540e\u6709\u591a\u4e2a\u670d\u52a1\u5219\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u5728\u68c0\u67e5\u5b8c\u521b\u5efa\u7684\u5c5e\u6027\u8868\u5927\u5c0f\u662f\u5426\u7b49\u4e8e <code>&lt;srvc&gt;_IDX_NB</code> \u4e4b\u540e\uff0c\u5c06\u4f1a\u5c06\u5c5e\u6027\u8868\u7684\u53e5\u67c4\u590d\u5236\u5230 <code>&lt;srvc&gt;_handle_table</code> \u4e2d\uff0c\u5e76\u8c03\u7528 <code>esp_ble_gatts_start_service</code> \u51fd\u6570\u5f00\u59cb\u670d\u52a1\uff0c\u89e6\u53d1 <code>ESP_GATTS_START_EVT</code> \u4e8b\u4ef6\uff1a</p> <pre><code>/* ESP_GATTS_START_EVT \u4e8b\u4ef6\u5206\u652f*/\nif (create_tab1 == false)\n{\n    ESP_LOGI(GATTS_TABLE_TAG, \"SERVICE_START_EVT1, status %d, service_handle %d\", param-&gt;start.status, param-&gt;start.service_handle);\n    esp_err_t creat_attr_ret1 = esp_ble_gatts_create_attr_tab(gatt_db2, gatts_if, DM_IDX_NB, SVC_INST_ID1);\n    if (creat_attr_ret1)\n    {\n        ESP_LOGE(GATTS_TABLE_TAG, \"create attr table2 failed, error code = %x\", creat_attr_ret1);\n    }\n    create_tab1 = true;\n}\nelse\n{\n    ESP_LOGI(GATTS_TABLE_TAG, \"SERVICE_START_EVT2, status %d, service_handle %d\", param-&gt;start.status, param-&gt;start.service_handle);\n}\nbreak;\n</code></pre> <p>\u5728\u8be5\u4e8b\u4ef6\u4e2d\u56e0\u4e3a\u5f00\u59cb\u670d\u52a1\u6210\u529f\u540e\u4e8b\u4ef6\u624d\u4f1a\u88ab\u89e6\u53d1\uff0c\u56e0\u6b64\u521b\u5efa\u597d\u7b2c\u4e00\u4e2a database \u540e\u5219\u53ef\u4ee5\u5f00\u59cb\u521b\u5efa\u7b2c\u4e8c\u4e2a database\uff0c\u5219\u8c03\u7528 <code>esp_ble_gatts_create_attr_tab</code> \u51fd\u6570\u7ee7\u7eed\u521b\u5efa\u7b2c\u4e8c\u4e2a database\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#3-walkthrough","title":"3 \u95e8\u7981\u63a7\u5236\u5668\u4e2d\u7684\u84dd\u7259\u4efb\u52a1 Walkthrough","text":"<p>\u9996\u5148\u8c03\u7528 <code>ble_server_task_init</code> \u51fd\u6570\u7528\u4e8e\u521d\u59cb\u5316\u84dd\u7259\u63a7\u5236\u5668\uff0c\u84dd\u7259\u534f\u8bae\u6808\uff0c\u6ce8\u518c GATT \u56de\u8c03\u51fd\u6570\u4ee5\u53ca GAP \u56de\u8c03\u51fd\u6570\uff0c\u8bbe\u7f6e MTU\uff0c\u5e76\u6ce8\u518c profile <code>esp_ble_gatts_app_register</code>\uff0c\u6ce8\u518c profile \u5c06\u4f1a\u89e6\u53d1\u4e8b\u4ef6 <code>ESP_GATTS_REG_EVT</code></p> <p>\u56de\u8c03\u51fd\u6570\uff1a\u5176\u4e2d GATT \u56de\u8c03\u51fd\u6570\u4ee5\u53ca GAP \u56de\u8c03\u51fd\u6570\u7528\u4e8e\u5904\u7406\u84dd\u7259\u6808\u6240\u6709\u53ef\u80fd\u53d1\u751f\u7684\u60c5\u51b5\uff0c\u6765\u8fbe\u5230 FSM \u7684\u6548\u679c</p> <p>MTU\uff08\u6700\u5927\u4f20\u8f93\u5355\u5143\uff09\uff1a\u901a\u8fc7\u8bbe\u7f6e MTU \u7684\u503c\u9650\u5236 PDU\uff08\u534f\u8bae\u6570\u636e\u5355\u5143\uff09\u6700\u5927\u80fd\u591f\u4ea4\u6362\u7684\u6570\u636e\u91cf</p> <p><code>gap_event_handler</code> \u7528\u4e8e\u5904\u7406 GAP \u4e2d\u7684\u4e8b\u4ef6\uff0c\u672c\u6b21\u4e0d\u592a\u9700\u8981\u5173\u5fc3</p> <p><code>gatts_event_handler</code> \u63a5\u6536\u6765\u81ea\u534f\u8bae\u6808\u4e2d\u7684 GATTS \u4e8b\u4ef6\uff0c\u5206\u53d1\u7ed9\u4e0d\u540c\u7684 Profile\uff0c\u7531\u4e8e\u672c\u6b21\u7cfb\u7edf\u8bbe\u8ba1\u53ea\u4f7f\u7528\u4e86\u4e00\u4e2a Profile \uff0c\u56e0\u6b64\u76f8\u5f53\u4e8e\u5c06\u4e8b\u4ef6\u76f4\u63a5\u4f20\u9012\u7ed9\u8fd9\u552f\u4e00\u7684 Profile</p> <p><code>gatts_profile_event_handler</code> \u662f\u5b9e\u9645\u5904\u7406\u5404\u4e2a GATT \u64cd\u4f5c\u7684\u72b6\u6001\u673a\uff0c\u6240\u6709\u6709\u5173\u4e8e\u5bf9 Service \u548c Characteristic \u7684\u64cd\u4f5c\u90fd\u5728\u6b64\u5904\u8fdb\u884c\uff0c\u4e0b\u9762\u9488\u5bf9\u8be5\u72b6\u6001\u673a\u505a\u4e00\u4e2a\u7b80\u8981\u6982\u8ff0\uff1a</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#31-esp_gatts_reg_evt","title":"3.1 <code>ESP_GATTS_REG_EVT</code>","text":"<p>\u5728\u8be5\u4e8b\u4ef6\u4e2d\u8bbe\u7f6e\u8bbe\u5907\u540d\u79f0\u5e76\u914d\u7f6e gap \u5e7f\u64ad\u6570\u636e\u5305\u4e4b\u540e\uff0c\u5f00\u59cb\u521b\u5efa\u7b2c\u4e00\u4e2a\u670d\u52a1\u7684\u5c5e\u6027\u8868\uff0c\u901a\u8fc7\u8c03\u7528\u8be5\u51fd\u6570\u8fdb\u884c\u521b\u5efa\uff1a<code>esp_ble_gatts_create_attr_tab</code> </p> <p>\u8c03\u7528\u8be5\u51fd\u6570\u4e4b\u540e\u5c06\u4f1a\u89e6\u53d1 <code>ESP_GATTS_CREAT_ATTR_TAB_EVT</code> \u4e8b\u4ef6</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#32-esp_gatts_creat_attr_tab_evt","title":"3.2 <code>ESP_GATTS_CREAT_ATTR_TAB_EVT</code>","text":"<p>\u5982\u679c\u5c5e\u6027\u8868\u521b\u5efa\u6210\u529f\u7684\u8bdd\uff0c\u4e8b\u4ef6\u6240\u643a\u5e26\u7684\u53c2\u6570\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5c5e\u6027\u8868\u7684\u53e5\u67c4\uff0c\u4ee5\u4e0b\u662f\u8be5\u4e8b\u4ef6\u4e0b\u7684 param \u7ed3\u6784\u4f53\uff1a <pre><code>struct gatts_add_attr_tab_evt_param{\n    esp_gatt_status_t status;       /*!&lt; Operation status */\n    esp_bt_uuid_t svc_uuid;         /*!&lt; Service uuid type */\n    uint8_t svc_inst_id;            /*!&lt; Service id */\n    uint16_t num_handle;            /*!&lt; The number of the attribute handle to be added to the gatts database */\n    uint16_t *handles;              /*!&lt; The number to the handles */\n} add_attr_tab;                     /*!&lt; Gatt server callback param of ESP_GATTS_CREAT_ATTR_TAB_EVT */\n</code></pre></p> <p>\u5728\u8be5\u4e8b\u4ef6\u5185\u901a\u8fc7\u5148\u524d\u7ef4\u62a4\u7684\u4e00\u4e2a\u5168\u5c40\u5e03\u5c14\u7c7b\u578b\u53d8\u91cf\u5224\u65ad\u6b64\u65f6\u521b\u5efa\u7684\u662f\u7b2c\u51e0\u4e2a\u5c5e\u6027\u8868</p> <p>\u4e4b\u540e\u5c06\u6240\u6709\u8be5\u5c5e\u6027\u8868\u4e2d\u7684\u6240\u6709\u7279\u5f81\u503c\u53e5\u67c4\u8d4b\u503c\u7ed9\u5bf9\u5e94\u7684\u53e5\u67c4\u5217\u8868\uff0c\u65b9\u4fbf\u540e\u7eed\u7edf\u4e00\u7ba1\u7406\u67d0\u4e00\u4e2a\u7279\u5f81\u503c\u7684\u64cd\u4f5c\u51fd\u6570</p> <p>\u6700\u540e\u8c03\u7528 <code>esp_ble_gatts_start_service</code> \u542f\u52a8\u670d\u52a1\uff0c\u542f\u52a8\u5b8c\u6210\u540e\u5c06\u4f1a\u89e6\u53d1 <code>ESP_GATTS_START_EVT</code>  \u4e8b\u4ef6</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#33-esp_gatts_start_evt","title":"3.3 <code>ESP_GATTS_START_EVT</code>","text":"<p>\u8be5\u4e8b\u4ef6\u4e0b\u7684 param \u7ed3\u6784\u4f53\uff1a <pre><code>struct gatts_start_evt_param {\n    esp_gatt_status_t status;       /*!&lt; Operation status */\n    uint16_t service_handle;        /*!&lt; Service attribute handle */\n} start;                            /*!&lt; Gatt server callback param of ESP_GATTS_START_EVT */\n</code></pre></p> <p>\u540c\u6837\uff0c\u6839\u636e\u5168\u5c40\u7ef4\u62a4\u7684\u5168\u5c40\u5e03\u5c14\u7c7b\u578b\u53d8\u91cf\u5224\u65ad\u662f\u5426\u8fdb\u884c\u4e0b\u4e00\u4e2a\u5c5e\u6027\u8868\u7684\u521b\u5efa\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5c5e\u6027\u8868\u5c31\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5b8c\u6210\u4e00\u4e2a\u5c5e\u6027\u8868\u7684\u521b\u5efa\u5c31\u5c06\u5bf9\u5e94\u7684\u53d8\u91cf\u7f6e TRUE</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#34-esp_gatts_write_evt","title":"3.4 <code>ESP_GATTS_WRITE_EVT</code>","text":"<p>\u8be5\u4e8b\u4ef6\u5728\u53d1\u751f GATT \u5199\u64cd\u4f5c\u7684\u65f6\u5019\u88ab\u89e6\u53d1\uff0cparam \u5982\u4e0b\uff1a <pre><code>struct gatts_write_evt_param {\n    uint16_t conn_id;               /*!&lt; Connection id */\n    uint32_t trans_id;              /*!&lt; Transfer id */\n    esp_bd_addr_t bda;              /*!&lt; The bluetooth device address which been written */\n    uint16_t handle;                /*!&lt; The attribute handle */\n    uint16_t offset;                /*!&lt; Offset of the value, if the value is too long */\n    bool need_rsp;                  /*!&lt; The write operation need to do response */\n    bool is_prep;                   /*!&lt; This write operation is prepare write */\n    uint16_t len;                   /*!&lt; The write attribute value length */\n    uint8_t *value;                 /*!&lt; The write attribute value */\n    } write;                            /*!&lt; Gatt server callback param of ESP_GATTS_WRITE_EVT */\n</code></pre></p> <p>\u672c\u6b21 gatts \u4e2d\u5b9e\u73b0\u4e86\u4e00\u4e2a\u51fd\u6570 <code>write_event_handler</code> \uff0c\u63a5\u6536\u4e09\u4e2a\u53c2\u6570\uff0c\u5206\u522b\u662f\uff1a</p> <ul> <li>\u64cd\u4f5c\u7684\u7279\u5f81\u503c\u53e5\u67c4</li> <li>\u6570\u636e\u957f\u5ea6</li> <li>\u5199\u5165\u6570\u636e\u7684\u6307\u9488</li> </ul> <p>\u8be5\u51fd\u6570\u5c06\u4f1a\u904d\u5386\u9884\u5148\u8bbe\u5b9a\u597d\u7684\u67e5\u627e\u8868\uff0c\u5339\u914d\u64cd\u4f5c\u7279\u5f81\u503c\u7684\u5bf9\u5e94\u4e1a\u52a1\u51fd\u6570</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240619-%E8%93%9D%E7%89%99%E5%BC%80%E5%8F%91/#35","title":"3.5 \u4e1a\u52a1\u51fd\u6570\u4e00\u822c\u63a5\u53e3","text":"<p>\u7531\u4e8e\u63d0\u524d\u89c4\u8303\u4e86\u53cc\u65b9\u7684\u52a0\u5bc6\u534f\u8bae\uff0c\u4e00\u822c\u5ba2\u6237\u7aef\u5199\u5165\u7684\u7279\u5f81\u503c\u90fd\u662f\u7edf\u4e00\u7684\u52a0\u5bc6\u5e27\u6570\u636e\u5305\uff0c\u5148\u8981\u5bf9\u6570\u636e\u5305\u8fdb\u884c\u89e3\u5bc6\uff0c\u901a\u8fc7\u5148\u524d\u63d0\u53ca\u7684 <code>data_frame_unpacking</code> \u548c <code>data_frame_packing</code> \u51fd\u6570\u53ef\u4ee5\u8fdb\u884c\u5904\u7406</p> <p>\u51fd\u6570\u4e00\u822c\u63a5\u53d7\u6765\u81ea\u524d\u7ea7\u4f20\u9012\u6765\u7684\u7279\u5f81\u503c\u53e5\u67c4\u3001\u6570\u636e\u957f\u5ea6\u3001\u6570\u636e\u7684\u6307\u9488</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240625-%E5%8D%A1%E5%85%B3%E7%B3%BB%E5%AD%98%E5%82%A8%E8%AE%BE%E8%AE%A1/","title":"240625-\u5361\u5173\u7cfb\u5b58\u50a8\u8bbe\u8ba1","text":"<p>\u95e8\u7981\u7cfb\u7edf\u4e2d\u7684\u5361\u53f7\u4ee5\u53ca\u4eba\u5458\u672c\u5730\u5b58\u50a8\u8bbe\u8ba1\u5982\u4e0b\uff1a</p> <p></p> <p>\u6700\u4e0a\u5c42\u5b9a\u4e49\u4e00\u4e2a <code>user_card_relation_t</code> \uff0c\u5305\u542b <code>user_t</code> \u548c <code>card_t</code> </p> <p>\u5176\u4e2d\uff0c<code>user_t</code> \u652f\u6301\u5b9a\u4e49\u5b66\u53f7\u4ee5\u53ca\u7b49\u7ea7\uff1b<code>card_t</code> \u652f\u6301\u5b9a\u4e49\u5361\u53f7\u4ee5\u53ca\u6709\u6548\u671f\u3002</p> <p>\u8be5\u5361\u5173\u7cfb\u91c7\u7528\u52a8\u6001\u5185\u5b58\u7ba1\u7406\u8bbe\u8ba1\uff0c\u4f7f\u7528\u4e0a\u4e0b\u6587\u4ee5\u4fdd\u8bc1\u64cd\u4f5c\u5361\u5173\u7cfb\u65f6\u7684\u5185\u5b58\u7533\u8bf7\u4e0e\u91ca\u653e\uff0c\u5728\u4f7f\u7528\u524d\u9700\u8981\u521d\u59cb\u5316 nvs \u6a21\u5757\uff0c\u5e76\u5728\u5bf9\u5361\u5173\u7cfb\u64cd\u4f5c\u5b8c\u6bd5\u540e\u8c03\u7528\u91ca\u653e\u4e0a\u4e0b\u6587\u51fd\u6570 <code>free_relations_context</code>\uff0c\u4ee5\u4e0b\u4e3a\u4e00\u4e2a\u8c03\u7528\u793a\u4f8b\uff1a <pre><code>static void relations_test_task(void *pvParameters)\n{\n    /* RUN ONCE */\n\n    /* \u968f\u673a\u521b\u5efa100\u6761relations\u5b58\u50a8\u5230nvs\u4e2d */\n    relations_contex_t ctx;\n    init_relations_context(&amp;ctx);\n\n    for (size_t i = 0; i &lt; 100; i++)\n    {\n        user_card_relation_t relation;\n        relation.user.user_id = 202134310000 + i;\n        relation.user.level = LEVEL_1;\n        relation.card.card_number = 0x0000000000000000 + i;\n        relation.card.expiry = time(NULL) + 3600 * 24 * 365 * 2;\n        add_relation_contex(&amp;ctx, relation);\n    }\n\n    /* \u4fdd\u5b58\u5230nvs */\n    save_relations_nvs(ctx.relations, ctx.relations_count);\n    free_relations_context(&amp;ctx);\n\n    /* \u8bfb\u53d6nvs */\n    relations_contex_t ctx2;\n    init_relations_context(&amp;ctx2);\n\n    get_relations_nvs(&amp;ctx2.relations, &amp;ctx2.relations_count);\n\n    for (size_t i = 0; i &lt; ctx2.relations_count; i++)\n    {\n        ESP_LOGI(TAG, \"-----------------[RELATIONS GET TEST 1]-----------------\");\n        ESP_LOGI(TAG, \"user_id: %lld, level: %d\", ctx2.relations[i].user.user_id, ctx2.relations[i].user.level);\n        ESP_LOGI(TAG, \"card_number: %lld, expiry: %lld\", ctx2.relations[i].card.card_number, ctx2.relations[i].card.expiry);\n        ESP_LOGI(TAG, \"--------------------------------------------------------\");\n    }\n\n    free_relations_context(&amp;ctx2);\n\n    vTaskDelete(NULL);\n}\n</code></pre></p> <p>\u53e6\u5916\uff0c\u5173\u4e8e\u5199\u5165\u5361\u5173\u7cfb\u5230 nvs \u4e2d\u6709\u5982\u4e0b\u9650\u5236\uff1a</p> <pre><code>/**\n * @brief \u6dfb\u52a0\u7528\u6237\u5361\u5173\u7cfb\n *\n * @param[in] add_relations \u8f93\u5165-\u8981\u6dfb\u52a0\u7684\u7528\u6237\u5361\u5173\u7cfb\uff0c\u6307\u5411\u4e00\u4e2a\u7ed3\u6784\u4f53\u6570\u7ec4\n * @param[in] add_relations_count \u8f93\u5165-\u8981\u6dfb\u52a0\u7684\u7528\u6237\u5361\u5173\u7cfb\u6570\u91cf\n *\n * @return 0: \u6210\u529f\n * @return 1: \u4e0d\u5141\u8bb8\u591a\u4eba\u4e00\u5361\n * @return 2: \u5206\u914d\u5185\u5b58\u5931\u8d25\n * @return 3: \u4fdd\u5b58\u7528\u6237\u5361\u5173\u7cfb\u5931\u8d25\n *\n * @attention \u8be5\u51fd\u6570\u53ea\u9700\u8981\u8f93\u5165\u9700\u8981\u6dfb\u52a0\u7684\u5173\u7cfb\uff0c\u51fd\u6570\u5185\u90e8\u4f1a\u8c03\u7528get_user_card_relations\u83b7\u53d6\u5f53\u524d\u7684\u5173\u7cfb\uff0c\u7136\u540e\u8fdb\u884c\u6bd4\u5bf9\n * @attention \u82e5\u6709\u76f8\u540c\u5361\u53f7\uff0c\u5219\u66f4\u65b0\u6709\u6548\u671f\uff1b\u82e5\u6709\u76f8\u540c\u7528\u6237\u4f46\u4e0d\u540c\u5361\u53f7\uff0c\u5219\u66f4\u65b0\u5361\u53f7\uff1b\u82e5\u6ca1\u6709\u76f8\u540c\u5361\u53f7\uff0c\u5219\u6dfb\u52a0\u65b0\u5173\u7cfb\uff0c\u6700\u540e\u4fdd\u5b58\u66f4\u65b0\u5230NVS\u4e2d\n */\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240626-BM8563%20%E9%A9%B1%E5%8A%A8%E7%A7%BB%E6%A4%8D%EF%BC%8CIDF-I2C%20%E7%AC%94%E8%AE%B0/","title":"240626-BM8563 \u9a71\u52a8\u79fb\u690d\uff0cIDF-I2C \u7b14\u8bb0","text":"<p>\u5b98\u65b9 I2C \u6587\u6863\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/peripherals/i2c.html</p> <p>\u5728 IDFv5.2 \u4e4b\u540e I2C \u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u4e3b\u8981\u6539\u52a8\u4e3a\u4ece\u673a\u4e0e\u4e3b\u673a\u8fdb\u884c\u4e86\u533a\u5206\uff1b\u5e76\u5728\u8001\u677f\u9a71\u52a8\u4e2d\uff0c\u9700\u8981\u4e00\u4e2a\u4e00\u4e2a\u6307\u4ee4\u901a\u8fc7\u8c03\u7528\u51fd\u6570\u7684\u65b9\u6cd5\u8fde\u63a5\u6210\u94fe\u8868\uff0c\u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u76f8\u5173\u7684\u51fd\u6570\u5373\u53ef</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240626-BM8563%20%E9%A9%B1%E5%8A%A8%E7%A7%BB%E6%A4%8D%EF%BC%8CIDF-I2C%20%E7%AC%94%E8%AE%B0/#1-bm8563","title":"1 BM8563 \u79fb\u690d\u63a5\u53e3","text":"<p>\u4ee5\u4e0b\u4e3a\u63a5\u53e3\u8c03\u7528\u793a\u4f8b\uff1a <pre><code>static void bm8563_test_task(void *pvParameters)\n{\n    ESP_LOGI(TAG, \"-----------[BM8563 test start...]-----------\");\n\n    rtc_date_t test_date;\n    test_date.year = 2024;\n    test_date.month = 6;\n    test_date.day = 26;\n    test_date.hour = 12;\n    test_date.minute = 0;\n    test_date.second = 0;\n    bm8563_setTime(&amp;test_date);\n\n    rtc_date_t test_date2;\n    bm8563_getTime(&amp;test_date2);\n\n    ESP_LOGI(TAG, \"Get time: %d-%d-%d %d:%d:%d\", test_date2.year, test_date2.month, test_date2.day, test_date2.hour, test_date2.minute, test_date2.second);\n\n    // bm8563_setDateIRQ(1, 1, 1, 1);\n\n    // int16_t ret_BM1 = bm8563_setTimerIRQ(2500);\n    // ESP_LOGI(TAG, \"Set timer IRQ: %d\", ret_BM1);\n\n    // int16_t ret_BM2 = bm8563_getTimerTime();\n    // ESP_LOGI(TAG, \"Get timer time: %d\", ret_BM2);\n\n    // uint8_t ret_BM3 = bm8563_getIRQ();\n    // ESP_LOGI(TAG, \"Get IRQ: %d\", ret_BM3);\n\n    // bm8563_clearIRQ();\n\n    ESP_LOGI(TAG, \"-----------[BM8563 test DONE.]-----------\");\n    vTaskDelete(NULL);\n}\n</code></pre></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/","title":"240719-LEDPWM\u53ca\u5e38\u7528\u6307\u793a\u51fd\u6570\u5c01\u88c5","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/#1-ledpwm","title":"1 LEDPWM \u7b14\u8bb0","text":"<p>\u53c2\u8003\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/peripherals/ledc.html</p> <p>\u2014\u2014\u5982\u4f55\u914d\u7f6e LEDC\uff08\u8f93\u51fa PWM\uff09</p> <p>\u5206\u4e09\u6b65\u5b8c\u6210\uff1a</p> <ul> <li>\u5b9a\u65f6\u5668\u914d\u7f6e</li> <li>\u901a\u9053\u914d\u7f6e</li> <li>\u6539\u53d8 PWM \u4fe1\u53f7</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/#11","title":"1.1 \u5b9a\u65f6\u5668\u914d\u7f6e","text":"<p>\u82e5 PWM \u9891\u7387\u8d8a\u9ad8\u5219\u5360\u7a7a\u6bd4\u5206\u8fa8\u7387\u5219\u4f1a\u8d8a\u4f4e\uff1a</p> <p></p> <p>\u9664\u6b64\u4e4b\u5916\u65f6\u949f\u6e90\u4e5f\u53ef\u4ee5\u9650\u5236 PWM \u7684\u9891\u7387\uff0c\u65f6\u949f\u6e90\u9891\u7387\u8d8a\u9ad8\uff0c\u53ef\u914d\u7f6e\u7684 PWM \u9891\u7387\u4e0a\u9650\u5c31\u8d8a\u9ad8\u3002\u5e38\u7528\u7684 PWM \u7cbe\u5ea6\u53ef\u89c1\u6280\u672f\u53c2\u8003\u624b\u518c\uff1a</p> <p></p> <p>\u53e6\u5916 LEDC \u9a71\u52a8\u6709\u63d0\u4f9b\u4e00\u6761\u8f85\u52a9\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u4e8e\u627e\u5230\u6700\u5927\u7684\u53ef\u5206\u914d\u5360\u7a7a\u6bd4\u5206\u8fa8\u7387\u503c\uff1a</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/#12","title":"1.2 \u901a\u9053\u914d\u7f6e","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/#13-pwm","title":"1.3 \u6539\u53d8 PWM \u4fe1\u53f7","text":"<p>\u5bf9\u4e8e ESP32-S3 \u6765\u8bf4\uff0cLEDPWM \u63a7\u5236\u5668\u4e2d\u6240\u6709\u7684\u5b9a\u65f6\u5668\u548c\u901a\u9053\u90fd\u53ea\u652f\u6301\u4f4e\u901f\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u5728\u901a\u9053\u8fd0\u884c\u4e4b\u540e\u82e5\u60f3\u8981\u6539\u53d8 PWM \u5360\u7a7a\u6bd4\uff0c\u53ea\u80fd\u4f7f\u7528\u8f6f\u4ef6\u663e\u5f0f\u5730\u89e6\u53d1\uff1a</p> <pre><code>esp_err_t ledc_set_duty(ledc_mode_t speed_mode, ledc_channel_t channel, uint32_t duty)\n</code></pre> <p>\u5728\u8c03\u7528\u4e0a\u8ff0\u51fd\u6570\u8bbe\u7f6e\u65b0\u7684\u5360\u7a7a\u6bd4\u4e4b\u540e\u9700\u8981\u8c03\u7528\u51fd\u6570 <code>ledc_update_duty()</code> \u4ee5\u4f7f\u65b0\u914d\u7f6e\u751f\u6548\uff0c\u82e5\u8981\u67e5\u770b\u5f53\u524d\u8bbe\u7f6e\u7684\u5360\u7a7a\u6bd4\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u51fd\u6570\u8fdb\u884c\u67e5\u770b\uff1a</p> <pre><code>uint32_t ledc_get_duty(ledc_mode_t speed_mode, ledc_channel_t channel)\n</code></pre> <p>\u9664\u6b64\u4e4b\u5916\u53ef\u4ee5\u518d\u8c03\u7528\u4e00\u904d <code>ledc_channel_config()</code> \u6765\u8bbe\u7f6e\u5360\u7a7a\u6bd4\u548c\u5176\u4ed6\u901a\u9053\u53c2\u6570</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/#14","title":"1.4 \u5b9e\u4f8b\u53c2\u8003","text":"<pre><code>#define LEDC_TIMER              LEDC_TIMER_0\n#define LEDC_MODE               LEDC_LOW_SPEED_MODE\n#define LEDC_OUTPUT_IO          (5) // Define the output GPIO\n#define LEDC_CHANNEL            LEDC_CHANNEL_0\n#define LEDC_DUTY_RES           LEDC_TIMER_13_BIT // Set duty resolution to 13 bits\n#define LEDC_DUTY               (4096) // Set duty to 50%. (2 ** 13) * 50% = 4096\n#define LEDC_FREQUENCY          (4000) // Frequency in Hertz. Set frequency at 4 kHz\n</code></pre> <pre><code>static void example_ledc_init(void)\n{\n    // \u521d\u59cb\u5316\u4e00\u4e2aledc\u5b9a\u65f6\u5668\n    ledc_timer_config_t ledc_timer = {\n        .speed_mode       = LEDC_MODE,\n        .duty_resolution  = LEDC_DUTY_RES,\n        .timer_num        = LEDC_TIMER,\n        .freq_hz          = LEDC_FREQUENCY,  // \u5c06\u8f93\u51fa\u9891\u7387\u8bbe\u7f6e\u4e3a4kHz\n        .clk_cfg          = LEDC_AUTO_CLK\n    };\n    ESP_ERROR_CHECK(ledc_timer_config(&amp;ledc_timer));\n\n    // Prepare and then apply the LEDC PWM channel configuration\n    ledc_channel_config_t ledc_channel = {\n        .speed_mode     = LEDC_MODE,\n        .channel        = LEDC_CHANNEL,\n        .timer_sel      = LEDC_TIMER,\n        .intr_type      = LEDC_INTR_DISABLE,\n        .gpio_num       = LEDC_OUTPUT_IO,\n        .duty           = 0, // Set duty to 0%\n        .hpoint         = 0\n    };\n    ESP_ERROR_CHECK(ledc_channel_config(&amp;ledc_channel));\n}\n</code></pre> <pre><code>void app_main(void)\n{\n    // Set the LEDC peripheral configuration\n    example_ledc_init();\n    // Set duty to 50%\n    ESP_ERROR_CHECK(ledc_set_duty(LEDC_MODE, LEDC_CHANNEL, LEDC_DUTY));\n    // Update duty to apply the new value\n    ESP_ERROR_CHECK(ledc_update_duty(LEDC_MODE, LEDC_CHANNEL));\n}\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240719-LEDPWM%E5%8F%8A%E5%B8%B8%E7%94%A8%E6%8C%87%E7%A4%BA%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85/#2","title":"2 \u6307\u793a\u51fd\u6570\u8c03\u7528\u793a\u4f8b","text":"<pre><code>static void indicate_test_task(void *pvParameters)\n{\n    ESP_LOGI(TAG, \"-----------[INDICATE test start...]-----------\");\n\n    indicate_GLED_setting(LEDC_DUTY_100P);\n    indicate_YLED_setting(LEDC_DUTY_100P);\n    vTaskDelay(1000 / portTICK_PERIOD_MS);\n    indicate_YLED_setting(0);\n    indicate_GLED_setting(0);\n    vTaskDelay(1000 / portTICK_PERIOD_MS);\n    indicate_GLED_setting(LEDC_DUTY_50P);\n    indicate_YLED_setting(LEDC_DUTY_50P);\n\n    vTaskDelay(1000 / portTICK_PERIOD_MS);\n\n    note_t buz_notes[] = {NOTE_C, NOTE_F, NOTE_SILENCE, NOTE_SILENCE, NOTE_C, NOTE_SILENCE, NOTE_F, NOTE_SILENCE, NOTE_F};\n    indicate_BUZ_setting(buz_notes, 9, LEDC_DUTY_15P, 200);\n\n    ESP_LOGI(TAG, \"-----------[INDICATE test DONE.]-----------\");\n\n    vTaskDelete(NULL);\n}\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/","title":"240818-\u84dd\u7259\u914d\u7f51\u4ee5\u53ca softAP \u65b9\u5f0f\u914d\u7f51\u63a2\u7d22","text":"<p>ESP32 \u7aef\u53c2\u8003\uff1a</p> <p>\u5b98\u65b9\u7edf\u4e00\u914d\u7f51\u6587\u6863\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/provisioning/provisioning.html#id1</p> <p>blufi \u5b98\u65b9 API \u6307\u5357\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-guides/ble/blufi.html?highlight=blufi</p> <p>BluFi \u84dd\u7259\u914d\u7f51\u63a5\u53e3\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/qq_36347513/article/details/118968576</p> <p>BluFi \u84dd\u7259\u53c2\u8003\u4f8b\u7a0b\uff1a https://github.com/espressif/esp-idf/tree/d7ca8b94c852052e3bc33292287ef4dd62c9eeb1/examples/bluetooth/blufi</p> <p>\u5c0f\u7a0b\u5e8f\u7aef\u53c2\u8003</p> <p>BluFi \u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u914d\u7f51\u53c2\u8003\u5de5\u7a0b 1\uff1a https://github.com/xuhongv/BlufiEsp32WeChat</p> <p>\u5c0f\u7a0b\u5e8f\u53c2\u8003\u5de5\u7a0b 1 \u7684\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/Boantong_/article/details/115666854</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#1","title":"1 \u7edf\u4e00\u914d\u7f51","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#2-blufi","title":"2 BluFi \u914d\u7f51","text":"<p>\u914d\u7f51\u6d41\u7a0b\u5982\u5b98\u65b9\u6587\u6863\u4e0a\u56fe\u6240\u793a</p> <ul> <li>ESP32 \u7aef\u6253\u5f00 GATTS \u6a21\u5f0f\uff0c\u53d1\u9001\u5e7f\u64ad\u6570\u636e\u5305\uff0c\u624b\u673a\u4f5c\u4e3a GATTC \u63a5\u5165</li> <li>\u624b\u673a\u7aef\u53d1\u9001\u6570\u636e\u5e27\u5f00\u59cb\u8fdb\u884c\u5bc6\u94a5\u534f\u5546\uff0cESP32 \u7aef\u6536\u5230\u4e4b\u540e\u5f00\u59cb\u89e3\u6790</li> <li>\u534f\u5546\u7ed3\u675f\u540e\uff0c\u624b\u673a\u5411 ESP32 \u53d1\u9001\u63a7\u5236\u5e27\uff0c\u8bbe\u7f6e\u5b89\u5168\u6a21\u5f0f\uff1b</li> <li>\u8bbe\u7f6e\u5b8c\u6210\u540e\u5f00\u59cb\u53d1\u9001\u8054\u7f51\u6240\u9700\u7684\u6570\u636e\u5e27</li> <li>\u53d1\u9001\u5b8c\u6210\u540e\u624b\u673a\u53d1\u9001\u63a7\u5236\u5e27\uff0c\u6b64\u65f6 ESP32 \u7aef\u9ed8\u8ba4\u624b\u673a\u5df2\u5b8c\u6210\u5fc5\u8981\u4fe1\u606f\u7684\u4f20\u8f93\uff0c\u5f00\u59cb\u8fde\u63a5 WIFI</li> <li>\u8fde\u63a5 WIFI \u540e ESP32\u53d1\u9001 WIFI \u8fde\u63a5\u72b6\u6001\u62a5\u544a\u81f3\u624b\u673a\uff0c\u81f3\u6b64\u914d\u7f51\u7ed3\u675f</li> </ul>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#21","title":"2.1 \u57fa\u4e8e\u5b98\u65b9\u4f8b\u7a0b\u5c1d\u8bd5\u79fb\u690d","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#211","title":"2.1.1 \u5b98\u65b9\u4f8b\u7a0b\u7ed3\u6784","text":"<p>\u4e3b\u51fd\u6570\u4e2d\u9996\u5148\u521d\u59cb\u5316\u4e86\u56db\u4e2a\u5fc5\u8981\u7684\u7ec4\u4ef6\uff1a</p> <ul> <li>nvs \u5b58\u50a8</li> <li>wifi \u521d\u59cb\u5316</li> <li>\u5c01\u88c5\u51fd\u6570 blufi \u63a7\u5236\u5668\u521d\u59cb\u5316</li> <li>blufi_host_and_cb \u521d\u59cb\u5316</li> </ul> <p>NVS \u5b58\u50a8\u521d\u59cb\u5316\u7565\uff0c\u6ca1\u6709\u4e0a\u6e38\u4f9d\u8d56</p> <p>WIFI \u521d\u59cb\u5316\uff1a </p> <ul> <li>netif \u521d\u59cb\u5316\uff1a\u7f51\u7edc\u63a5\u53e3\u7684\u521d\u59cb\u5316\uff0c\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef</li> <li>\u521b\u5efa ble \u914d\u7f51\u4f7f\u7528\u7684 wifi \u4e8b\u4ef6\u7ec4\uff0c\u8be5\u4e8b\u4ef6\u7ec4\u4e2d\u53ea\u5b9a\u4e86\u4e00\u4e2a <code>CONNECTED_BIT</code> \u7528\u6765\u6307\u793a\u83b7\u53d6\u5230 IP \u6807\u5fd7\u8054\u7f51\u6210\u529f</li> <li>\u521b\u5efa\u9ed8\u8ba4\u7cfb\u7edf\u4e8b\u4ef6\u5faa\u73af</li> <li>\u5728 netif \u5c42\u4e0a\u521b\u5efa\u9ed8\u8ba4\u7684 sta \u6a21\u5f0f\u4ee5\u53ca ap \u6a21\u5f0f\u53e5\u67c4</li> <li>\u6ce8\u518c WIFI \u4e8b\u4ef6\u7684\u56de\u8c03\u51fd\u6570</li> <li>\u6ce8\u518c IP \u4e8b\u4ef6\u7684\u56de\u8c03\u51fd\u6570</li> <li>\u6309\u9ed8\u8ba4\u914d\u7f6e\u521d\u59cb\u5316 WIFI\uff0c\u6309 STA \u6a21\u5f0f\u4f7f\u80fd WIFI\uff0c\u5e76\u8bbe\u7f6e\u8bb0\u5f55 WIFI \u8fde\u63a5\u7684\u76f8\u5173\u4fe1\u606f\uff08\u7528\u4e8e\u7ec4\u6210\u53d1\u56de\u7ed9\u624b\u673a\u7684\u6570\u636e\u5305\uff09</li> </ul> <p>blufi \u63a7\u5236\u5668\u521d\u59cb\u5316\uff1a \u6309\u7167\u9ed8\u8ba4\u914d\u7f6e <code>BT_CONTROLLER_INIT_CONFIG_DEFAULT</code> \u521d\u59cb\u5316\u84dd\u7259\u63a7\u5236\u5668\u5e76\u4f7f\u80fd</p> <p>blufi_host_and_cb \u521d\u59cb\u5316\uff1a </p> <ul> <li><code>esp_blufi_host_init</code>\uff1a<code>blufi_init.c</code> \uff0c\u521d\u59cb\u5316 bluedroid \u84dd\u7259\u534f\u8bae\u6808\u5e76\u4f7f\u80fd</li> <li><code>esp_blufi_register_callbacks</code>\uff1ablufi \u7ec4\u4ef6\u6240\u5c5e\u51fd\u6570\uff0c\u6ce8\u518c blufi \u76f8\u5173\u4e8b\u4ef6\u7684\u56de\u8c03\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u63a5\u53d7\u672c\u6b21\u4f8b\u7a0b\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u51e0\u4e2a\u5fc5\u8981\u56de\u8c03\u51fd\u6570\uff0c\u5e76\u4f20\u9012\u7ed9 blufi \u7ec4\u4ef6\u4ee5\u4f9b blufi \u914d\u7f51\u8fc7\u7a0b\u4f7f\u7528\u2014\u2014\u5982 blufi \u4e8b\u4ef6\u56de\u8c03\u51fd\u6570\u3001\u6570\u636e\u534f\u5546\u5904\u7406\u51fd\u6570\uff08DH \u65b9\u5f0f\uff09\u3001\u52a0\u89e3\u5bc6\u5904\u7406\u51fd\u6570\uff08AES \u52a0\u5bc6\u65b9\u5f0f\uff09\u3001\u6821\u9a8c\u5904\u7406\u51fd\u6570\uff08CRC \u65b9\u5f0f\uff09</li> <li><code>esp_blufi_gap_register_callback</code>\uff1a<code>blufi_init.c</code> \uff0c\u8c03\u7528\u4e86\u4e00\u4e0b blufi \u7ec4\u4ef6\u4e2d\u7684\u76f8\u5173\u51fd\u6570\uff0c\u6ce8\u518c\u56de\u8c03\u51fd\u6570\u6765\u5e7f\u64ad blufi \u9ed8\u8ba4\u7684\u6570\u636e\u5305\uff0c\u521d\u59cb\u5316 blufi \u7684 profile</li> </ul> <p>\u7ed3\u5408\u4e0a\u8ff0\u4e09\u4e2a\u7ec4\u4ef6\u6765\u770b\uff0c\u7531\u4e8e\u539f\u6709\u7cfb\u7edf\u4e2d\u672c\u8eab\u5c31\u9700\u8981\u521d\u59cb\u5316 bluedroid \u534f\u8bae\u6808\u4ee5\u53ca GATTS \u670d\u52a1\uff0c\u56e0\u6b64\u7b2c\u4e8c\u70b9 blufi \u63a7\u5236\u5668\u521d\u59cb\u5316\u4ee5\u53ca\u7b2c\u4e09\u70b9\u4e2d\u7684\u521d\u59cb\u5316 bluedroid \u84dd\u7259\u534f\u8bae\u6808\u53ef\u4ee5\u5728\u521d\u59cb\u5316 blufi \u534f\u8bae\u4e4b\u524d\u5c31\u5b8c\u6210\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#212-kconfig-smartconfig","title":"2.1.2 \u5229\u7528 Kconfig \u5c06\u539f\u914d\u7f51\u5b9e\u73b0\uff08smartconfig\uff09\u914d\u7f6e\u4e3a\u53ef\u9009\u9879","text":"<p>ESP-IDF \u4f7f\u7528\u57fa\u4e8e\u00a0kconfiglib\u00a0\u7684\u00a0esp-idf-kconfig\u00a0\u5305\uff0c\u800c\u00a0kconfiglib\u00a0\u662f\u00a0Kconfig\u00a0\u7cfb\u7edf\u7684 Python \u6269\u5c55\u3002Kconfig \u63d0\u4f9b\u4e86\u7f16\u8bd1\u65f6\u7684\u9879\u76ee\u914d\u7f6e\u673a\u5236\uff0c\u4ee5\u53ca\u591a\u79cd\u7c7b\u578b\u7684\u914d\u7f6e\u9009\u9879\uff08\u5982\u6574\u6570\u3001\u5b57\u7b26\u4e32\u548c\u5e03\u5c14\u503c\u7b49\uff09\u3002Kconfig \u6587\u4ef6\u6307\u5b9a\u4e86\u9009\u9879\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\u3001\u9ed8\u8ba4\u503c\u3001\u7ec4\u5408\u65b9\u5f0f\u7b49\u3002</p> <p><code>Kconfig</code>\u00a0\u662f\u4e00\u79cd\u7528\u4e8e\u914d\u7f6e\u5185\u6838\u548c\u8f6f\u4ef6\u9879\u76ee\u7684\u914d\u7f6e\u8bed\u8a00\uff0c\u5e7f\u6cdb\u5e94\u7528\u4e8e Linux \u5185\u6838\u3001U-Boot \u548c\u5176\u4ed6\u5d4c\u5165\u5f0f\u7cfb\u7edf\u9879\u76ee\u4e2d\u3002\u5b83\u5141\u8bb8\u5f00\u53d1\u8005\u5b9a\u4e49\u914d\u7f6e\u9009\u9879\uff0c\u5e76\u901a\u8fc7\u83dc\u5355\u754c\u9762\uff08\u5982\u00a0<code>menuconfig</code>\uff09\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>\u901a\u8fc7\u7f16\u5199 IDF \u7ec4\u4ef6\u6587\u4ef6\u5939\u4e0b\u7684 <code>Kconfig.projbuild</code> \u6587\u4ef6\uff0c\u5728 IDF Full Clean \u4e4b\u540e\u4fbf\u53ef\u4ee5\u751f\u6210\u7531\u7ec4\u4ef6 Kconfig \u89c4\u5b9a\u7684\u82e5\u5e72\u5b8f\u3002</p> <p>\u6b64\u914d\u7f6e\u5c06\u4fdd\u5b58\u5728\u9879\u76ee\u6839\u76ee\u5f55\u7684\u00a0<code>sdkconfig</code>\u00a0\u6587\u4ef6\u4e2d\u3002\u501f\u52a9\u00a0<code>sdkconfig</code>\uff0c\u5e94\u7528\u7a0b\u5e8f\u6784\u5efa\u76ee\u6807\u5c06\u5728\u6784\u5efa\u76ee\u5f55\u4e2d\u751f\u6210\u00a0<code>sdkconfig.h</code>\u00a0\u6587\u4ef6 \uff0c\u5e76\u4f7f\u5f97\u00a0<code>sdkconfig</code>\u00a0\u9009\u9879\u53ef\u7528\u4e8e\u9879\u76ee\u6784\u5efa\u7cfb\u7edf\u548c\u6e90\u6587\u4ef6\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#213","title":"2.1.3 \u79fb\u690d\u7ed3\u679c","text":"<p>\u5b9e\u73b0 blufi \u914d\u7f51\u65b9\u5f0f\uff1b</p> <p></p> <p></p> <p>\u5e76\u53ef\u901a\u8fc7 Kconfig \u9009\u62e9\u914d\u7f51\u65b9\u5f0f</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240818-%E8%93%9D%E7%89%99%E9%85%8D%E7%BD%91%E4%BB%A5%E5%8F%8AsoftAP%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%91%E6%8E%A2%E7%B4%A2/#214-todo","title":"2.1.4 ToDo","text":"<p>\u56e0\u4e3a\u662f\u9a8c\u8bc1\u6027\u8d28\u7684\u79fb\u690d\u6240\u4ee5\u8fd8\u6709\u5f88\u591a\u53ef\u4ee5\u5220\u51cf\u7684\u90e8\u5206\uff0c\u4e1a\u52a1\u903b\u8f91\u4e5f\u8fd8\u6709\u4e00\u70b9\u4e0d\u5b8c\u5584\uff0c\u56e0\u6b64\u540e\u9762\u8fd8\u9700\u8981\u7ee7\u7eed\u91cd\u6784\uff0c\u5e76\u68c0\u67e5\u6709\u6ca1\u6709\u56e0\u4e3a\u66f4\u6539\u914d\u7f51\u65b9\u5f0f\u5bfc\u81f4\u7684\u5176\u4ed6\u4f9d\u8d56 WIFI \u7684\u5e94\u7528\u7a0b\u5e8f\u9519\u8bef\u8fd0\u884c\u3002</p> <p>\u4ee5\u53ca\u8fd8\u9700\u8981\u4e0e\u5c0f\u7a0b\u5e8f\u7aef\u4e00\u8d77\uff0c\u6d4b\u8bd5\u4e00\u4e0b\u4e0d\u540c\u5e73\u53f0\u624b\u673a\u7684\u914d\u7f51\u6210\u529f\u7387\u4ee5\u53ca\u9a8c\u8bc1\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/","title":"240822-ESP32\u5206\u533a\u8868\u53ca OTA","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#1","title":"1 \u5206\u533a\u8868","text":"<p>\u5206\u533a\u8868\u5b98\u65b9\u6587\u6863\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-guides/partition-tables.html</p> <p>\u5206\u533a\u8868\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u90fd\u5305\u62ec\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1aName\uff08\u6807\u7b7e\uff09\u3001Type\uff08app\u3001data \u7b49\uff09\u3001SubType \u4ee5\u53ca\u5728 flash \u4e2d\u7684\u504f\u79fb\u91cf\uff08\u5206\u533a\u7684\u52a0\u8f7d\u5730\u5740\uff09\u3002</p> <p></p> <p>\u5185\u7f6e\u5206\u533a\u8868\u4e3e\u4f8b</p> <p>\u521b\u5efa\u81ea\u5b9a\u4e49\u5206\u533a\u8868\uff1a</p> <p></p> <ul> <li>Name \u5b57\u6bb5\u4e0d\u80fd\u8d85\u8fc7 16 \u4e2a\u5b57\u8282</li> <li>Type \u5b57\u6bb5\u53ef\u4ee5\u6307\u5b9a\u4e3a <code>app</code> \u6216 <code>data</code> \uff1b\u8fd9\u662f\u5e38\u7528\u7684\u4e24\u4e2a\u679a\u4e3e\u7c7b\u578b\uff0c\u5177\u4f53\u5b8c\u6574\u7684\u5b58\u50a8\u6570\u636e\u683c\u5f0f\u53ef\u4ee5\u53c2\u8003 <code>esp_partition_type_t</code></li> <li>SubType \u5b57\u6bb5\u4ec5\u89c4\u5b9a <code>app</code> \u548c <code>data</code> \u5b57\u6bb5\u7684\u542b\u4e49\uff0c\u67e5\u9605 <code>esp_partition_subtype_t</code>\u4ee5\u4e86\u89e3\u5b8c\u6574\u7684\u5b50\u7c7b\u578b\u5217\u8868<ul> <li>Type: app<ul> <li><code>factory</code>\uff1a</li> <li><code>ota_x</code>\uff1a\u82e5\u4f7f\u7528 OTA \u7684\u65f6\u5019\u81f3\u5c11\u5e94\u5f53\u6709\u4e24\u4e2a OTA \u5e94\u7528\u7a0b\u5e8f\u5206\u533a\uff1b\u6700\u5927\u53ef\u4ee5\u6709 0-15</li> <li><code>test</code>\uff1a\u6d4b\u8bd5\u7528\uff0c\u9884\u7559\u7684\u5b50\u7c7b\u578b\uff1b\u7528\u4e8e\u5de5\u5382\u6d4b\u8bd5\u6d41\u7a0b\uff1b\u5982\u679c\u6ca1\u6709\u5176\u4ed6\u6709\u6548\u7684 app \u5206\u533a\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5907\u9009\u542f\u52a8\u5206\u533a\u8fdb\u884c\u4f7f\u7528\u3002</li> </ul> </li> <li>Type: data<ul> <li><code>ota</code>\uff1a\u6307\u5b9a\u6253\u5f00\u7684 OTA \u5e94\u7528\u7a0b\u5e8f\uff1b\u5927\u5c0f\u9700\u8981\u8bbe\u5b9a\u4e3a <code>0x2000</code> \uff0c\u5bb9\u91cf\u4e3a\u4e24\u4e2a flash \u6247\u533a\u7684\u5927\u5c0f\uff0c\u8fd9\u662f\u4e3a\u4e86\u653e\u7f6e\u5199\u5165\u7684\u65f6\u5019\u7535\u6e90\u6545\u969c\u5f15\u53d1\u95ee\u9898\uff0c\u4e24\u4e2a\u6247\u533a\u5355\u72ec\u64e6\u9664\u3001\u5199\u5165\u5339\u914d\u6570\u636e\uff0c\u82e5\u5b58\u5728\u4e0d\u4e00\u81f4\uff0c\u5219\u7528\u8ba1\u6570\u5668\u5b57\u6bb5\u5224\u5b9a\u54ea\u4e2a\u6247\u533a\u4e3a\u6700\u65b0\u6570\u636e\u3002\uff1b\u53c2\u8003\u00a0OTA \u6587\u6863 </li> <li><code>phy</code>\uff1a\u7528\u4e8e\u5b58\u653e PHY \u521d\u59cb\u5316\u6570\u636e\uff1b\u4ece\u800c\u4fdd\u8bc1\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u8bbe\u5907\u914d\u7f6e PHY</li> <li><code>nvs</code>\uff1a\u975e\u6613\u5931\u6027\u5b58\u50a8\uff1b\u5b98\u65b9\u5efa\u8bae\u81f3\u5c11\u5206\u914d <code>0x3000</code> \u4e2a\u5b57\u8282\u7684\u7a7a\u95f4\uff0c\u5982\u679c\u4f7f\u7528\u5176 API \u5b58\u50a8\u5927\u91cf\u6570\u636e\uff0c\u9ed8\u8ba4\u662f <code>0x6000</code> \u4e2a\u5b57\u8282</li> <li><code>nvs_keys</code>\uff1anvs \u7684\u5bc6\u94a5\u5206\u533a</li> </ul> </li> </ul> </li> </ul> <p></p> <p>\u5b9e\u9645\u70e7\u5199\u7684\u5206\u533a\u8868\u4e0d\u662f csv \u6587\u4ef6\u672c\u8eab\uff0c\u9700\u8981\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002\u5982\u679c\u5728 menuconfig \u4e2d\u8bbe\u7f6e\u4e86\u5206\u533a\u8868 csv \u6587\u4ef6\u7684\u540d\u79f0\u7684\u8bdd\uff0c\u5229\u7528 idf. py \u6784\u5efa\u9879\u76ee\u5c06\u4f1a\u81ea\u52a8\u8f6c\u6362\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#2-ota","title":"2 OTA \u53c2\u8003","text":"<p>\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/qq_36347513/article/details/117819717?spm=1001.2014.3001.5501</p> <p>\u5b98\u65b9 API \u53c2\u8003\uff1a https://docs.espressif.com/projects/esp-idf/zh_CN/latest/esp32s3/api-reference/system/ota.html</p> <p>OTA \u8be6\u7ec6\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u539f\u751f API \u7684 demo \u6d41\u7a0b\u89e3\u6790\uff1a</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#21-http","title":"2.1 \u521b\u5efa HTTP \u670d\u52a1\u5668","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#211-python","title":"2.1.1 Python \u65b9\u5f0f","text":"<pre><code>python -m http.server --bind 192.168.61.67 8070\n</code></pre> <p>\u5728 build \u6587\u4ef6\u5939\u4e0b\u8fd0\u884c\u4e0a\u8ff0\u6307\u4ee4\uff0c\u5c06\u4f1a\u751f\u6210\u4e00\u4e2a\u672c\u5730\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u4e0b\u5bf9\u5e94 build \u6587\u4ef6\u5939\u4e0b\u7684\u6240\u6709\u5185\u5bb9\uff1b</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#212-hfs","title":"2.1.2 HFS \u65b9\u5f0f","text":"<p>\u4e00\u4e2a\u53ef\u89c6\u5316\u5de5\u5177\uff0c\u5927\u6982\u957f\u8fd9\u6837\uff1a</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#3-ota","title":"3 \u6d4b\u8bd5 OTA \u79fb\u690d\u4f8b\u7a0b","text":"<p>\u66f4\u65b0\uff1a2024 \u5e74 8 \u6708 24 \u65e5</p> <p>\u7531\u4e8e\u8be5\u535a\u5ba2\u7684\u516c\u5f00\u6027\u8d28\uff0c\u670d\u52a1\u5668\u516c\u7f51 IP \u53ca\u7aef\u53e3\u4f5c\u533f\u540d\u5904\u7406</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#31","title":"3.1 \u670d\u52a1\u5668\u90e8\u7f72","text":"<p>\u670d\u52a1\u5668\u7aef\u4e0d\u592a\u719f\u6089\uff0c\u6d4b\u8bd5\u6d41\u7a0b\u4e3b\u8981\u662f\u9a8c\u8bc1 ESP32 \u7684 OTA \u63a5\u53e3\uff0c\u670d\u52a1\u5668\u4e0a\u7684\u6d4b\u8bd5\u73af\u5883\u600e\u4e48\u7b80\u5355\u600e\u4e48\u6765</p> <p>\u5b89\u88c5\u5b9d\u5854\u9762\u677f\uff0c\u4e00\u952e\u90e8\u7f72 nginx</p> <p>\u4f7f\u7528 nginx \u90e8\u7f72 http \u670d\u52a1\u5668\uff0c\u6253\u5f00 autoindex\uff0c\u8bbe\u7f6e root \u8def\u5f84\uff1a</p> <pre><code># nginx\u7684\u914d\u7f6e\u6587\u4ef6\nserver{\n    listen xxxx;\n    server_name phpmyadmin;\n    # index index.html index.htm index.php;\n    root  /home/www/esp32bin; # &lt;- \u8fd9\u91cc\u662fbin\u6587\u4ef6\u653e\u7f6e\u7684\u8def\u5f84\n        location ~ /tmp/ {\n            return 403;\n        }\n    autoindex on;\n    autoindex_localtime on; \n    autoindex_exact_size off;\n}    \n</code></pre> <p>\u7ed3\u679c\uff1a</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240822-ESP32%E5%88%86%E5%8C%BA%E8%A1%A8%E5%8F%8AOTA/#32-esp32","title":"3.2 ESP32 \u7aef\u6d4b\u8bd5\u7ed3\u679c","text":"<pre><code>--- Using \\\\.\\COM8 instead...\n--- esp-idf-monitor 1.4.0 on \\\\.\\COM8 115200 ---\n--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---\nESP-ROM:esp32s3-20210327\nBuild:Mar 27 2021       \nrst:0x1 (POWERON),boot:0xb (SPI_FAST_FLASH_BOOT)\nSPIWP:0xee\nmode:DIO, clock div:1\nload:0x3fce3810,len:0x178c\nload:0x403c9700,len:0x4\nload:0x403c9704,len:0xcbc\nload:0x403cc700,len:0x2da0\nentry 0x403c9914\nI (27) boot: ESP-IDF v5.2.1 2nd stage bootloader\nI (27) boot: compile time Aug 23 2024 10:44:26\nI (27) boot: Multicore bootloader\nI (30) boot: chip revision: v0.2\nI (34) boot.esp32s3: Boot SPI Speed : 80MHz\nI (38) boot.esp32s3: SPI Mode       : DIO\nI (43) boot.esp32s3: SPI Flash Size : 8MB\nI (48) boot: Enabling RNG early entropy source...\nI (53) boot: Partition Table:\nI (57) boot: ## Label            Usage          Type ST Offset   Length\nI (64) boot:  0 nvs              WiFi data        01 02 00009000 00006000\nI (72) boot:  1 otadata          OTA data         01 00 0000f000 00002000\nI (79) boot:  2 phy_init         RF data          01 01 00011000 00001000\nI (87) boot:  3 factory          factory app      00 00 00020000 00200000\nI (94) boot:  4 ota_0            OTA app          00 10 00220000 00200000\nI (102) boot:  5 ota_1            OTA app          00 11 00420000 00200000\nI (109) boot: End of partition table\nI (113) boot: Defaulting to factory image\nI (118) esp_image: segment 0: paddr=00020020 vaddr=3c110020 size=56d8ch (355724) map\nI (190) esp_image: segment 1: paddr=00076db4 vaddr=3fc9bb00 size=05094h ( 20628) load\nI (195) esp_image: segment 2: paddr=0007be50 vaddr=40374000 size=041c8h ( 16840) load        \nI (200) esp_image: segment 3: paddr=00080020 vaddr=42000020 size=103d78h (1064312) map       \nI (396) esp_image: segment 4: paddr=00183da0 vaddr=403781c8 size=1382ch ( 79916) load\nI (423) boot: Loaded app from partition at offset 0x20000\nI (423) boot: Disabling RNG early entropy source...\nI (435) cpu_start: Multicore app\nI (444) cpu_start: Pro cpu start user code\nI (444) cpu_start: cpu freq: 160000000 Hz\nI (445) cpu_start: Application information:\nI (447) cpu_start: Project name:     entrance_idf_prj\nI (453) cpu_start: App version:      v1.0-38-gcc0dfe7-dirty\nI (459) cpu_start: Compile time:     Aug 24 2024 17:01:59\nI (466) cpu_start: ELF file SHA256:  a8a0453d5...\nI (471) cpu_start: ESP-IDF:          v5.2.1\nI (476) cpu_start: Min chip rev:     v0.0\nI (480) cpu_start: Max chip rev:     v0.99 \nI (485) cpu_start: Chip rev:         v0.2\nI (490) heap_init: Initializing. RAM available for dynamic allocation:\nI (497) heap_init: At 3FCA8AE0 len 00040C30 (259 KiB): RAM\nI (503) heap_init: At 3FCE9710 len 00005724 (21 KiB): RAM\nI (509) heap_init: At 3FCF0000 len 00008000 (32 KiB): DRAM\nI (516) heap_init: At 600FE010 len 00001FD8 (7 KiB): RTCRAM\nI (523) spi_flash: detected chip: gd\nI (526) spi_flash: flash io: dio\nI (530) sleep: Configure to isolate all GPIO pins in sleep state\nI (537) sleep: Enable automatic switching of GPIO sleep configuration\nI (544) coexist: coex firmware version: 77cd7f8\nI (549) coexist: coexist rom version e7ae62f\nI (555) main_task: Started on CPU0\nI (565) main_task: Calling app_main()\nI (565) indicate: indicate_init start\nI (565) indicate: indicate_YLED_setting\nI (575) indicate: indicate_GLED_on\nI (575) indicate: indicate_init end\nI (575) indicate: indicate_BUZ_setting\nI (1185) gpio: GPIO[7]| InputEn: 1| OutputEn: 1| OpenDrain: 1| Pullup: 1| Pulldown: 0| Intr:0\nI (1185) gpio: GPIO[6]| InputEn: 1| OutputEn: 1| OpenDrain: 1| Pullup: 1| Pulldown: 0| Intr:0\nI (1185) BM8563: I2C for BM8563 init success\nI (1195) BM8563: BM8563 has not lost power, getdata = 03\nI (1195) BM8563: BM8563 init success\nI (1225) STORAGE_TASK: [CONFIG] Lock delay: 1300000\nI (1225) STORAGE_TASK: [CONFIG] AES key: \ufffd\ufffdV\ufffd=\ufffd8\ufffd\ufffd\ufffd\ufffd1vVJ\nI (1235) main: Init value read success\nI (1235) BLE_INIT: BT controller compile version [30b57c4]\nI (1245) BLE_INIT: Bluetooth MAC: 48:27:e2:8f:2d:7a\nI (1245) phy_init: phy_version 640,cd64a1a,Jan 24 2024,17:28:12\nW (1315) BT_BTM: BTM_BleWriteAdvData, Partial data write into ADV\nI (1315) pp: pp rom version: e7ae62f\nW (1315) BT_BTM: BTM_BleWriteScanRsp, Partial data write into ADV\nI (1315) net80211: net80211 rom version: e7ae62f\nI (1325) GATTS_SERVER_TASK: create attribute table successfully, the number handle = 11\nI (1335) wifi:wifi driver task: 3fcc2218, prio:23, stack:6656, core=0\nI (1335) GATTS_SERVER_TASK: SERVICE_START_EVT1, status 0, service_handle 40\nI (1345) GATTS_SERVER_TASK: advertising start successfully\nI (1355) wifi:I (1355) GATTS_SERVER_TASK: create attribute table successfully, the number handle = 3\n\nwifi firmware version: a9f5b59\nI (1365) GATTS_SERVER_TASK: SERVICE_START_EVT2, status 0, service_handle 51\nI (1365) wifi:wifi certification version: v7.0\nI (1375) wifi:config NVS flash: enabled\nI (1385) wifi:config nano formating: disabled\nI (1385) wifi:Init data frame dynamic rx buffer num: 32\nI (1385) wifi:Init static rx mgmt buffer num: 5\nI (1395) wifi:Init management short buffer num: 32\nI (1395) wifi:Init dynamic tx buffer num: 32\nI (1405) wifi:Init static tx FG buffer num: 2\nI (1405) wifi:Init static rx buffer size: 1600\nI (1415) wifi:Init static rx buffer num: 10\nI (1415) wifi:Init dynamic rx buffer num: 32\nI (1415) wifi_init: rx ba win: 6\nI (1425) wifi_init: tcpip mbox: 32\nI (1425) wifi_init: udp mbox: 6\nI (1435) wifi_init: tcp mbox: 6\nI (1435) wifi_init: tcp tx win: 5760\nI (1435) wifi_init: tcp rx win: 5760\nI (1445) wifi_init: tcp mss: 1440\nI (1445) wifi_init: WiFi IRAM OP enabled\nI (1455) wifi_init: WiFi RX IRAM OP enabled\nI (1455) wifi:mode : sta (48:27:e2:8f:2d:78)\nI (1465) wifi:enable tsf\nI (1465) BLUFI_EXAMPLE: BLUFI VERSION 0103\n\nI (1465) BLUFI_EXAMPLE: BLUFI init finish\n\nI (1465) key_task: key_task_init\nI (1475) wifi:new:&lt;11,0&gt;, old:&lt;1,0&gt;, ap:&lt;255,255&gt;, sta:&lt;11,0&gt;, prof:1\nI (1485) wifi:state: init -&gt; auth (b0)\nI (1485) gpio: GPIO[1]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:2\nI (1505) LOCK_DRIVER: lock_driver_init\nI (1505) gpio: GPIO[8]| InputEn: 0| OutputEn: 1| OpenDrain: 0| Pullup: 0| Pulldown: 0| Intr:0\nE (1525) gpio: gpio_install_isr_service(506): GPIO isr service already installed\nI (1525) wiegand: Waiting for data...\nI (1525) sntp_task: Initializing SNTP\nI (1535) sntp_task: sntp_refresh_time_task running, beging to refresh time\nI (1535) sntp_task: SNTP task running, waiting net config done...\nI (1545) main_task: Returned from app_main()\nI (2245) wifi:state: auth -&gt; assoc (0)\nI (2255) wifi:state: assoc -&gt; run (10)\nI (2295) wifi:connected with HYSH, aid = 3, channel 11, BW20, bssid = 48:b2:5d:d2:16:04\nI (2295) wifi:security: WPA3-SAE, phy: bgn, rssi: -46\nI (2295) wifi:pm start, type: 1\n\nI (2295) wifi:dp: 1, bi: 102400, li: 3, scale listen interval from 307200 us to 307200 us    \nI (2305) wifi:set rx beacon pti, rx_bcn_pti: 14, bcn_timeout: 25000, mt_pti: 14, mt_time: 10000\nI (2395) wifi:AP's beacon interval = 102400 us, DTIM period = 1\nI (2695) wifi:&lt;ba-add&gt;idx:0 (ifx:0, 48:b2:5d:d2:16:04), tid:0, ssn:0, winSize:64\nI (4315) esp_netif_handlers: sta ip: 192.168.1.46, mask: 255.255.255.0, gw: 192.168.1.1\nI (4315) ota: Starting OTA example\nI (4315) sntp_task: WiFi Connected to ap\nI (4365) wifi:&lt;ba-add&gt;idx:1 (ifx:0, 48:b2:5d:d2:16:04), tid:6, ssn:1, winSize:64\nI (5315) ota: OTA example start, 1S...\nI (6315) ota: OTA example start, 2S...\nI (7315) ota: OTA example start, 3S...\nI (8315) ota: OTA example started.\nI (8315) ota: SHA-256 for bootloader:  bd27c0807747ae9c77adefe9a15aeae21b2d9a8a61a2ef1882cb6e2207388e93\nI (8445) ota: SHA-256 for current firmware:  904413ee3dafe2814ce298545c3d464521131a6822044f60cc814fc92e776468\nI (8445) ota: Starting OTA example task\nI (8445) BLUFI_EXAMPLE: BLUFI BLE is not connected yet\n\nI (8445) ota: Attempting to download update from http://xxx.xxx.xxx:yyyy/hello_world.bin\nI (8855) esp_https_ota: Starting OTA...\nI (8855) esp_https_ota: Writing to partition subtype 16 at offset 0x220000\nI (12275) esp_image: segment 0: paddr=00220020 vaddr=3c020020 size=0ce04h ( 52740) map\nI (12285) esp_image: segment 1: paddr=0022ce2c vaddr=3fc91e00 size=028c0h ( 10432) \nI (12285) esp_image: segment 2: paddr=0022f6f4 vaddr=40374000 size=00924h (  2340) \nI (12285) esp_image: segment 3: paddr=00230020 vaddr=42000020 size=18684h ( 99972) map       \nI (12305) esp_image: segment 4: paddr=002486ac vaddr=40374924 size=0d3e0h ( 54240) \nI (12325) esp_image: segment 0: paddr=00220020 vaddr=3c020020 size=0ce04h ( 52740) map\nI (12325) esp_image: segment 1: paddr=0022ce2c vaddr=3fc91e00 size=028c0h ( 10432) \nI (12335) esp_image: segment 2: paddr=0022f6f4 vaddr=40374000 size=00924h (  2340) \nI (12335) esp_image: segment 3: paddr=00230020 vaddr=42000020 size=18684h ( 99972) map       \nI (12355) esp_image: segment 4: paddr=002486ac vaddr=40374924 size=0d3e0h ( 54240) \nI (12405) ota: OTA Succeed, Rebooting...\n</code></pre> <p>\u5982\u4e0a log \u4fe1\u606f\u6240\u793a\uff0c\u5728 wifi \u4efb\u52a1\u8fde\u63a5\u5230 AP \u3001\u83b7\u53d6 IP \u540e\u6267\u884c <code>ota_task_start</code> \u6210\u529f\u8bbf\u95ee\u5230\u4e86\u76ee\u6807 <code>http://xxx.xxx.xxx:yyyy/hello_world.bin</code> \u5e76\u4e0b\u8f7d\uff0c\u5199\u5165 OTA \u5206\u533a\u540e\u91cd\u542f\u7cfb\u7edf\uff0c\u6210\u529f\u5b8c\u6210\u4e86\u4e00\u6b21 OTA \u5347\u7ea7\uff0clog \u5982\u4e0b\uff1a</p> <pre><code>I (12405) ota: OTA Succeed, Rebooting...\nI (12405) wifi:state: run -&gt; init (0)\nI (12405) wifi:pm stop, total sleep time: 5749810 us / 10104585 us\n\nI (12405) wifi:&lt;ba-del&gt;idx:0, tid:0\nI (12405) wifi:&lt;ba-del&gt;idx:1, tid:6\nI (12415) wifi:new:&lt;11,0&gt;, old:&lt;11,0&gt;, ap:&lt;255,255&gt;, sta:&lt;11,0&gt;, prof:1\nI (12485) wifi:flush txq\nI (12485) wifi:stop sw txq\nI (12485) wifi:lmac stop hw txq\nESP-ROM:esp32s3-20210327\nBuild:Mar 27 2021\nrst:0xc (RTC_SW_CPU_RST),boot:0xb (SPI_FAST_FLASH_BOOT)\nSaved PC:0x40375a20\n0x40375a20: esp_restart_noos at C:/Users/admin/esp/v5.2.1/esp-idf/components/esp_system/port/soc/esp32s3/system_internal.c:159\n\nSPIWP:0xee\nmode:DIO, clock div:1\nload:0x3fce3810,len:0x178c\nload:0x403c9700,len:0x4\nload:0x403c9704,len:0xcbc\nload:0x403cc700,len:0x2da0\nentry 0x403c9914\nI (31) boot: ESP-IDF v5.2.1 2nd stage bootloader\nI (31) boot: compile time Aug 23 2024 10:44:26\nI (31) boot: Multicore bootloader\nI (34) boot: chip revision: v0.2\nI (38) boot.esp32s3: Boot SPI Speed : 80MHz\nI (43) boot.esp32s3: SPI Mode       : DIO\nI (48) boot.esp32s3: SPI Flash Size : 8MB\nI (52) boot: Enabling RNG early entropy source...\nI (58) boot: Partition Table:\nI (61) boot: ## Label            Usage          Type ST Offset   Length\nI (69) boot:  0 nvs              WiFi data        01 02 00009000 00006000\nI (76) boot:  1 otadata          OTA data         01 00 0000f000 00002000\nI (84) boot:  2 phy_init         RF data          01 01 00011000 00001000\nI (91) boot:  3 factory          factory app      00 00 00020000 00200000\nI (98) boot:  4 ota_0            OTA app          00 10 00220000 00200000\nI (106) boot:  5 ota_1            OTA app          00 11 00420000 00200000\nI (114) boot: End of partition table\nI (118) esp_image: segment 0: paddr=00220020 vaddr=3c020020 size=0ce04h ( 52740) map\nI (136) esp_image: segment 1: paddr=0022ce2c vaddr=3fc91e00 size=028c0h ( 10432) load        \nI (138) esp_image: segment 2: paddr=0022f6f4 vaddr=40374000 size=00924h (  2340) load        \nI (144) esp_image: segment 3: paddr=00230020 vaddr=42000020 size=18684h ( 99972) map\nI (170) esp_image: segment 4: paddr=002486ac vaddr=40374924 size=0d3e0h ( 54240) load        \nI (187) boot: Loaded app from partition at offset 0x220000\nI (188) boot: Disabling RNG early entropy source...\nI (199) cpu_start: Multicore app\nI (209) cpu_start: Pro cpu start user code\nI (209) cpu_start: cpu freq: 160000000 Hz\nI (209) cpu_start: Application information:\nI (212) cpu_start: Project name:     hello_world\nI (217) cpu_start: App version:      1\nI (221) cpu_start: Compile time:     Aug 24 2024 17:10:18\nI (228) cpu_start: ELF file SHA256:  5d04de079...\nWarning: checksum mismatch between flashed and built applications. Checksum of built application is a8a0453d50ca5cab70ccc670adafcc7d7f87df7e3ae0f639b6257bc95f67d7d2\nI (233) cpu_start: ESP-IDF:          v5.2.1\nI (238) cpu_start: Min chip rev:     v0.0\nI (242) cpu_start: Max chip rev:     v0.99 \nI (247) cpu_start: Chip rev:         v0.2\nI (252) heap_init: Initializing. RAM available for dynamic allocation:\nI (259) heap_init: At 3FC94F90 len 00054780 (337 KiB): RAM\nI (265) heap_init: At 3FCE9710 len 00005724 (21 KiB): RAM\nI (271) heap_init: At 3FCF0000 len 00008000 (32 KiB): DRAM\nI (278) heap_init: At 600FE010 len 00001FD8 (7 KiB): RTCRAM\nI (285) spi_flash: detected chip: gd\nI (288) spi_flash: flash io: dio\nI (292) sleep: Configure to isolate all GPIO pins in sleep state\nI (299) sleep: Enable automatic switching of GPIO sleep configuration\nI (306) main_task: Started on CPU0\nI (316) main_task: Calling app_main()\nHello world!\nThis is esp32s3 chip with 2 CPU core(s), WiFi/BLE, silicon revision v0.2, 8MB external flash\nMinimum free heap size: 386880 bytes\nRestarting in 10 seconds...\nRestarting in 9 seconds...\nRestarting in 8 seconds...\nRestarting in 7 seconds...\nRestarting in 6 seconds...\nRestarting in 5 seconds...\nRestarting in 4 seconds...\nRestarting in 3 seconds...\nRestarting in 2 seconds...\nRestarting in 1 seconds...\nNone\nWaiting for the device to reconnect..............................................................\nESP-ROM:esp32s3-20210327\nBuild:Mar 27 2021\nrst:0x1 (POWERON),boot:0xb (SPI_FAST_FLASH_BOOT)\nSPIWP:0xee\nmode:DIO, clock div:1     \nload:0x3fce3810,len:0x178c\nload:0x403c9700,len:0x4   \nload:0x403c9704,len:0xcbc \nload:0x403cc700,len:0x2da0\nentry 0x403c9914\nI (27) boot: ESP-IDF v5.2.1 2nd stage bootloader\nI (27) boot: compile time Aug 23 2024 10:44:26  \nI (27) boot: Multicore bootloader\nI (30) boot: chip revision: v0.2\nI (34) boot.esp32s3: Boot SPI Speed : 80MHz\nI (38) boot.esp32s3: SPI Mode       : DIO\nI (43) boot.esp32s3: SPI Flash Size : 8MB\nI (48) boot: Enabling RNG early entropy source...\nI (53) boot: Partition Table:\nI (57) boot: ## Label            Usage          Type ST Offset   Length\nI (64) boot:  0 nvs              WiFi data        01 02 00009000 00006000\nI (72) boot:  1 otadata          OTA data         01 00 0000f000 00002000\nI (79) boot:  2 phy_init         RF data          01 01 00011000 00001000\nI (87) boot:  3 factory          factory app      00 00 00020000 00200000\nI (94) boot:  4 ota_0            OTA app          00 10 00220000 00200000\nI (102) boot:  5 ota_1            OTA app          00 11 00420000 00200000\nI (109) boot: End of partition table\nI (113) esp_image: segment 0: paddr=00220020 vaddr=3c020020 size=0ce04h ( 52740) map\nI (131) esp_image: segment 1: paddr=0022ce2c vaddr=3fc91e00 size=028c0h ( 10432) load\nI (134) esp_image: segment 2: paddr=0022f6f4 vaddr=40374000 size=00924h (  2340) load\nI (139) esp_image: segment 3: paddr=00230020 vaddr=42000020 size=18684h ( 99972) map\nI (165) esp_image: segment 4: paddr=002486ac vaddr=40374924 size=0d3e0h ( 54240) load\nI (183) boot: Loaded app from partition at offset 0x220000\nI (183) boot: Disabling RNG early entropy source...\nI (195) cpu_start: Multicore app\nI (204) cpu_start: Pro cpu start user code\nI (204) cpu_start: cpu freq: 160000000 Hz\nI (204) cpu_start: Application information:\nI (207) cpu_start: Project name:     hello_world\nI (213) cpu_start: App version:      1\nI (217) cpu_start: Compile time:     Aug 24 2024 17:10:18\nI (223) cpu_start: ELF file SHA256:  5d04de079...\nWarning: checksum mismatch between flashed and built applications. Checksum of built application is a8a0453d50ca5cab70ccc670adafcc7d7f87df7e3ae0f639b6257bc95f67d7d2\nI (228) cpu_start: ESP-IDF:          v5.2.1\nI (233) cpu_start: Min chip rev:     v0.0\nI (238) cpu_start: Max chip rev:     v0.99 \nI (243) cpu_start: Chip rev:         v0.2\nI (248) heap_init: Initializing. RAM available for dynamic allocation:\nI (255) heap_init: At 3FC94F90 len 00054780 (337 KiB): RAM\nI (261) heap_init: At 3FCE9710 len 00005724 (21 KiB): RAM\nI (267) heap_init: At 3FCF0000 len 00008000 (32 KiB): DRAM\nI (273) heap_init: At 600FE010 len 00001FD8 (7 KiB): RTCRAM\nI (280) spi_flash: detected chip: gd\nI (284) spi_flash: flash io: dio\nI (288) sleep: Configure to isolate all GPIO pins in sleep state\nI (295) sleep: Enable automatic switching of GPIO sleep configuration\nI (302) main_task: Started on CPU0\nI (312) main_task: Calling app_main()\nHello world!\nThis is esp32s3 chip with 2 CPU core(s), WiFi/BLE, silicon revision v0.2, 8MB external flash\nMinimum free heap size: 386880 bytes\nRestarting in 10 seconds...\nRestarting in 9 seconds...\nRestarting in 8 seconds...\nRestarting in 7 seconds...\nRestarting in 6 seconds...\nRestarting in 5 seconds...\nRestarting in 4 seconds...\nRestarting in 3 seconds...\nRestarting in 2 seconds...\nRestarting in 1 seconds...\nRestarting in 0 seconds...\nRestarting now.\n</code></pre> <p>\u5e76\u4e14\u5728\u7b2c\u4e00\u6b21\u7f16\u8bd1\u4f8b\u7a0b <code>hello_worldF</code> \u65f6\u6ca1\u6709\u6b63\u786e\u9009\u62e9\u82af\u7247 target\uff0c\u5728\u7b2c\u4e00\u6b21\u6d4b\u8bd5\u65f6 ESP32-S3 \u8bbf\u95ee\u5230\u4e86\u76ee\u6807\u5730\u5740\u540e\uff0c\u63d0\u793a\u62a5\u9519\u82af\u7247\u5bf9\u8c61\u5339\u914d\u9519\u8bef\uff0c\u81ea\u52a8\u5931\u8d25 OTA \u6d41\u7a0b\u3002</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240905-%E6%9B%B4%E6%96%B0storage%E4%BB%A5%E5%8F%8Amqtt%E6%A8%A1%E5%9D%97%E9%83%A8%E5%88%86%EF%BC%8C%E9%80%90%E6%AD%A5%E5%AE%9E%E7%8E%B0%E7%A7%81%E6%9C%89json%E5%8D%8F%E8%AE%AE/","title":"240905-\u66f4\u65b0 Storage \u4ee5\u53ca MQTT \u6a21\u5757\u90e8\u5206\uff0c\u9010\u6b65\u5b9e\u73b0\u79c1\u6709 json \u534f\u8bae","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240905-%E6%9B%B4%E6%96%B0storage%E4%BB%A5%E5%8F%8Amqtt%E6%A8%A1%E5%9D%97%E9%83%A8%E5%88%86%EF%BC%8C%E9%80%90%E6%AD%A5%E5%AE%9E%E7%8E%B0%E7%A7%81%E6%9C%89json%E5%8D%8F%E8%AE%AE/#1","title":"1 \u63d0\u4ea4","text":"<p>\u672c\u6b21\u63d0\u4ea4\uff1a https://gitee.com/chenym_simpler/git_lock_electromagnet/commit/5bda321cc7d5459e0bb0fdf33590a92ee622d0a9</p> <p></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240905-%E6%9B%B4%E6%96%B0storage%E4%BB%A5%E5%8F%8Amqtt%E6%A8%A1%E5%9D%97%E9%83%A8%E5%88%86%EF%BC%8C%E9%80%90%E6%AD%A5%E5%AE%9E%E7%8E%B0%E7%A7%81%E6%9C%89json%E5%8D%8F%E8%AE%AE/#2-storage","title":"2 Storage \u90e8\u5206","text":"<p>\u5bf9\u4e8e\u9700\u8981\u6389\u7535\u4fdd\u5b58\u7684\u6570\u636e\u6765\u8bb2\u4e00\u822c\u53ef\u4ee5\u5206\u4f5c\u5b57\u7b26\u4e32\u4ee5\u53ca\u6570\u636e\u7c7b\uff0c\u4f8b\u5982\uff1a</p> <pre><code>typedef struct\n{\n    char name[32];\n    uint16_t id;\n    char type[32];\n    char firmware_version[8];\n    char hardware_version[8];\n    uint16_t max_user_count;\n    uint16_t max_card_count;\n    uint16_t user_count;\n    uint16_t card_count;\n    char wiegand_type[16];\n} device_info_t;\n</code></pre> <p>\u8be5\u7ed3\u6784\u4f53\u4e2d <code>name</code> \u5373\u5c5e\u4e8e\u5b57\u7b26\u4e32\u3001<code>id</code> \u7b49\u5c31\u5c5e\u4e8e\u6570\u5b57\u7c7b\u578b</p> <p>\u82e5\u6309\u7167\u539f\u672c nvs \u7684\u64cd\u4f5c\uff0c\u5b58\u50a8\u5355\u5355\u4e00\u4e2a\u53d8\u91cf\u7684\u64cd\u4f5ci\u5c31\u4f1a\u8fc7\u4e8e\u5197\u957f\uff1a</p> <pre><code>/* \u83b7\u53d6device_info */\nerr = nvs_get_blob(nvs_handle, NVS_KEY_NAME_DEVICE_NAME, device_info.device_name, 25);\nif (err != ESP_OK)\n{\n    ESP_LOGE(TAG, \"Failed to get device name, config default value\");\n\n    strcpy(device_info.name, DEVICE_DEFAULT_NAME);\n\n    /* \u7f3a\u7701\u503c\u914d\u7f6e */\n    err = nvs_set_blob(nvs_handle, NVS_KEY_NAME_DEVICE_NAME, device_info.device_name, 25);\n\n    return 4; // \u968f\u624b\u5199\u7684\u8fd4\u56de\u7801\uff0c\u4e0d\u7528\u5728\u610f\n}\n</code></pre> <p>\u56e0\u6b64\u8003\u8651\u5c01\u88c5\u4e00\u4e2a\u51fd\u6570\u7528\u4e8e\u7b80\u5316\u521d\u59cb\u5316\u53d8\u91cf\u7684\u8bfb\u53d6\u64cd\u4f5c\uff1a</p> <pre><code>esp_err_t nvs_get_or_set_default(nvs_handle_t nvs_handle, const char *key, void *value, size_t length, const void *default_value)\n</code></pre> <p>\u8be5\u51fd\u6570\u63a5\u6536\u9700\u8981\u64cd\u4f5c\u7684 nvs \u53e5\u67c4\u3001nvs \u952e\u540d\u3001\u8bfb\u51fa\u53d8\u91cf\u6307\u9488\u3001\u8bfb\u51fa\u957f\u5ea6\u3001\u9ed8\u8ba4\u53d8\u91cf\u6307\u9488</p> <p>\u4e4b\u6240\u4ee5\u8fd9\u91cc\u90fd\u4f7f\u7528\u53d8\u91cf\u6307\u9488\u7684\u65b9\u5f0f\u662f\u7531\u4e8e\u6bcf\u4e2a\u9700\u8981\u5b58\u50a8\u7684\u6570\u636e\u90fd\u662f\u4e0d\u5b9a\u957f\u7684\uff0c\u5e76\u4e14\u5728\u7f16\u8bd1\u540e\u6ca1\u6709\u5206\u914d\u9759\u6001\u5185\u5b58</p> <p>\u8be5\u51fd\u6570\u5b9e\u73b0\uff1a</p> <pre><code>if (value == NULL || default_value == NULL)\n{\n    ESP_LOGE(TAG, \"Value or default value is NULL\");\n    return ESP_ERR_INVALID_ARG;\n}\n\nesp_err_t err = nvs_get_blob(nvs_handle, key, value, &amp;length);\nif (err != ESP_OK)\n{\n    ESP_LOGE(TAG, \"Failed to get %s, config default value\", key);\n\n    memcpy(value, default_value, length);\n\n    /* \u7f3a\u7701\u503c\u914d\u7f6e */\n    err = nvs_set_blob(nvs_handle, key, value, length);\n    if (err != ESP_OK)\n    {\n        ESP_LOGE(TAG, \"Failed to set default value for %s, err: %x\", key, err);\n        return err;\n    }\n}\n\n// \u68c0\u67e5 value \u662f\u5426\u4e3a\u5b57\u7b26\u4e32\u5e76\u4ee5\u7a7a\u5b57\u7b26\u7ed3\u5c3e\nif (((char *)value)[length - 1] != '\\0')\n{\n    ESP_LOGW(TAG, \"Value for %s is not a null-terminated string\", key);\n    return ESP_ERR_INVALID_ARG;\n}\n\nESP_LOGI(TAG, \"[CONFIG] %s: %s\", key, (char *)value);\nreturn ESP_OK;\n</code></pre> <p>\u4e3b\u8981\u662f\u5728\u9ed8\u8ba4\u503c\u7684\u5b9a\u4e49\u4e0a\u9762\u7a0d\u5fae\u7ed5\u4e86\u4e00\u4e0b\u5f2f\u5b50\uff0c\u7531\u4e8e\u6240\u6709\u9ed8\u8ba4\u503c\u90fd\u662f\u4f7f\u7528 <code>#define</code> \u6765\u5b9a\u4e49\u7684\uff0c\u56e0\u6b64\u5728\u4f20\u5165\u7684\u65f6\u5019\u9700\u8981\u53d8\u91cf\u6307\u9488\u4e0d\u592a\u65b9\u4fbf</p> <p>\u8fd9\u91cc\u53c8\u4f7f\u7528\u4e86\u4e00\u4e0b c99 \u7684\u7279\u6027\u590d\u5408\u5b57\u9762\u91cf\uff0c\u7b14\u8bb0\u89c1\u8fd9\u4e2a\u94fe\u63a5\uff0c\u4e5f\u4f7f\u7528\u4e86\u4e00\u4e0b c11 \u5f15\u5165\u7684\u6cdb\u578b\u9009\u62e9\u5668 <code>_Generic()</code> \uff0c\u7b14\u8bb0\u89c1\u8fd9\u4e2a\u94fe\u63a5</p> <pre><code>#define PTR_TO_CONST(x) _Generic((x),    \\\n    int: (const void *)&amp;(const int){x},  \\\n    const char *: (const void *)(x),     \\\n    char *: (const void *)(x))           \\\n</code></pre> <p>\u901a\u8fc7\u4ee5\u4e0a\u64cd\u4f5c\u4fbf\u628a\u521d\u59cb\u5316\u51fd\u6570\u91cd\u6784\u4e3a\u4ee5\u4e0b\u6837\u5f0f\uff1a</p> <pre><code>STG_err_t storage_read_init_value(void)\n{\n    nvs_handle_t nvs_handle;\n\n    /* \u6253\u5f00nvs */\n    esp_err_t err = nvs_open(STORAGE_ENTRANCE, NVS_READWRITE, &amp;nvs_handle);\n    if (err != ESP_OK)\n    {\n        ESP_LOGE(TAG, \"Failed to open nvs\");\n        return STG_ERR;\n    }\n...\n    err = nvs_get_or_set_default(\n        nvs_handle,\n        NVS_KEY_NAME_DEVICE_FIRMWARE_VERSION,\n        device_info.firmware_version,\n        sizeof(device_info.firmware_version),\n        PTR_TO_CONST(DEVICE_DEFAULT_FIRMWARE_VERSION));\n\n    err = nvs_get_or_set_default(\n        nvs_handle,\n        NVS_KEY_NAME_DEVICE_HARDWARE_VERSION,\n        device_info.hardware_version,\n        sizeof(device_info.hardware_version),\n        PTR_TO_CONST(DEVICE_DEFAULT_HARDWARE_VERSION));\n...\n    /* ------------------------------ \u83b7\u53d6\u521d\u59cb\u5316\u4fe1\u606f\u7ed3\u675f ----------------------------- */\n\n    nvs_close(nvs_handle);\n\n    return STG_OK;\n}\n</code></pre>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/ESP32/240905-%E6%9B%B4%E6%96%B0storage%E4%BB%A5%E5%8F%8Amqtt%E6%A8%A1%E5%9D%97%E9%83%A8%E5%88%86%EF%BC%8C%E9%80%90%E6%AD%A5%E5%AE%9E%E7%8E%B0%E7%A7%81%E6%9C%89json%E5%8D%8F%E8%AE%AE/#3-mqtt","title":"3 MQTT \u90e8\u5206","text":"<p>IDF \u7684\u6587\u6863\u5bf9\u4e8e MQTT5 \u7684\u90e8\u5206\u8fd8\u6ca1\u6709\u5b8c\u5584\u7684\u5f88\u8be6\u7ec6\uff0c\u53cd\u6b63\u4eca\u5929\u627e\u5230\u7684\u5b98\u65b9\u6587\u6863\u4e0a\u9762\u53ea\u4e22\u4e86\u4e00\u4e2a\u4e00\u5e74\u524d\u7684\u4f8b\u7a0b\uff1a</p> <p>\u5b98\u65b9 MQTT5 \u4f8b\u7a0b</p> <p>\u7b80\u8981\u8bb0\u5f55\u4e00\u4e0b\u8e29\u7684\ud83d\udd73\uff1a</p> <p>\u9996\u5148 IDF \u4e0a\u9762\u5982\u679c\u8981\u4f7f\u7528 MQTT5 \u7684\u8bdd\u4e0d\u5149 menuconfig \u91cc\u9762\u8981\u52fe\u4e0a Enable\uff1a</p> <p></p> <p>\u800c\u4e14\u5728\u521d\u59cb\u5316 mqtt_client \u53e5\u67c4\u7684\u65f6\u5019\u4e5f\u8981\u6307\u5b9a\uff1a</p> <pre><code>const esp_mqtt_client_config_t mqtt_cfg = {\n    .broker.address.uri = CONFIG_BROKER_URI,\n    .session.protocol_ver = MQTT_PROTOCOL_V_5, // &lt;HERE&gt;\n};\n\nclient = esp_mqtt_client_init(&amp;mqtt_cfg);\n</code></pre> <p>\u4e3b\u8981\u662f\u5e0c\u671b\u4f7f\u7528\u4e00\u4e0b MQTT5 \u7684 No local \u529f\u80fd\uff0c\u56e0\u4e3a\u4e0d\u60f3\u6539\u534f\u8bae\u5185\u5bb9\uff08\uff09</p> <pre><code>static esp_mqtt5_subscribe_property_config_t subscribe_property_nolocal = {\n    .subscribe_id = 25555,\n    .no_local_flag = true,\n    .retain_as_published_flag = false,\n    .retain_handle = 0,\n};\n</code></pre> <pre><code>static esp_mqtt5_user_property_item_t user_property_arr[] = {{\"board\", \"esp32\"}, {\"u\", \"user\"}, {\"p\", \"password\"}};\n</code></pre> <pre><code>esp_mqtt5_client_set_user_property(&amp;subscribe_property_nolocal.user_property, user_property_arr, USE_PROPERTY_ARR_SIZE); // \u8bbe\u7f6e\u7528\u6237\u5c5e\u6027\nesp_mqtt5_client_set_subscribe_property(client, &amp;subscribe_property_nolocal);                                            // \u8bbe\u7f6e\u8ba2\u9605\u5c5e\u6027\nmsg_id = esp_mqtt_client_subscribe(client, device_mqtt_topic, 0);\nesp_mqtt5_client_delete_user_property(subscribe_property_nolocal.user_property); // \u5220\u9664\u7528\u6237\u5c5e\u6027\nsubscribe_property_nolocal.user_property = NULL;\nESP_LOGI(TAG, \"sent subscribe successful, msg_id=%d\", msg_id);\n</code></pre> <p>\u4ee5\u4e0a\u90fd\u662f\u6682\u65f6\u6a21\u4eff\u5b98\u65b9\u4f8b\u7a0b\u91cc\u9762\u7684\u5199\u6cd5\u8fdb\u884c\u914d\u7f6e</p> <p>\u914d\u7f6e\u7ed3\u679c\uff1a</p> <p></p> <p>\u6570\u636e\u90fd\u662f\u6d4b\u8bd5\u6570\u636e</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240814-CubeMX%2BFreeRTOS%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/","title":"240814-CubeMX+FreeRTOS\u5f00\u53d1\u7b14\u8bb0","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240814-CubeMX%2BFreeRTOS%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#_1","title":"\u786c\u4ef6\u53c2\u8003","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240814-CubeMX%2BFreeRTOS%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#1","title":"1 \u5f15\u811a\u53c2\u8003","text":"<p>\u4f7f\u7528 cubemx \u914d\u7f6e\u5f15\u811a\uff0c\u5916\u8bbe\u4f7f\u7528\u60c5\u51b5\u5982\u4e0a</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240814-CubeMX%2BFreeRTOS%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#2","title":"2 \u65f6\u949f\u6811\u53c2\u8003","text":"<ul> <li>APB1 \u603b\u7ebf\u901f\u5ea6\uff1a<code>42MHz</code></li> <li>APB1 \u5b9a\u65f6\u5668\u65f6\u949f\uff1a<code>84MHz</code></li> <li>APB2 \u603b\u7ebf\u901f\u5ea6\uff1a<code>84MHz</code></li> <li>APB2 \u5b9a\u65f6\u5668\u65f6\u949f\uff1a<code>168MHz</code></li> </ul> <p>APB1 \u603b\u7ebf\u901f\u5ea6\u5fc5\u987b\u5c0f\u4e8e <code>42MHz</code>\uff1bAPB2 \u603b\u7ebf\u901f\u5ea6\u5fc5\u987b\u5c0f\u4e8e <code>84MHz</code></p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240814-CubeMX%2BFreeRTOS%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#3","title":"3 \u5b9a\u65f6\u5668","text":"<p>\u7531\u4e8e\u5149\u6e90\u9a71\u52a8\u9700\u8981\uff0c\u672c\u6b21\u786c\u4ef6\u8bbe\u8ba1\u9700\u8981\u975e\u5e38\u591a\u7684 pwm \u8f93\u51fa\u901a\u9053\uff0c\u6545\u5728\u6b64\u5bf9\u4e8e F407VET6 \u7684\u5b9a\u65f6\u5668\u8d44\u6e90\u505a\u7b80\u8981\u7b14\u8bb0</p> <p>\u5b9a\u65f6\u5668\u5916\u8bbe\u90e8\u5206\u4e00\u822c\u9002\u7528\u4e8e\u6574\u4e2a F4 \u7cfb\u5217</p> <p>STM32F405xx/07xx \u548c STM32F415xx/17xx \u7684\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\u7531\u786c\u4ef6\u81ea\u52a8\u8bbe\u7f6e\u3002\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a</p> <ol> <li>\u5982\u679c APB \u9884\u5206\u9891\u5668\u4e3a 1\uff0c\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\u7b49\u4e8e APB \u57df\u7684\u9891\u7387\u3002 </li> <li>\u5426\u5219\uff0c\u7b49\u4e8e APB \u57df\u7684\u9891\u7387\u7684\u4e24\u500d (\u00d72)\u3002</li> </ol> <p></p> <p>TIM1\u30018\u30019\u300110\u300111 \u5c5e\u4e8e APB2 \u603b\u7ebf\uff0c\u6700\u9ad8\u53ef\u8fbe 168MHz</p> <p>TIM2\u30013\u30014\u30015\u300112\u300113\u300114 \u5c5e\u4e8e APB1 \u603b\u7ebf\uff0c\u6700\u9ad8\u53ef\u8fbe 84MHz</p> <p>TIM6\u30017 \u4e5f\u5c5e\u4e8e APB1 \u603b\u7ebf\uff0c\u662f\u4e24\u4e2a\u57fa\u7840\u5b9a\u65f6\u5668</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240830-%E7%BC%BA%E9%99%B7%E6%A3%80%E6%B5%8B%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/","title":"240830-\u7f3a\u9677\u68c0\u6d4b\u5149\u6e90\u63a7\u5236\u5668\u5f00\u53d1\u7b14\u8bb0","text":""},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240830-%E7%BC%BA%E9%99%B7%E6%A3%80%E6%B5%8B%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#1-pwm","title":"1 pwm \u7b14\u8bb0","text":"<p>\u5728 STM32F407VET6 \u4e0a\uff0c\u5b9a\u65f6\u5668 7 \u7684\u9884\u5206\u9891\u5668\uff08PSC\uff09\u8bbe\u7f6e\u4e3a 83\uff0c\u81ea\u52a8\u91cd\u88c5\u8f7d\u5bc4\u5b58\u5668\uff08ARR\uff09\u8bbe\u7f6e\u4e3a 1000 \u65f6\uff0c\u53ef\u4ee5\u4ea7\u751f\u5982\u4e0b\u7279\u6027\u7684 PWM \u4fe1\u53f7\uff1a</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240830-%E7%BC%BA%E9%99%B7%E6%A3%80%E6%B5%8B%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#11","title":"1.1 \u8ba1\u7b97\u6b65\u9aa4","text":"<ol> <li>\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\uff1a</li> <li> <p>\u5047\u8bbe\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\u4e3a 84 MHz\uff08\u901a\u5e38\u662f APB1 \u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\uff09\u3002</p> </li> <li> <p>\u9884\u5206\u9891\u5668\uff08PSC\uff09\uff1a</p> </li> <li> <p>\u9884\u5206\u9891\u5668\u8bbe\u7f6e\u4e3a 83\uff0c\u8fd9\u610f\u5473\u7740\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\u88ab\u5206\u9891\u4e3a\uff1a $$ \\text{Timer Clock} = \\frac{84 \\text{ MHz}}{(PSC + 1)} = \\frac{84 \\text{ MHz}}{84} = 1 \\text{ MHz} $$</p> </li> <li> <p>\u81ea\u52a8\u91cd\u88c5\u8f7d\u5bc4\u5b58\u5668\uff08ARR\uff09\uff1a</p> </li> <li>ARR \u8bbe\u7f6e\u4e3a 1000\uff0c\u8fd9\u610f\u5473\u7740\u5b9a\u65f6\u5668\u8ba1\u6570\u4ece 0 \u8ba1\u6570\u5230 1000\uff0c\u7136\u540e\u91cd\u65b0\u5f00\u59cb\u3002</li> <li>PWM \u9891\u7387\uff1a</li> <li>PWM \u9891\u7387\u7531\u5b9a\u65f6\u5668\u65f6\u949f\u9891\u7387\u548c ARR \u51b3\u5b9a\uff1a</li> <li>$$  \\text{PWM Frequency} = \\frac{\\text{Timer Clock}}{\\text{ARR} + 1} = \\frac{1 \\text{ MHz}}{1000 + 1} \\approx 999 \\text{ Hz}</li> </ol> <p>$$</p>"},{"location":"%E5%B9%B3%E5%8F%B0/00-MCU/STM32/240830-%E7%BC%BA%E9%99%B7%E6%A3%80%E6%B5%8B%E5%85%89%E6%BA%90%E6%8E%A7%E5%88%B6%E5%99%A8%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/#12-pwm","title":"1.2 PWM \u5360\u7a7a\u6bd4","text":"<p>PWM \u5360\u7a7a\u6bd4\u7531\u6355\u83b7\u6bd4\u8f83\u5bc4\u5b58\u5668\uff08CCR\uff09\u7684\u503c\u51b3\u5b9a\u3002\u5047\u8bbe <code>CCR</code> \u7684\u503c\u4e3a <code>dutyCycle</code>\uff0c\u5219\u5360\u7a7a\u6bd4\u8ba1\u7b97\u5982\u4e0b\uff1a</p> \\[\\text{Duty Cycle} = \\frac{\\text{CCR}}{\\text{ARR} + 1} \\times 100\\%\\] <p>\u4f8b\u5982\uff0c\u5982\u679c <code>dutyCycle</code> \u8bbe\u7f6e\u4e3a 500\uff0c\u5219\u5360\u7a7a\u6bd4\u4e3a\uff1a</p> <p>\\(\\(\\text{Duty Cycle} = \\frac{500}{1000 + 1} \\times 100\\% \\approx 49.95\\%\\)\\) - APB1 \u603b\u7ebf\u901f\u5ea6\uff1a<code>42MHz</code> - APB1 \u5b9a\u65f6\u5668\u65f6\u949f\uff1a<code>84MHz</code> - APB2 \u603b\u7ebf\u901f\u5ea6\uff1a<code>84MHz</code> - APB2 \u5b9a\u65f6\u5668\u65f6\u949f\uff1a<code>168MHz</code></p> <p>APB1 \u603b\u7ebf\u901f\u5ea6\u5fc5\u987b\u5c0f\u4e8e <code>42MHz</code>\uff1bAPB2 \u603b\u7ebf\u901f\u5ea6\u5fc5\u987b\u5c0f\u4e8e <code>84MHz</code></p> <p>TIM1\u30018\u30019\u300110\u300111 \u5c5e\u4e8e APB2 \u603b\u7ebf\uff0c\u6700\u9ad8\u53ef\u8fbe 168MHz</p> <p>TIM2\u30013\u30014\u30015\u300112\u300113\u300114 \u5c5e\u4e8e APB1 \u603b\u7ebf\uff0c\u6700\u9ad8\u53ef\u8fbe 84MHz</p> <p>TIM6\u30017 \u4e5f\u5c5e\u4e8e APB1 \u603b\u7ebf\uff0c\u662f\u4e24\u4e2a\u57fa\u7840\u5b9a\u65f6\u5668</p>"},{"location":"%E5%B9%B3%E5%8F%B0/01-SOC/","title":"SOC","text":""},{"location":"%E7%A1%AC%E4%BB%B6/","title":"\u786c\u4ef6","text":"<ul> <li> <p> \u57fa\u7840\u7406\u8bba</p> <p>\u6db5\u76d6\u6a21\u62df\u7535\u5b50\u3001\u6570\u5b57\u7535\u5b50\u548c\u4fe1\u53f7\u5b8c\u6574\u6027\u7b49\u65b9\u9762</p> <p>\u201c\u57fa\u7840\u7406\u8bba\u201d\uff1a\u6a21\u7535/\u6570\u7535/\u4fe1\u53f7\u5b8c\u6574\u6027\u2026</p> </li> <li> <p> \u7535\u8def\u4e0e\u6a21\u5757</p> <p>\u7535\u8def\u8bbe\u8ba1\u548c\u5404\u79cd\u7535\u5b50\u6a21\u5757\u7684\u5206\u7c7b</p> <p>\u201c\u7535\u8def\u4e0e\u6a21\u5757\u201d\uff1a\u7535\u8def\u8bbe\u8ba1/\u7535\u5b50\u5143\u4ef6/\u6a21\u5757\u96c6\u6210\u2026</p> </li> <li> <p> Layout\u53c2\u8003</p> <p>PCB\u5e03\u5c40\u548c\u8bbe\u8ba1\u7684\u53c2\u8003\u6307\u5357</p> <p>\u201cLayout\u53c2\u8003\u201d\uff1aPCB\u5e03\u5c40/\u8bbe\u8ba1\u539f\u5219/\u6700\u4f73\u5b9e\u8df5\u2026</p> </li> <li> <p> \u673a\u68b0\u7ed3\u6784</p> <p>\u673a\u68b0\u8bbe\u8ba1\u548c\u7ed3\u6784\u5de5\u7a0b\u7684\u5206\u7c7b</p> <p>\u201c\u673a\u68b0\u7ed3\u6784\u201d\uff1a\u673a\u68b0\u8bbe\u8ba1/\u7ed3\u6784\u5206\u6790/\u529b\u5b66\u539f\u7406\u2026</p> </li> <li> <p> \u6750\u6599</p> <p>\u6750\u6599\u79d1\u5b66\u548c\u786c\u4ef6\u5236\u9020\u6750\u6599\u7684\u5206\u7c7b</p> <p>\u201c\u6750\u6599\u201d\uff1a\u5bfc\u7535\u6750\u6599/\u7edd\u7f18\u6750\u6599/\u590d\u5408\u6750\u6599\u2026</p> </li> </ul>"},{"location":"%E7%A1%AC%E4%BB%B6/03-%E6%9C%BA%E6%A2%B0%E7%BB%93%E6%9E%84/240820-SolidWorks%E5%BC%80%E8%9E%BA%E7%BA%B9%E5%AD%94/","title":"240820 SolidWorks\u5f00\u87ba\u7eb9\u5b54","text":"<p>\u53c2\u8003\u535a\u5ba2\uff1a https://blog.csdn.net/haigear/article/details/111504639</p> <p>\u5f00\u5b54\u5411\u5bfc\u9009\u62e9\u87ba\u7eb9\u5b54</p>"},{"location":"%E8%BD%AF%E4%BB%B6/","title":"\u8f6f\u4ef6","text":"<ul> <li> <p> \u901a\u7528\u7b97\u6cd5</p> <p>\u6db5\u76d6\u5404\u79cd\u901a\u7528\u7b97\u6cd5\u548c\u6570\u636e\u7ed3\u6784</p> <p>\u201c\u901a\u7528\u7b97\u6cd5\u201d\uff1a\u6392\u5e8f\u7b97\u6cd5/\u641c\u7d22\u7b97\u6cd5/\u56fe\u7b97\u6cd5\u2026</p> </li> <li> <p> \u5d4c\u5165\u5f0f\u8f6f\u4ef6</p> <p>\u4e13\u6ce8\u4e8e\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5f00\u53d1</p> <p>\u201c\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u201d\uff1a\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf/\u9a71\u52a8\u7a0b\u5e8f/\u4e2d\u95f4\u4ef6/\u901a\u8baf\u534f\u8bae\u2026</p> </li> <li> <p> \u5d4c\u5165\u5f0fLinux</p> <p>\u5d4c\u5165\u5f0fLinux\u7cfb\u7edf\u5f00\u53d1\u548c\u5e94\u7528</p> <p>\u201c\u5d4c\u5165\u5f0fLinux\u201d\uff1aLinux\u5185\u6838/\u6587\u4ef6\u7cfb\u7edf/\u8bbe\u5907\u6811\u2026</p> </li> <li> <p> WEB\u6280\u672f</p> <p>WEB\u5f00\u53d1\u548c\u8bbe\u8ba1\u76f8\u5173\u6280\u672f</p> <p>\u201cWEB\u6280\u672f\u201d\uff1aHTML/CSS/JavaScript/\u6846\u67b6\u2026</p> </li> <li> <p> AI</p> <p>\u4eba\u5de5\u667a\u80fd\u548c\u673a\u5668\u5b66\u4e60\u9886\u57df</p> <p>\u201cAI\u201d\uff1a\u673a\u5668\u5b66\u4e60/\u6df1\u5ea6\u5b66\u4e60/\u81ea\u7136\u8bed\u8a00\u5904\u7406\u2026</p> </li> <li> <p> \u8bed\u8a00</p> <p>\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00</p> <p>\u201c\u7f16\u7a0b\u8bed\u8a00\u201d\uff1aC/C++/Python/RUST/GO\u2026</p> </li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E7%94%A8%E7%AE%97%E6%B3%95/","title":"\u901a\u7528\u7b97\u6cd5","text":""},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/","title":"\u5d4c\u5165\u5f0f\u8f6f\u4ef6","text":"<ul> <li> <p> \u901a\u8baf\u534f\u8bae</p> <ul> <li>\u97e6\u6839\u534f\u8bae</li> </ul> </li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/00-%E9%9F%A6%E6%A0%B9%E5%8D%8F%E8%AE%AEWiegand/","title":"00 \u97e6\u6839\u534f\u8baeWiegand","text":"<p>\u97e6\u6839\u534f\u8bae\u662f\u4e00\u79cd\u6570\u636e\u4f20\u8f93\u534f\u8bae\uff0c\u5e38\u5e38\u5e94\u7528\u5728\u95e8\u7981\u63a7\u5236\u7cfb\u7edf\u4e2d\uff0c\u5b9e\u73b0\u8bfb\u5361\u5668\u548c\u63a7\u5236\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/00-%E9%9F%A6%E6%A0%B9%E5%8D%8F%E8%AE%AEWiegand/#_1","title":"\u7269\u7406\u5c42","text":"<p>\u97e6\u6839\u63a5\u53e3\u7684\u7269\u7406\u5c42\u4f7f\u7528\u4e09\u6839\u7ebf\uff0c\u5176\u4e2d\u4e24\u6839 D0\u3001D1 \u4e3a\u6570\u636e\u7ebf\uff0c\u4e00\u6839\u4e3a\u5730\u7ebf\u3002</p> <ul> <li>\u5f53\u6ca1\u6709\u6570\u636e\u88ab\u53d1\u9001\u7684\u65f6\u5019\uff0cD0 \u548c D1 \u90fd\u88ab\u4e0a\u62c9\u81f3\u9ad8\u7535\u5e73\uff0c\u901a\u5e38\u4e3a+5VDC</li> <li>\u5f53 0 \u88ab\u53d1\u9001\u7684\u65f6\u5019\uff0cD0 \u51fa\u73b0\u8d1f\u8109\u51b2\uff0cD1 \u4f1a\u4fdd\u6301\u5728\u9ad8\u7535\u5e73</li> <li>\u5f53 1 \u88ab\u53d1\u9001\u7684\u65f6\u5019\uff0cD1 \u51fa\u73b0\u8d1f\u8109\u51b2\uff0cD2 \u4f1a\u4fdd\u6301\u5728\u9ad8\u7535\u5e73</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/00-%E9%9F%A6%E6%A0%B9%E5%8D%8F%E8%AE%AEWiegand/#_2","title":"\u534f\u8bae","text":""},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/00-%E9%9F%A6%E6%A0%B9%E5%8D%8F%E8%AE%AEWiegand/#26","title":"\u97e6\u6839 26 \u7801","text":"<ul> <li>E \u4e3a bit1 ~ bit12\u7684\u5076\u6821\u9a8c</li> <li>X \u4e3a\u4e09\u4e2a\u5b57\u8282\u7684\u5361\u53f7\u4fe1\u606f</li> <li>O \u4e3a bit13 ~ bit24\u7684\u5947\u6821\u9a8c</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/00-%E9%9F%A6%E6%A0%B9%E5%8D%8F%E8%AE%AEWiegand/#34","title":"\u97e6\u6839 34 \u7801","text":"<ul> <li>E \u4e3a bit1 ~ bit16\u7684\u5076\u6821\u9a8c</li> <li>X \u4e3a ID \u5361\u4e24\u4e2a\u5b57\u8282\u7684 HID \u7801\uff08Hidden ID code\uff09</li> <li>Y \u4e3a ID \u5361\u4e24\u4e2a\u5b57\u8282\u7684 PID \u7801\uff08Public ID code\uff09</li> <li>O \u4e3a bit17 ~ bit32 \u7684\u5947\u6821\u9a8c</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/240830-%E5%90%84%E7%A7%8D%E9%80%9A%E7%94%A8%E4%B8%B2%E5%8F%A3%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86/","title":"240830-\u5404\u79cd\u901a\u7528\u4e32\u53e3\u603b\u7ebf\u6807\u51c6","text":""},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/240830-%E5%90%84%E7%A7%8D%E9%80%9A%E7%94%A8%E4%B8%B2%E5%8F%A3%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86/#1-rs-232","title":"1 RS-232","text":"<ul> <li>1970 \u5e74\u53d1\u5e03\uff1b\u6807\u51c6\u540d\u79f0 EIA-232-E</li> <li>\u4f20\u7edf\u603b\u7ebf\u6807\u51c6\u91c7\u7528\u6807\u51c6 DB25 \u63a5\u53e3\uff0c\u73b0\u4e00\u822c\u4f7f\u7528 DB9\uff1a\u4e24\u6761\u4fe1\u53f7\u901a\u9053\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5168\u53cc\u5de5\u901a\u4fe1</li> <li>\u9a71\u52a8\u8d1f\u8f7d\u7535\u5bb9&lt;2500pF\uff0c\u901a\u4fe1\u4e3e\u4f8b\u53d7\u6b64\u7535\u5bb9\u9650\u5236 <p>\u91c7\u7528150pF/m\u7684\u901a\u4fe1\u7535\u7f06\u65f6\uff0c\u6700\u5927\u901a\u4fe1\u8ddd\u79bb\u4e3a15m</p> </li> <li>\u5c5e\u4e8e\u5355\u7aef\u4fe1\u53f7\u4f20\u9001\uff0c\u53d1\u9001\u4e0e\u63a5\u6536\u7535\u5e73\u4e4b\u5dee\u4ec5 2~3V\uff0c\u5171\u6a21\u6291\u5236\u80fd\u529b\u5dee\uff0c\u4e00\u822c\u7528\u4e8e 20m \u4ee5\u5185\u7684\u901a\u4fe1</li> <li>\u53d1\u9001\u65f6\u53d1\u9001\u7aef\u6b63\u7535\u5e73\u5728+5\uff5e+15V\uff0c\u8d1f\u7535\u5e73\u5728-5\uff5e-15V\u7535\u5e73\u3002\u5f53\u65e0\u6570\u636e\u4f20\u8f93\u65f6\uff0c\u7ebf\u4e0a\u4e3aTTL\uff0c\u4ece\u5f00\u59cb\u4f20\u9001\u6570\u636e\u5230\u7ed3\u675f\uff0c\u7ebf\u4e0a\u7535\u5e73\u4eceTTL\u7535\u5e73\u5230RS-232\u7535\u5e73\u518d\u8fd4\u56deTTL\u7535\u5e73\u3002\u63a5\u6536\u5668\u5178\u578b\u7684\u5de5\u4f5c\u7535\u5e73\u5728+3\uff5e+12V\u4e0e-3\uff5e-12V\u3002</li> <li>\u6700\u9ad8\u901f\u7387\u4e3a 20kb/s</li> </ul> <p>\u5728 TXD \u548c RXD \u6570\u636e\u7ebf\u4e0a\uff1a</p> <ol> <li>\u903b\u8f91 1 \u7684\u7535\u5e73\u4e3a-3V~-15V</li> <li>\u903b\u8f91 0 \u7684\u7535\u5e73\u4e3a+3~+15V \u7684\u7535\u538b</li> </ol> <p>\u5728 RTS\u3001CTS\u3001DSR\u3001DTR \u548c DCD \u7b49\u63a7\u5236\u7ebf\u4e0a\uff1a</p> <ol> <li>\u4fe1\u53f7\u6709\u6548\uff08\u63a5\u901a\uff0cON \u72b6\u6001\uff09\u4e3a+3~+15V \u7684\u7535\u538b</li> <li>\u4fe1\u53f7\u65e0\u6548\uff08\u65ad\u5f00\uff0cOFF \u72b6\u6001\uff09\u4e3a-3~-15V \u7684\u7535\u538b</li> </ol> <p>RS-232\u662f\u7528\u6b63\u8d1f\u7535\u538b\u6765\u8868\u793a\u903b\u8f91\u72b6\u6001\u3002\u5bf9\u4e8e\u6570\u636e(\u4fe1\u606f\u7801)\uff0c\u903b\u8f911(\u4f20\u53f7)\u7684\u7535\u5e73\u4f4e\u4e8e-3V\uff0c\u903b\u8f910(\u7a7a\u53f7)\u7684\u7535\u5e73\u9ad8\u4e8e+3V\uff1b\u5bf9\u4e8e\u63a7\u5236\u4fe1\u53f7\uff0c\u63a5\u901a\u72b6\u6001(ON)\u5373\u4fe1\u53f7\u6709\u6548\u7684\u7535\u5e73\u9ad8\u4e8e3V\uff0c\u65ad\u5f00\u72b6\u6001(OFF)\u5373\u4fe1\u53f7\u65e0\u6548\u7684\u7535\u5e73\u4f4e\u4e8e-3V\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/240830-%E5%90%84%E7%A7%8D%E9%80%9A%E7%94%A8%E4%B8%B2%E5%8F%A3%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86/#2-rs-422","title":"2 RS-422","text":"<ul> <li>\u7531 RS232 \u53d1\u5c55\u800c\u6765\uff0c\u4e3a\u6539\u8fdb RS-232\u901a\u4fe1\u8ddd\u79bb\u77ed(\u6700\u5927\u4f20\u8f93\u8ddd\u79bb15m)\u3001\u901f\u7387\u4f4e(\u6700\u5927\u4f4d\u901f\u7387\u4e3a20Kb/s)\u7684\u7f3a\u70b9\u800c\u63d0\u51fa\u7684\u3002</li> <li>10Mbps</li> <li>100kbps \u4e0b\u624d\u80fd\u8fbe\u5230\u6700\u5927\u4f20\u8f93\u8ddd\u79bb 1219 \u7c73</li> <li>100 \u7c73=1Mbps</li> <li>\u5171\u6a21\u7535\u538b\u7684\u8f93\u51fa\u8303\u56f4\u58eb7V</li> <li>\u4e32\u884c\u63a5\u53e3\u63a5\u6536\u5668\u7684\u6700\u5c0f\u8f93\u5165\u7535\u963b\u662f4K\u03a9</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/01-%E5%B5%8C%E5%85%A5%E5%BC%8F%E8%BD%AF%E4%BB%B6/00-%E9%80%9A%E8%AE%AF%E5%8D%8F%E8%AE%AE/240830-%E5%90%84%E7%A7%8D%E9%80%9A%E7%94%A8%E4%B8%B2%E5%8F%A3%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86/#3-rs-485","title":"3 RS-485","text":"<ul> <li>RS-485\u4e32\u884c\u63a5\u53e3\u7684\u9a71\u52a8\u5668\u53ef\u7528\u4e8e RS-422\u4e32\u884c\u63a5\u53e3\u7684\u5e94\u7528\u4e2d\uff0c\u56e0\u4e3a RS-485\u4e32\u884c\u63a5\u53e3\u6ee1\u8db3\u6240\u6709\u7684 RS-422\u4e32\u884c\u63a5\u53e3\u6027\u80fd\u53c2\u6570\uff0c\u53cd\u4e4b\u5219\u4e0d\u80fd\u6210\u7acb\u3002</li> <li>RS-485\u4e32\u884c\u63a5\u53e3\u63a5\u6536\u5668\u7684\u6700\u5c0f\u8f93\u5165\u7535\u963b12K\u03a9</li> <li>\u5171\u6a21\u7535\u538b\u7684\u8f93\u51fa\u8303\u56f4\u662f-7V \u548c+12V \u4e4b\u95f4</li> <li>RS485\u53ea\u80fd\u534a\u53cc\u5de5\u5de5\u4f5c\uff0c\u53d1\u6536\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\uff0c\u4f46\u5b83\u53ea\u9700\u8981\u4e00\u5bf9\u53cc\u7ede\u7ebf</li> <li>RS-485\u603b\u7ebf\u6807\u51c6\u89c4\u5b9a\u4e86\u603b\u7ebf\u63a5\u53e3\u7684\u7535\u6c14\u7279\u6027\u6807\u51c6\uff0c\u53d1\u9001\u7aef\uff1a\u6b63\u7535\u5e73\u5728+2V\uff5e+6V\u4e4b\u95f4\uff0c\u8868\u793a\u903b\u8f91\u72b6\u6001\u201c1\u201d\uff1b\u8d1f\u7535\u5e73\u5728-2V\uff5e-6V\u4e4b\u95f4\uff0c\u5219\u8868\u793a\u903b\u8f91\u72b6\u6001\u201c0\u201d\uff1b\u63a5\u6536\u5668\uff1a(V+) - (V-) \u22650.2V\uff0c\u8868\u793a\u4fe1\u53f7\u201c0\u201d\uff1b(V+) - (V-) \u22640.2V\uff0c\u8868\u793a\u4fe1\u53f7\u201c1\u201d)\u3002</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/02-%E5%B5%8C%E5%85%A5%E5%BC%8FLinux/","title":"\u5d4c\u5165\u5f0fLinux","text":""},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/","title":"WEB\u6280\u672f","text":""},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/","title":"HTTPS \u4e0e OpenSSL","text":""},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/#1","title":"1 \u7b80\u4ecb","text":"<p>HTTPS \u7b80\u5355\u6765\u8bb2\u662f HTTPS \u7684\u5b89\u5168\u7248\u3002\u4e5f\u5c31\u662f HTTP \u52a0\u5165\u4e86 SSL \u5c42</p> <p>HTTP for HyperText Transfer Protocol\uff1b</p> <p>S for Secure\uff1b</p> <p>SSL for Secure Sockets Layer\uff1bTLS for Transport Layer Security</p>"},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/#2","title":"2 \u5bf9\u79f0\u52a0\u5bc6\u3001\u975e\u5bf9\u79f0\u52a0\u5bc6","text":""},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/#21","title":"2.1 \u975e\u5bf9\u79f0\u52a0\u5bc6","text":"<ul> <li>\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u4e0d\u540c\u7684\u5bc6\u94a5\uff0c\u79c1\u94a5\u52a0\u5bc6\u516c\u94a5\u53ef\u89e3\uff0c\u516c\u94a5\u52a0\u5bc6\u79c1\u94a5\u53ef\u89e3</li> <li>\u79c1\u94a5\u7531\u7528\u6237\u81ea\u5df1\u62e5\u6709\uff0c\u516c\u94a5\u516c\u5f00\u914d\u9001</li> </ul> <p>\u4f46\u662f\u975e\u5bf9\u79f0\u52a0\u5bc6\u4f1a\u6709\u5982\u4e0b\u98ce\u9669\uff1a</p> <p>\u653b\u51fb\u8005\u53ef\u80fd\u4f1a\u5148\u4e00\u6b65\u4e0e A \u548c B \u5efa\u7acb\u8054\u7cfb\uff0c\u4ece\u800c\u51fa\u73b0\u7be1\u6539\u7684\u53ef\u80fd</p> <p>\u56e0\u6b64\u51fa\u73b0\u4e86\u8bc1\u4e66\u6388\u6743\u673a\u6784\uff0c\u4e5f\u5c31\u662f CA\uff08Certificate Authority\uff09</p> <ol> <li>CA \u7528\u81ea\u5df1\u7684\u79c1\u94a5\u751f\u6210\u4e00\u4e2a\u81ea\u7b7e\u540d\u7684\u8bc1\u4e66</li> <li>B \u5411 CA \u53d1\u8d77\u8bf7\u6c42\uff0cCA \u7528\u81ea\u7b7e\u540d\u8bc1\u4e66\u4ee5\u53ca B \u7684\u79c1\u94a5\u4e3a\u5176\u7b7e\u53d1\u8bc1\u4e66\uff0c\u8bc1\u4e66\u4e2d\u5305\u542b B \u7684\u516c\u94a5\u4fe1\u606f</li> <li>B \u628a\u81ea\u5df1\u7684\u8bc1\u4e66\u53d1\u9001\u7ed9 A\uff0c\u540c\u65f6\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u7b7e\u540d\u4e86\u4e00\u4e9b\u4e1c\u897f\u4e5f\u53d1\u4e86\u8fc7\u53bb\uff0cA \u62ff\u7740 CA \u7684\u8bc1\u4e66\u9a8c\u8bc1 B \u8bc1\u4e66\uff0c\u5982\u679c\u9a8c\u8bc1\u6ca1\u6709\u95ee\u9898\uff0c\u5c31\u4ece\u8bc1\u4e66\u4e2d\u62ff\u5230 B \u7684\u516c\u94a5\uff0c\u7136\u540e\u62ff\u8fd9\u4e2a\u516c\u94a5\u5bf9\u6536\u5230\u7684\u6570\u636e\u9a8c\u8bc1\u7b7e\u540d\u786e\u5b9a\u8eab\u4efd</li> <li>\u6700\u540e A \u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u516c\u94a5\u548c B \u901a\u4fe1\u4e86</li> </ol> <p>\u6765\u81ea\u77e5\u4e4e\uff1a https://zhuanlan.zhihu.com/p/456089100</p>"},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/#3-https","title":"3 HTTPS \u7684\u8eab\u4efd\u9a8c\u8bc1","text":"<p>HTTPS \u534f\u8bae\u4e2d\u7684\u8eab\u4efd\u9a8c\u8bc1\u90e8\u5206\u662f\u7531\u6570\u5b57\u8bc1\u4e66\u6765\u5b8c\u6210\u7684\uff0c\u8bc1\u4e66\u6709\u5982\u4e0b\u5185\u5bb9\u7ec4\u6210\uff1a</p> <ul> <li>\u516c\u94a5</li> <li>\u8bc1\u4e66\u4e3b\u4f53</li> <li>\u6570\u5b57\u7b7e\u540d\u7b49\u5185\u5bb9</li> </ul> <p>\u7528\u6237\u5728\u8bbf\u95ee\u4f7f\u7528\u4e86 SSL \u7684\u7f51\u7ad9\u4e4b\u540e\u4f1a\u5411\u670d\u52a1\u5668\u53d1\u8d77 SSL \u8bf7\u6c42\u3002\u4e4b\u540e\uff0c\u670d\u52a1\u5668\u4f1a\u5c06\u6570\u5b57\u8bc1\u4e66\u7ed9\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u5bf9\u6570\u5b57\u8bc1\u4e66\u8fdb\u884c\u9a8c\u8bc1\uff0c\u9a8c\u8bc1\u901a\u8fc7\u540e\u4f1a\u751f\u6210\u4e00\u4e2a\u7528\u4e8e\u5bc6\u94a5\u4ea4\u6362\u7684\u5bf9\u79f0\u5bc6\u94a5\u3002\u7528\u4e8e\u672c\u6b21\u901a\u8bdd\u7684\u52a0\u5bc6\u901a\u4fe1\u3002</p> <p>\u968f\u540e\u5ba2\u6237\u7aef\u4f1a\u4f7f\u7528\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u516c\u94a5\u5bf9\u751f\u6210\u7684\u5bc6\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u518d\u53d1\u9001\u56de\u670d\u52a1\u5668\u3002</p> <p>\u670d\u52a1\u5668\u4f7f\u7528\u79c1\u94a5\u89e3\u5bc6\u6536\u5230\u7684\u52a0\u5bc6\u4fe1\u606f\uff0c\u5f97\u5230\u5bf9\u79f0\u52a0\u5bc6\u5bc6\u94a5\u3002</p> <p>\u81f3\u6b64\uff0c\u5f80\u540e\u7684\u4f1a\u8bdd\u5c31\u4f1a\u4f7f\u7528\u5bf9\u79f0\u7684\u5bc6\u94a5\u8fdb\u884c\u52a0\u89e3\u5bc6\uff0c\u5e76\u5728\u5bf9\u8bdd\u7ed3\u675f\u540e\u9500\u6bc1\u5bf9\u79f0\u5bc6\u94a5\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/#4-openssl","title":"4 OpenSSL \u5b9e\u8df5","text":"<pre><code>pip install conan\n</code></pre> <p>\u5982\u679c\u8981\u81ea\u7f16\u8bd1\u7684\u8bdd windows \u73af\u5883\u4e0b\u5b98\u65b9\u63a8\u8350\u7528 conan \u6765\u8fdb\u884c\u4e0b\u8f7d\u3002</p> <p>conan\uff1a\u4e00\u4e2a c/c++\u7684\u5305\u7ba1\u7406\u5de5\u5177\uff0c\u7528 python \u5199\u7684</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u4e0b\u522b\u4eba\u7f16\u8bd1\u597d\u7684\u5b89\u88c5\u5305</p> <p>openssl \u7684\u4e00\u4e9b\u540d\u8bcd\u89e3\u91ca\uff1a</p> <ul> <li>pem \u548c der\uff1a\u4e24\u79cd\u683c\u5f0f\uff08\u5305\u62ec\u516c\u79c1\u94a5\u3001\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\u3001\u8bc1\u4e66\u7b49\u5185\u5bb9\uff09\uff0c\u524d\u8005\u662f\u6587\u672c\u5f62\u5f0f\uff0clinux \u5e38\u7528\uff0c\u540e\u8005\u662f\u4e8c\u8fdb\u5236\u5f62\u5f0f\uff0cwindows \u5e38\u7528\uff0c\u4ec5\u4ec5\u662f\u683c\u5f0f\uff0c\u4e0d\u8868\u660e\u5185\u5bb9\uff0c\u5982\u679c\u4f5c\u4e3a\u540e\u7f00\u5c31\u50cf html \u8d77\u7684\u6548\u679c\u4e00\u6837\u3002\u6709\u65f6\u5019\u7528 pem \u505a\u516c\u94a5\u7684\u540e\u7f00</li> <li>x509\uff1a\u8bc1\u4e66\u6807\u51c6</li> <li>crt \u548c cer\uff1a\u5e38\u89c1\u7684\u4e24\u79cd\u8bc1\u4e66\u540e\u7f00\u540d\uff0c\u524d\u8005\u5927\u591a\u6570\u60c5\u51b5\u4e3a pem \u683c\u5f0f\uff0c\u540e\u8005\u5927\u591a\u6570\u60c5\u51b5\u4e3a der \u683c\u5f0f</li> <li>csr\uff1a\u8bc1\u4e66\u7b7e\u540d\u8bf7\u6c42\uff0c\u5305\u542b\u4e86\u516c\u94a5\u3001\u7528\u6237\u540d\u7b49\u4fe1\u606f (Certificate Sign Request)</li> <li>key\uff1a\u5e38\u89c1\u7684\u79c1\u94a5\u7684\u540e\u7f00\u540d</li> </ul> <p>\u6765\u81ea\u77e5\u4e4e\uff1a https://zhuanlan.zhihu.com/p/456089100</p>"},{"location":"%E8%BD%AF%E4%BB%B6/03-WEB%E6%8A%80%E6%9C%AF/240823-HTTPS%E4%B8%8EOpenSSL/#41-openssl-ssl","title":"4.1 \u4f7f\u7528 OpenSSL \u521b\u5efa\u81ea\u7b7e\u540d\u7684 SSL \u8bc1\u4e66\u548c\u79c1\u94a5","text":"<p>\u9996\u5148\u5bf9\u4e8e\u81ea\u7b7e\u540d CA \u89d2\u8272\u6765\u8bf4\uff0c\u9700\u8981\u751f\u6210\u4e00\u5bf9\u516c\u79c1\u94a5\u4ee5\u53ca\u81ea\u7b7e\u540d\u8bc1\u4e66\uff1a</p> <pre><code># genrsa    \u751f\u6210RSA\u79c1\u94a5\n# -des3 des3\u7b97\u6cd5\uff08\u53ef\u9009\uff09\n# -out ca.key \u751f\u6210\u7684\u79c1\u94a5\u6587\u4ef6\u540d\n# 2048 \u79c1\u94a5\u957f\u5ea6\n\nopenssl genrsa -out ca.key 2048\n# \u8f93\u5165\u4e00\u4e2a4\u4f4d\u4ee5\u4e0a\u7684\u5bc6\u7801\u3002\n\n# rsa \u6307\u5b9a\u64cd\u4f5c\u7c7b\u578b\u4e3aRSA\u79c1\u94a5\n# -in \u6307\u5b9a\u8f93\u5165.key\u6587\u4ef6\n# -outform PEM \u6307\u5b9a\u8f93\u5165\u683c\u5f0f\u4e3aPEM\n# -puout ca_public.key \u6307\u5b9a\u8f93\u51fa\u7684\u516c\u94a5\u6587\u4ef6\u540d\u4e3aca_public.key\nopenssl rsa -in ca.key -outform PEM -puout ca_public.key\n\n# req \u8bf7\u6c42\u8bc1\u4e66\n# -new \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u8bc1\u4e66\u8bf7\u6c42\uff08csr\uff09\n# -key ca.key \u6307\u5b9a\u7528\u4e8e\u7b7e\u540dcsr\u7684\u79c1\u94a5\u6587\u4ef6\n# -out ca.csr \u6307\u5b9a\u751f\u6210\u7684csr\u6587\u4ef6\u540d\n# -subj \u6307\u5b9acsr\u7684\u4e3b\u9898\u4fe1\u606f\uff0c\u683c\u5f0f\u4e3a\u00a0`/\u7ec4\u4ef6=\u503c/`\uff0c\u5176\u4e2d\u00a0`C`\u00a0\u4ee3\u8868\u56fd\u5bb6\u4ee3\u7801\uff0c`ST`\u00a0\u4ee3\u8868\u5dde\u6216\u7701\u4efd\uff0c`L`\u00a0\u4ee3\u8868\u57ce\u5e02\uff0c`O`\u00a0\u4ee3\u8868\u7ec4\u7ec7\u540d\u79f0\uff0c`OU`\u00a0\u4ee3\u8868\u7ec4\u7ec7\u5355\u4f4d\uff0c`CN`\u00a0\u4ee3\u8868\u901a\u7528\u540d\u79f0\uff0c\u901a\u5e38\u662f\u57df\u540d\u6216\u4e3b\u673a\u540d\u3002\nopenssl req -new -key ca.key -out ca.csr -subj \"/C=CN/ST=Guangdong/L=Shenzhen/O=Company/OU=IT/CN=test.com/\"\n# csr\u8fd9\u4e00\u6b65\u53ef\u4ee5\u4f7f\u7528\u4ea4\u4e92\u5f0f\u8f93\u5165\n# \u56fd\u5bb6/\u7701/\u57ce\u5e02/\u7ec4\u7ec7/\u90e8\u95e8/\u540d\u79f0/\u5176\u4ed6\u53ef\u9009\u503c\n\n# x509 \u6307\u5b9a\u5904\u7406X.509\u8bc1\u4e66\n# -req \u6307\u5b9a\u8f93\u5165\u7684\u6587\u4ef6\u4e3acsr\n# -days 365 \u6307\u5b9a\u7b7e\u53d1\u8bc1\u4e66\u7684\u6709\u6548\u671f\u4e3a365\u5929\n# -in ca.csr \u6307\u5b9a\u8f93\u5165\u7684csr\u6587\u4ef6\n# -signkey ca.key \u6307\u5b9a\u7528\u4e8e\u7b7e\u540d\u8bc1\u4e66\u7684\u79c1\u94a5\u6587\u4ef6\n# -out ca.crt \u6307\u5b9a\u751f\u6210\u7684\u8bc1\u4e66\u540d\nopenssl x509 -req -days 365 -in ca.csr -signkey ca.key -out ca.crt\n</code></pre> <p>\u4e0a\u8ff0\u6307\u4ee4\u6d41\u521b\u5efa\u4e86\u4e00\u5bf9\u516c\u79c1\u94a5\uff0c\u5e76\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\uff0c\u8be6\u7ec6\u89e3\u91ca\u89c1\u6ce8\u91ca\u3002\u4e8e\u662f\u5f97\u5230\uff1a</p> <ul> <li>\u81ea\u7b7e\u540d\u8bc1\u4e66\uff1a<code>ca.crt</code></li> <li>\u516c\u94a5\uff1a<code>ca_public.key</code></li> <li>\u79c1\u94a5\uff1a<code>ca.key</code></li> </ul> <p>\u4ece\u8bc1\u4e66\u4e2d\u53ef\u4ee5\u83b7\u5f97\u516c\u94a5\uff1a</p> <pre><code># x509\uff1a\u6307\u5b9a\u64cd\u4f5c\u7c7b\u578b\u4e3a X.509 \u8bc1\u4e66\n# -pubkey\uff1a\u6307\u5b9a\u63d0\u53d6\u8bc1\u4e66\u4e2d\u7684\u516c\u94a5\n# -noout\uff1a\u4e0d\u8f93\u51fa\u8bc1\u4e66\u7684\u5b8c\u6574\u5185\u5bb9\n# -in ca.crt\uff1a\u6307\u5b9a\u8f93\u5165\u7684\u8bc1\u4e66\u6587\u4ef6\n# &gt; pub.key\uff1a\u5c06\u63d0\u53d6\u7684\u516c\u94a5\u91cd\u5b9a\u5411\u5230 pub.key \u6587\u4ef6\nopenssl x509 -pubkey -noout -in ca.crt &gt; pub.key\n\n# diff\uff1a\u662f\u4e00\u4e2a\u6bd4\u8f83\u6587\u4ef6\u5dee\u5f02\u7684\u547d\u4ee4\n# pub.key\uff1a\u7b2c\u4e00\u4e2a\u8981\u6bd4\u8f83\u7684\u6587\u4ef6\n# ca_public.key\uff1a\u7b2c\u4e8c\u4e2a\u8981\u6bd4\u8f83\u7684\u6587\u4ef6\ndiff pub.key ca_public.key\n</code></pre> <p>\u81f3\u6b64\u5df2\u7ecf\u5b8c\u6210\u4e86\u751f\u6210\u8bc1\u4e66\u5e76\u9a8c\u8bc1\u7684\u5168\u90e8\u6d41\u7a0b\uff0c\u73b0\u5728\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u7528\u8be5\u8bc1\u4e66\u5bf9\u5176\u4ed6\u751f\u6210\u7684\u79c1\u94a5\u8fdb\u884c\u7b7e\u540d\u8bc1\u4e66\uff0c\u540c\u6837\u4e5f\u53ef\u4ee5\u4ece\u7b7e\u540d\u51fa\u7684\u8bc1\u4e66\u83b7\u5f97\u516c\u94a5\uff1a</p> <pre><code>openssl genrsa -out server_private.key 2048\nopenssl rsa -in server_private.key -outform PEM -pubout -out server_public.key\nopenssl req -new -key server_private.key -out server.csr -subj \"/C=CN/ST=Guangdong/L=Shenzhen/O=Company/OU=IT/CN=test2.com/\"\nopenssl x509 -req -CA ca.crt -CAkey ca.key -CAcreateserial -in server.csr -out server.crt\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6/04-AI/","title":"AI","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/","title":"C\u8bed\u8a00\u516b\u80a1","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#1-volatile","title":"1 volatile","text":"<p>\u9632\u6b62\u7f16\u8bd1\u5668\u5bf9\u53d8\u91cf\u8fdb\u884c\u4f18\u5316\uff0c\u8ba9\u7f16\u8bd1\u5668\u6bcf\u6b21\u5b58\u53d6\u8be5\u53d8\u91cf\u7684\u65f6\u5019\u90fd\u8981\u53bb\u5185\u5b58\u91cc\u5b58\u53d6\uff0c\u800c\u4e0d\u662f\u5bc4\u5b58\u5668\u7684\u5907\u4efd\u3002</p> <p>\u7f16\u8bd1\u5668\u4f18\u5316\u6709\u53ef\u80fd\u4f1a\u4fee\u6539\u53d8\u91cf\uff1a</p> <pre><code>int a, b;\na = 1; // 1\nb = a; // 2\n</code></pre> <ol> <li>\u9996\u5148 1 \u5199\u5165 CPU\uff0c\u7136\u540e\u518d\u4ece CPU \u4e2d\u5c06 1 \u5199\u5165 a \u6240\u5728\u7684\u5185\u5b58\u4e2d\uff08&amp;a\uff09</li> <li>\u5148\u4ece\u5185\u5b58\u4e2d\u5c06 a \u7684\u503c\u53d6\u51fa\u5230 CPU\uff0c\u518d\u4ece CPU \u5c06\u503c\u5b58\u5165 b \u7684\u5185\u5b58\u5730\u5740\u4e2d</li> </ol> <p>\u8003\u8651\u4e0b\u9762\u4e00\u6bb5\u4ee3\u7801\uff0c\u5c55\u73b0\u4e86\u7f16\u8bd1\u5668\u4f18\u5316\u7684\u8fc7\u7a0b\uff1a</p> <pre><code>int a = 1, b, c;\nb = a; // 1\nc = a; // 2\n</code></pre> <ol> <li>&amp;a -&gt; CPU -&gt; &amp;b</li> <li>&amp;a -&gt; CPU -&gt; &amp;c</li> </ol> <p>\u7f16\u8bd1\u5668\u5728\u4f18\u5316\u8fd9\u6bb5\u4ee3\u7801\u7684\u65f6\u5019\u4f1a\u7701\u7565\u6389\u6807\u53f7 2 \u4e2d\u7684 <code>&amp;a -&gt; CPU</code> \u7684\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u6807\u53f7 1 \u4e2d\u5df2\u7ecf\u5c06 a \u7684\u503c\u653e\u5728\u5bc4\u5b58\u5668\uff08CPU\uff09\u4e2d\u8fc7\u4e86\u3002</p> <p>\u4e0d\u8fc7\u5982\u679c\u5728 <code>b=a</code> \u4e4b\u540e <code>a</code> \u5728\u5185\u5b58\u4e2d\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4f8b\u5982\u6b63\u597d\u4e00\u4e2a\u4e2d\u65ad\u6539\u53d8\u4e86 <code>a</code> \u7684\u503c\uff0c\u5c31\u4f1a\u5bfc\u81f4\u4e2d\u65ad\u56de\u6765\u4e4b\u540e\u7684\u6807\u53f7 2 \u4ee3\u7801\u8fd8\u662f\u5c06\u539f\u6765 <code>a</code> \u7684\u503c\u7ed9\u4e86 <code>c</code></p> <p>\u5f15\u5165 <code>volatile</code> \u4e4b\u540e\uff0c\u6267\u884c\u6807\u53f7 2 \u4ee3\u7801\u7684\u65f6\u5019\u4fbf\u4f1a\u4e0d\u5ffd\u7565 <code>&amp;a -&gt; CPU</code> \u8fd9\u4e2a\u6b65\u9aa4</p> <p>\u56e0\u6b64\uff0c\u4e00\u822c\u5728\u4ee5\u4e0b\u60c5\u51b5\u4f7f\u7528 volatile\uff1a</p> <ol> <li>\u5e76\u884c\u8bbe\u5907\u7684\u786c\u4ef6\u5bc4\u5b58\u5668\uff0c\u5f53\u58f0\u660e\u6307\u5411\u8bbe\u5907\u5bc4\u5b58\u5668\u7684\u6307\u9488\u7684\u65f6\u5019\u9700\u8981\u7528</li> <li>\u4e2d\u65ad\u670d\u52a1\u7a0b\u5e8f\u4e2d\u4fee\u6539\u7684\u6709\u88ab\u5176\u4ed6\u7a0b\u5e8f\u5f15\u7528\u7684\u53d8\u91cf</li> <li>\u591a\u7ebf\u7a0b\u5e94\u7528\u4e2d\u88ab\u597d\u51e0\u4e2a\u4efb\u52a1\u5171\u4eab\u7684\u53d8\u91cf</li> </ol>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#2-static","title":"2 static","text":"<p>\u58f0\u660e\u4e3a\u9759\u6001\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5b58\u50a8\u5728\u9759\u6001\u533a</p> <ul> <li>\u5982\u679c\u662f\u9759\u6001\u5c40\u90e8\u53d8\u91cf\u4f5c\u7528\u57df\u5373\u4e3a\u4e00\u5bf9\u82b1\u62ec\u53f7\u5185</li> <li>\u5982\u679c\u662f\u9759\u6001\u5168\u5c40\u53d8\u91cf\u4f5c\u7528\u57df\u5373\u4e3a\u5f53\u524d\u6587\u4ef6</li> </ul> <p>Static \u4fee\u9970\u7684\u5168\u5c40\u53d8\u91cf\u4ee5\u53ca\u51fd\u6570\u53ea\u80fd\u5728\u672c\u6587\u4ef6\u4e2d\u88ab\u8c03\u7528</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#3-const","title":"3 const","text":"<p>\u5b9a\u4e49\u53d8\u91cf\u4e3a\u5e38\u91cf</p> <p>\u5f53\u4fee\u9970\u4e3a\u6307\u9488\u7684\u65f6\u5019\uff1a</p> <pre><code>const int *p1;\nint const *p2;\nint* const p3;\nconst int* const p4;\n</code></pre> <ul> <li>\u7b2c\u4e00\u79cd\u548c\u7b2c\u4e8c\u79cd\u4e3a\u5e38\u91cf\u6307\u9488\uff0c\u8bed\u4e49\u5b8c\u5168\u76f8\u540c</li> <li>\u7b2c\u4e09\u79cd\u4e3a\u6307\u9488\u5e38\u91cf</li> <li>\u7b2c\u56db\u79cd\u662f\u6307\u5411\u5e38\u91cf\u7684\u5e38\u6307\u9488</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#31","title":"3.1 \u4ec0\u4e48\u662f\u5e38\u91cf\u6307\u9488\uff1a","text":"<ul> <li>\u4e0d\u80fd\u901a\u8fc7\u8fd9\u4e2a\u6307\u9488\u6765\u6539\u53d8\u53d8\u91cf\u7684\u503c\uff0c\u6709\u5176\u4ed6\u7684\u65b9\u6cd5\u53ef\u4ee5\u6539\u53d8\u53d8\u91cf\u7684\u503c</li> <li>\u53ef\u4ee5\u4fee\u6539\u8fd9\u4e2a\u6307\u9488\u6307\u5411\u7684\u5730\u5740</li> </ul> <p><code>*p1 = 5;</code> \u4e0d\u88ab\u5141\u8bb8\uff1b<code>p1 = &amp;someOtherInt</code> \u662f\u5141\u8bb8\u7684</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#32","title":"3.2 \u4ec0\u4e48\u662f\u6307\u9488\u5e38\u91cf\uff1a","text":"<ul> <li>\u4e5f\u5c31\u662f\u6307\u9488\u672c\u8eab\u662f\u4e2a\u5e38\u91cf\uff0c\u8be5\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u4e0d\u80fd\u88ab\u4fee\u6539\uff0c\u4f46\u662f\u6307\u5411\u7684\u5730\u5740\u4e2d\u4fdd\u5b58\u7684\u6570\u503c\u53ef\u4ee5\u6539\u53d8</li> </ul> <p><code>*p3 = 5;</code>\u00a0\u662f\u5141\u8bb8\u7684\uff0c\u4f46\u00a0<code>p3 = &amp;someOtherInt;</code>\u00a0\u4e0d\u88ab\u5141\u8bb8</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#33","title":"3.3 \u4ec0\u4e48\u662f\u6307\u5411\u5e38\u91cf\u7684\u5e38\u6307\u9488\uff1a","text":"<ul> <li>\u4e0a\u8ff0\u4e24\u8005\u7684\u7ed3\u5408\uff0c\u4e5f\u5c31\u662f\u6307\u9488\u672c\u8eab\u4e0d\u80fd\u4fee\u6539\uff0c\u6307\u5411\u7684\u53d8\u91cf\u7684\u503c\u4e5f\u4e0d\u80fd\u4fee\u6539</li> <li>\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7\u522b\u7684\u666e\u901a\u6307\u9488\u4fee\u6539\u53d8\u91cf\u7684\u503c</li> </ul> <p><code>*p4 = 5;</code>\u00a0\u548c\u00a0<code>p4 = &amp;someOtherInt;</code>\u00a0\u90fd\u662f\u4e0d\u5141\u8bb8\u7684\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#34-const","title":"3.4 \u5982\u679c const \u4fee\u9970\u7684\u662f\u51fd\u6570\u7684\u53c2\u6570\uff1a","text":"<ul> <li>\u8868\u793a\u5728\u51fd\u6570\u4f53\u5185\u4e0d\u80fd\u4fee\u6539\u8fd9\u4e2a\u53c2\u6570\u7684\u503c</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#35-const","title":"3.5 \u5982\u679c const \u4fee\u9970\u7684\u662f\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff1a","text":"<ul> <li>\u4fee\u9970\u7684\u662f\u6307\u9488\uff1a\u6307\u9488\u6307\u5411\u7684\u5730\u5740\u4e0d\u80fd\u88ab\u4fee\u6539\uff0c\u5e76\u4e14\u8fd4\u56de\u503c\u53ea\u80fd\u88ab\u8d4b\u7ed9\u7528 const \u4fee\u9970\u7684\u6307\u9488</li> <li>\u4fee\u9970\u7684\u662f\u53d8\u91cf\uff1a\u6ca1\u6709\u610f\u4e49\uff0c\u56e0\u4e3a\u8fd4\u56de\u503c\u4e3a\u4e34\u65f6\u53d8\u91cf\uff0c\u51fd\u6570\u8c03\u7528\u4e4b\u540e\u8fd9\u4e2a\u4e34\u65f6\u53d8\u91cf\u7684\u751f\u547d\u5468\u671f\u4e5f\u5c31\u7ed3\u675f\u4e86\uff0c\u5c06\u8fd4\u56de\u503c\u4fee\u9970\u4e3a const \u662f\u6ca1\u6709\u610f\u4e49\u7684</li> </ul> <p>\u9488\u5bf9\u4fee\u9970\u5bf9\u8c61\u4e3a\u6307\u9488\u7684\u60c5\u51b5\u6709\u4ee5\u4e0b\u4f8b\u5b50: <code>const char getString();</code> \u5b9a\u4e49\u4e00\u4e2a\u8fd4\u56de char \u7684\u51fd\u6570 <code>char *str = getString();</code> \u9519\u8bef\uff0cstr \u6ca1\u6709\u88ab const \u4fee\u9970 <code>const char *str = getString();</code> \u6b63\u786e</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#4-typedef-define","title":"4 typedef \u548c define \u7684\u5f02\u540c","text":"<p>\u9996\u5148\u90fd\u662f\u53d6\u522b\u540d\uff0c\u589e\u5f3a\u7a0b\u5e8f\u7684\u53ef\u8bfb\u6027\uff0c\u4f46\u662f\u5728\u539f\u7406\u3001\u529f\u80fd\u3001\u4f5c\u7528\u57df\u3001\u5bf9\u6307\u9488\u7684\u64cd\u4f5c\u8fd9\u56db\u4e2a\u65b9\u9762\u4e0a\u90fd\u6709\u6240\u4e0d\u540c\uff1a</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#41","title":"4.1 \u539f\u7406\u4e0a","text":"<p><code>#define</code> \u662f\u9884\u5904\u7406\u6307\u4ee4\uff0c\u5728\u9884\u5904\u7406\u65f6\u7b80\u5355\u4e14\u673a\u68b0\u5730\u8fdb\u884c\u5b57\u7b26\u4e32\u66ff\u6362\uff0c\u4e0d\u68c0\u67e5\u6b63\u786e\u6027\uff0c\u4e0d\u7ba1\u542b\u4e49\u662f\u5426\u6b63\u786e\uff0c\u5728\u7f16\u8bd1\u5df2\u88ab\u5c55\u5f00\u7684\u6e90\u7a0b\u5e8f\u7684\u65f6\u5019\u624d\u4f1a\u53d1\u73b0\u53ef\u80fd\u7684\u9519\u8bef\u5e76\u62a5\u9519\u3002</p> <p><code>typedef</code> \u662f\u5173\u952e\u5b57\uff0c\u7f16\u8bd1\u7684\u65f6\u5019\u88ab\u5904\u7406\uff0c\u5177\u6709\u7c7b\u578b\u68c0\u67e5\u7684\u529f\u80fd\uff0c\u5728\u81ea\u5df1\u7684\u5b9a\u4e49\u57df\u5185\u7ed9\u5df2\u7ecf\u5b58\u5728\u7684\u7c7b\u578b\u8d77\u4e00\u4e2a\u522b\u540d\uff0c\u4f46\u4e0d\u80fd\u5728\u4e00\u4e2a\u51fd\u6570\u5b9a\u4e49\u5185\u4f7f\u7528\u6807\u8bc6\u7b26\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#42","title":"4.2 \u529f\u80fd\u4e0a","text":"<p><code>typedef</code> \u7528\u6765\u5b9a\u4e49\u7c7b\u578b\u7684\u522b\u540d\uff0c\u4e00\u822c\u5e38\u7528\u7684\u5982\u4e3a\u81ea\u5df1\u5b9a\u4e49\u7684\u7c7b\u578b\uff08<code>struct</code> \u5b9a\u4e49\u7684\uff09\u8d77\u522b\u540d\uff0c\u53ef\u4ee5\u8d77\u5230\u5229\u4e8e\u8bb0\u5fc6\u4e0e\u8fa8\u8bc6\u7684\u529f\u80fd\uff0c\u5982\uff1a</p> <pre><code>struct wiegand_reader\n{\n    gpio_num_t gpio_d0, gpio_d1;\n    wiegand_callback_t callback;\n    wiegand_order_t bit_order;\n    wiegand_order_t byte_order;\n\n    uint8_t *buf;\n    size_t size;\n    size_t bits;\n    esp_timer_handle_t timer;\n    bool start_parity;\n    bool enabled;\n};\n</code></pre> <p>\u8fd9\u6837\u4e00\u4e2a\u7ed3\u6784\u4f53\uff0c\u5c06\u4e00\u4e2a wiegand \u8bfb\u5361\u5668\u62bd\u8c61\u4e3a\u4e00\u4e2a\u7c7b\u522b\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u7ed3\u6784\u4f53\u53ef\u4ee5\u5728\u5b9a\u4e49\u7684\u65f6\u5019\u76f4\u63a5\uff1a</p> <pre><code>typedef struct wiegand_reader\n{\n    xxx;\n    xxx;\n    xxx;\n} wiegand_reader_t;\n</code></pre> <p>\u52a0\u4e0a\u540e\u7f00 <code>_t</code> \u662f\u5e38\u7528\u7684\u5199\u6cd5\uff0c\u610f\u4e3a <code>type</code> \uff0c\u5411\u7f16\u7a0b\u4eba\u5458\u6307\u793a\u8fd9\u662f\u4e00\u4e2a\u53d8\u91cf\u7c7b\u578b</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#43","title":"4.3 \u4f5c\u7528\u57df\u4e0a","text":"<p><code>#define</code> \u6ca1\u6709\u4f5c\u7528\u57df\uff0c\u9884\u5b9a\u4e49\u8fc7\u540e\u7684\u5b8f\u5728\u6240\u6709\u7684\u7a0b\u5e8f\u4e2d\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c<code>typedef</code> \u5219\u6709\u81ea\u5df1\u7684\u4f5c\u7528\u57df\u3002</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#44","title":"4.4 \u5bf9\u6307\u9488\u7684\u64cd\u4f5c\u4e0a","text":"<p>\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u5bf9\u6bd4\u573a\u666f\uff1a</p> <pre><code>#define INTPTR1 int*\ntypedef int* INTPTR2;\nINTPTR1 P1, P2;s\nINTPTR2 P3, P4;\n</code></pre> <ul> <li>INTPTR1 \u7684\u60c5\u51b5\u4e3a\u8fdb\u884c\u5b57\u7b26\u4e32\u66ff\u6362\uff1a<code>int* p1; int p2;</code> \u8868\u8fbe\u7684\u610f\u4e49\u4e3a\u58f0\u660e\u4e00\u4e2a int \u578b\u6307\u9488\u53d8\u91cf p1 \u548c\u4e00\u4e2a\u6574\u5f62\u53d8\u91cf p2</li> <li>INTPTR2 \u7684\u60c5\u51b5\u662f\u201c\u5177\u6709\u542b\u4e49\u7684\u66ff\u6362\u201d\uff1a<code>int* p1; int* p2;</code> \u4e5f\u5c31\u662f\u4e24\u4e2a\u90fd\u662f\u6307\u9488\u53d8\u91cf</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#5","title":"5 \u53d8\u91cf","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#51-define-const","title":"5.1 \u5b9a\u4e49\u5e38\u91cf <code>#define</code> \u548c <code>const</code> \u7684\u533a\u522b\uff0c\u8c01\u66f4\u597d\uff1a","text":"<ul> <li><code>#define</code> \u53ef\u4ee5\u66ff\u4ee3\u5e38\u6570\u3001\u8868\u8fbe\u5f0f\u3001\u751a\u81f3\u4ee3\u7801\u6bb5\uff0c\u4f46\u5bb9\u6613\u51fa\u9519\uff0c\u6709\u7684\u65f6\u5019\u53ef\u4ee5\u4f5c\u4e3a\u5f88\u5f3a\u5927\u7684\u5de5\u5177\u4f7f\u7528\uff0c\u4f8b\u5982 uthash \u5e93\u8fd9\u4e2a\u4ec5\u5934\u6587\u4ef6\u5b9e\u73b0\u7684\u54c8\u5e0c\u8868\u5e93\u5c31\u5145\u5206\u5229\u7528\u4e86 <code>#define</code> \u7684\u4f18\u52bf</li> <li><code>const</code> \u7684\u5f15\u5165\u4e5f\u53ef\u4ee5\u589e\u5f3a\u53ef\u8bfb\u6027\uff0c\u4f7f\u7a0b\u5e8f\u7684\u7ef4\u62a4\u548c\u8c03\u8bd5\u53d8\u5f97\u66f4\u52a0\u65b9\u4fbf</li> </ul> <p>\u4f7f\u7528\u65f6\u7684\u5dee\u5f02\u4e00\u822c\u5728\u5982\u4e0b\u65b9\u9762\uff1a</p> <ul> <li><code>#define</code> \u58f0\u660e\u5468\u671f\u6b62\u4e8e\u7f16\u8bd1\u671f\uff0c\u4e0d\u5206\u914d\u5185\u5b58\uff0c\u5b58\u5728\u4e8e\u7a0b\u5e8f\u7684\u4ee3\u7801\u6bb5\uff0c\u800c <code>const</code> \u5b58\u5728\u4e8e\u7a0b\u5e8f\u7684\u6570\u636e\u6bb5\uff0c\u5728\u5806\u6808\u4e2d\u786e\u5b9e\u6709\u5206\u914d\u4e86\u7a7a\u95f4\uff0c\u53ef\u4ee5\u88ab\u8c03\u7528\u3001\u4f20\u9012</li> <li>\u7f16\u8bd1\u5668\u53ef\u4ee5\u5bf9 <code>const</code> \u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c<code>#define</code> \u5219\u4e0d\u4f1a</li> <li>\u6709\u4e9b IDE \u652f\u6301\u8c03\u8bd5 <code>const</code> \u5b9a\u4e49\u7684\u5e38\u91cf\uff0c\u53c8\u7531\u4e8e\u4f1a\u5bf9 <code>const</code> \u8fdb\u884c\u5b89\u5168\u68c0\u67e5\uff0c\u56e0\u6b64\u66f4\u52a0\u503e\u5411\u7528 const \u6765\u5b9a\u4e49\u5e38\u91cf\u7c7b\u578b</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#52","title":"5.2 \u5168\u5c40\u53d8\u91cf\u548c\u5c40\u90e8\u53d8\u91cf\u7684\u533a\u522b\uff1a","text":"<ul> <li>\u4f5c\u7528\u57df\u4e0d\u540c\uff0c\u5168\u5c40\u4e3a\u7a0b\u5e8f\u5757\uff0c\u5c40\u90e8\u4e3a\u5f53\u524d\u51fd\u6570\uff0c\u5f15\u7533\u4e00\u4e0b\u5219\u4e3a\u4f7f\u7528\u65b9\u5f0f\u7684\u4e0d\u540c\uff0c\u5168\u5c40\u7684\u7a0b\u5e8f\u7684\u5404\u4e2a\u90e8\u5206\u90fd\u53ef\u4ee5\u7528\u5230\uff0c\u5c40\u90e8\u7684\u53ea\u80fd\u5728\u5c40\u90e8\u4f7f\u7528</li> <li>\u751f\u547d\u5468\u671f\u4e0d\u540c\uff0c\u5168\u5c40\u4e0e\u4e3b\u7a0b\u5e8f\u5171\u5468\u671f\uff0c\u5c40\u90e8\u4e0e\u5c40\u90e8\u51fd\u6570\u3001\u5c40\u90e8\u5faa\u73af\u4f53\u7b49\u90e8\u5206\u5171\u5468\u671f</li> <li>\u5185\u5b58\u4e2d\u7684\u5b58\u50a8\u65b9\u5f0f\u4e0d\u540c\uff0c\u5168\u5c40\u53d8\u91cf\uff08\u9759\u6001\u5168\u5c40\u3001\u9759\u6001\u5c40\u90e8\u53d8\u91cf\uff09\u5206\u914d\u5728\u5168\u5c40\u6570\u636e\u533a\uff08\u9759\u6001\u5b58\u50a8\u7a7a\u95f4\uff09\uff0c\u5c40\u90e8\u5206\u914d\u5728\u6808\u533a</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#53-c","title":"5.3 \u5168\u5c40\u53d8\u91cf\u53ef\u4e0d\u53ef\u4ee5\u5b9a\u4e49\u5728\u88ab\u591a\u4e2a. C \u6587\u4ef6\u5305\u542b\u7684\u5934\u6587\u4ef6\u4e2d\uff1f","text":"<ul> <li>\u53ef\u4ee5\uff0c\u5728\u4e0d\u540c\u7684 C \u6587\u4ef6\u4e2d\u4ee5 static \u5f62\u5f0f\u6765\u58f0\u660e\u540c\u540d\u5168\u5c40\u53d8\u91cf</li> <li>\u53ef\u4ee5\u5728\u4e0d\u540c\u7684 C \u6587\u4ef6\u4e2d\u58f0\u660e\u540c\u540d\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u524d\u63d0\u662f\u53ea\u6709\u4e00\u4e2a\u6587\u4ef6\u4e2d\u8d4b\u521d\u503c</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#54","title":"5.4 \u5c40\u90e8\u53d8\u91cf\u80fd\u5426\u548c\u5168\u5c40\u53d8\u91cf\u91cd\u540d","text":"<ul> <li>\u53ef\u4ee5\uff0c\u5c40\u90e8\u4f1a\u5c4f\u853d\u5168\u5c40</li> <li>\u51fd\u6570\u5185\u90e8\u5f15\u7528\u7684\u65f6\u5019\u4f1a\u4f7f\u7528\u5c40\u90e8\u800c\u4e0d\u4f1a\u4f7f\u7528\u5168\u5c40\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u7f16\u8bd1\u5668\u4e2d\u540c\u4e00\u4e2a\u51fd\u6570\u5185\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a\u540c\u540d\u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u5728\u5faa\u73af\u4f53\u5185\u4f7f\u7528\u5404\u81ea\u7684\u540c\u540d\u5c40\u90e8\u53d8\u91cf\u5c31\u597d\uff0c\u4f5c\u7528\u57df\u88ab\u9650\u5236\u5728\u5404\u81ea\u7684\u5faa\u73af\u4f53\u5185</li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#6","title":"6 \u6570\u7ec4","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#61","title":"6.1 \u6570\u7ec4\u6307\u9488","text":"<p>\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0c\u8003\u8651\u4e00\u4e2a\u573a\u666f\uff1a</p> <pre><code>int b[12] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12};\nint (*p)[4];\np = b;\nprintf(\"%d\\n\", **(++p));\n</code></pre> <p><code>p</code> \u5219\u4e3a\u6570\u7ec4\u6307\u9488\uff0c\u4e0a\u8ff0\u4ee3\u7801\u7684\u91cd\u70b9\u5728\u4e8e\u5982\u4f55\u7406\u89e3 <code>p = b</code> \u4ee5\u53ca <code>**(++p)</code> \uff1a</p> <ul> <li>\u9996\u5148 <code>p</code> \u662f\u4e00\u4e2a\u6307\u5411\u201c\u5305\u542b 4 \u4e2a int \u6210\u5458\u7684\u6570\u7ec4\u201d\u7684\u6307\u9488\uff0c\u5728\u5c06 <code>b</code> \u8d4b\u503c\u7ed9 <code>p</code> \u7684\u65f6\u5019\uff0c\u76f8\u5f53\u4e8e <code>p</code> \u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u4f1a\u5b58\u50a8 <code>b</code> \u6570\u7ec4\u6bcf\u56db\u4e2a\u5143\u7d20\u7684\u8d77\u59cb\u5730\u5740\u3002\u5728 <code>p = b;</code> \u8fd9\u884c\u4ee3\u7801\u6267\u884c\u540e\uff0c<code>p</code> \u5c06\u6307\u5411 <code>b</code>\uff0c\u4e5f\u5c31\u662f\u5c06 <code>b</code> \u7684\u5730\u5740\u503c\u8d4b\u7ed9 <code>p</code></li> <li>\u4e8e\u662f <code>++p</code> \u4e4b\u540e <code>p</code> \u6307\u9488\u5c06\u5411\u540e\u79fb\u52a8 4 \u4e2a int \uff0c\u89e3\u7b2c\u4e00\u5c42\u5f15\u7528\u5f97\u5230 <code>b[4]</code> \uff0c\u89e3\u7b2c\u4e8c\u5c42\u5f15\u7528\u5f97\u5230\u5176\u503c <code>5</code></li> </ul>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#62","title":"6.2 \u6307\u9488\u6570\u7ec4","text":"<p>\u6307\u9488\u6570\u7ec4\u8868\u793a\u7684\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u5176\u4e2d\u7684\u5143\u7d20\u4e3a\u6307\u9488\uff0c\u8003\u8651\u4e0b\u5217\u793a\u4f8b\uff1a</p> <pre><code>int i;\nint* p[4];\nint a[4] = {1, 2, 3, 4};\np[0] = &amp;a[0];\np[1] = &amp;a[1];\np[2] = &amp;a[2];\np[3] = &amp;a[3];\nfor (i = 0; i &lt; 4; i++) printf(\"%d\", *p[i]);\n</code></pre> <p>\u8f93\u51fa 1234</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#63","title":"6.3 \u6570\u7ec4\u4e0b\u6807","text":"<p>\u53ef\u4ee5\u4e3a\u8d1f\u6570\uff0c\u4e0b\u6807\u6307\u793a\u7ed9\u51fa\u4e00\u4e2a\u4e0e\u5f53\u524d\u5730\u5740\u7684\u504f\u79fb\u91cf\u800c\u5df2\uff0c\u6839\u636e\u504f\u79fb\u91cf\u80fd\u591f\u5b9a\u4f4d\u5230\u76ee\u6807\u5730\u5740\u5373\u53ef</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#7","title":"7 \u6307\u9488","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#71","title":"7.1 \u51fd\u6570\u6307\u9488","text":"<p>\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\u540e\uff0c\u7f16\u8bd1\u65f6\u7cfb\u7edf\u5219\u4f1a\u4e3a\u8fd9\u4e2a\u51fd\u6570\u4ee3\u7801\u5206\u914d\u4e00\u6bb5\u5185\u5b58\uff0c\u8fd9\u6bb5\u7a7a\u95f4\u7684\u9996\u5730\u5740\u5219\u4e3a\u8fd9\u4e2a\u51fd\u6570\u7684\u5730\u5740\uff0c\u51fd\u6570\u540d\u4e5f\u5c31\u8868\u793a\u7684\u662f\u8fd9\u4e2a\u5730\u5740\u3002</p> <p>\u7c7b\u4f3c\u6570\u7ec4\u540d\u7684\u6982\u5ff5</p> <p>\u65e2\u7136\u662f\u4e00\u4e2a\u5730\u5740\uff0c\u90a3\u5c31\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u6307\u9488\u53d8\u91cf\u6765\u5b58\u653e\uff0c\u8be5\u6307\u9488\u53d8\u91cf\u5c31\u88ab\u53eb\u505a\u51fd\u6570\u6307\u9488\uff1a</p> <pre><code>int(*p) (int,int);\n</code></pre> <p>\u62ec\u53f7\u5728\u6b64\u5904\u4e0d\u80fd\u7701\u7565\uff0c\u62ec\u53f7\u80fd\u591f\u6539\u53d8\u4f18\u5148\u7ea7\uff0c\u5982\u679c\u7701\u7565\u4e86\u7684\u8bdd\uff0c\u5c31\u88ab\u89c6\u4f5c\u58f0\u660e\u4e86\u4e00\u4e2a\u8fd4\u56de\u503c\u7c7b\u578b\u4e3a\u6307\u9488\u578b\u7684\u51fd\u6570\uff1a</p> <pre><code>int* p (int,int);\n</code></pre> <p>\u4ee5\u53ca\u51fd\u6570\u6307\u9488\u6ca1\u6709++\u548c--\u8fd0\u7b97</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#72-int-p-int-p","title":"7.2 \u7279\u522b\u6ce8\u610f\uff1a\u533a\u5206 <code>int *p</code> \u548c <code>int (*p)</code>","text":"<p>\u8fd9\u4fe9\u662f\u4e0d\u540c\u7684\u53d8\u91cf\u7c7b\u578b\uff0c\u524d\u8005\u662f\u4e00\u4e2a\u6307\u5411 int \u7c7b\u578b\u7684\u6307\u9488\uff0c\u540e\u8005\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u6570\u7ec4\u6307\u9488\u6216\u662f\u8fd4\u56de int \u7c7b\u578b\u7684\u51fd\u6570\u6307\u9488\uff1a</p> <pre><code>// int *p\nint value = 10;\nint *p = &amp;value; // p \u6307\u5411 value\n*p = 20; // \u901a\u8fc7\u6307\u9488\u4fee\u6539 value \u7684\u503c\uff0c\u73b0\u5728 value = 20\n</code></pre> <pre><code>// int (*p)\nint arr[5] = {1, 2, 3, 4, 5};\nint (*p)[5] = &amp;arr; // p \u6307\u5411\u4e00\u4e2a\u5305\u542b5\u4e2a\u6574\u6570\u7684\u6570\u7ec4\n(*p)[0] = 10; // \u4fee\u6539\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u73b0\u5728 arr[0] = 10\n\nint add(int a, int b) return a + b;\nint (*p)(int, int) = add; // p \u6307\u5411\u51fd\u6570 add\nint result = p(3, 5); // \u8c03\u7528 add \u51fd\u6570\uff0c\u7ed3\u679c\u4e3a 8\n</code></pre>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#73","title":"7.3 \u6307\u9488\u51fd\u6570","text":"<p>\u8fd4\u56de\u503c\u4e3a\u5730\u5740\uff0c\u5fc5\u987b\u4f7f\u7528\u540c\u7c7b\u578b\u7684\u6307\u9488\u53d8\u91cf\u6765\u63a5\u53d7</p> <p>\u540e\u7f00\u4e2d\u7684\u62ec\u53f7\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u51fd\u6570\uff1a</p> <pre><code>int *pfun(int, int);\n</code></pre> <p><code>*</code> \u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u4f4e\u4e8e <code>()</code>\uff0c\u56e0\u6b64\u62ec\u53f7\u5148\u4e0e <code>pfun</code> \u8fdb\u884c\u7ed3\u5408</p>"},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%85%AB%E8%82%A1/#74","title":"7.4 \u6570\u7ec4\u548c\u6307\u9488\u7684\u5f02\u540c","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/%E8%AF%AD%E6%B3%95%E7%89%B9%E6%80%A7/","title":"\u8bed\u6cd5\u7279\u6027","text":""},{"location":"%E8%BD%AF%E4%BB%B6/05-%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/%E8%AF%AD%E6%B3%95%E7%89%B9%E6%80%A7/#1-240905-","title":"1 240905-\u590d\u5408\u5b57\u9762\u91cf","text":""}]}